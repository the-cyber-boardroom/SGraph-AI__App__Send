# Villager Architect: Brief Review — 16 February 2026

**Version:** v0.4.4
**Date:** 16 February 2026
**Role:** Villager Architect
**Reviewing:** `team/humans/dinis_cruz/briefs/02/16/v0.4.4__daily-brief__villager-team-16-feb-2026.md`
**Supporting briefs:** Briefing packs process, DPO/AppSec/GRC evidence pack, Translator role definition, Explorer daily brief (reference only)
**Previous architecture:** `team/roles/architect/reviews/26-02-15/v0.3.6__implementation-proposal__observability-pipeline.md`

---

## 1. Summary of Architectural Implications for the Villager Team

The 16 February Villager brief introduces five major workstreams. Three are squarely Villager territory (production environment setup, SA pipeline, Translator). Two require careful boundary management (user acquisition infrastructure, server-side workflow triggers). The brief also introduces a new process (briefing packs) and a new role (Translator).

**Architecturally significant items:**

| Item | Impact Level | Category |
|------|-------------|----------|
| Three-subdomain production environment | HIGH | Infrastructure (Villager) |
| CloudFront LETS log pipeline | HIGH | Infrastructure/Monitoring (Villager) |
| Digital twin collectors | MEDIUM | Infrastructure/Monitoring (Villager) |
| SA REST API endpoints | MEDIUM | Infrastructure (Villager) |
| Translator role and i18n pipeline | MEDIUM | Productisation (Villager) |
| Token-based routing / server-side workflows | LOW (design only) | Feature design (BOUNDARY — see Section 6) |
| Identity-linked encryption | LOW (research only) | Feature design (Explorer territory) |
| Issues FS S3 storage adapter | MEDIUM | Infrastructure (Villager) |
| Briefing packs folder structure | LOW | Process (both teams) |

**Key architectural finding:** The existing Explorer-defined architecture supports all Villager workstreams without modification. The two-Lambda topology, Memory-FS abstraction, cache service patterns, and IFD frontend architecture are sufficient for everything in this brief. No architectural changes are required.

---

## 2. Production Environment Architecture

### 2.1 Three-Subdomain Model

The brief defines three environments:

```
dev.send.sgraph.com     -> Development (Explorer team)
qa.send.sgraph.com      -> QA / Staging (pre-production verification)
send.sgraph.com         -> Production (users)
```

**Current state:** A single CloudFront distribution serves `send.sgraph.ai`. Dev is wired directly into production infrastructure.

**Target state:** Three independent deployment stacks, each a complete instance of the existing architecture.

### 2.2 Per-Environment Topology

Each environment requires its own complete stack:

```
Route 53 (DNS)
    │
    ├── dev.send.sgraph.com  ──> CloudFront Distribution (DEV)
    │                                │
    │                                ├── S3 Origin: sgraph-send-dev-ui/
    │                                │   (static assets — HTML, JS, CSS, i18n)
    │                                │
    │                                ├── Lambda URL Origin: user-dev
    │                                │   (public API — transfers, health)
    │                                │
    │                                └── Lambda URL Origin: admin-dev
    │                                    (admin API — tokens, stats, SA)
    │
    ├── qa.send.sgraph.com   ──> CloudFront Distribution (QA)
    │                                │
    │                                ├── S3 Origin: sgraph-send-qa-ui/
    │                                ├── Lambda URL Origin: user-qa
    │                                └── Lambda URL Origin: admin-qa
    │
    └── send.sgraph.com      ──> CloudFront Distribution (PROD)
                                     │
                                     ├── S3 Origin: sgraph-send-prod-ui/
                                     ├── Lambda URL Origin: user-prod
                                     └── Lambda URL Origin: admin-prod
```

### 2.3 Shared vs Isolated Resources

| Resource | Shared or Per-Environment | Notes |
|----------|--------------------------|-------|
| Route 53 Hosted Zone | Shared (sgraph.com) | One zone, three record sets |
| CloudFront Distribution | Per-environment | Separate caching, logging, behaviour rules |
| SSL Certificate (ACM) | Shared (wildcard `*.send.sgraph.com`) OR per-environment | Wildcard is simpler; per-cert is more isolated |
| S3 UI Bucket | Per-environment OR shared bucket with prefix paths | Per-bucket is cleaner for isolation |
| S3 Data Bucket | Per-environment | **Must** be isolated -- dev data never mixes with prod |
| Lambda Functions | Per-environment | Already named `user-dev`, `admin-dev` etc. |
| S3 Log Buckets | Per-environment | CloudFront logs land in environment-specific buckets |
| CloudWatch Log Groups | Per-environment | Follows Lambda naming |

### 2.4 Architectural Verification

The existing two-Lambda architecture (defined by Explorer in `v0.1.2__fastapi-service-plan-revised.md`) supports this directly:

- The `SGRAPH_SEND_TIER` environment variable already parameterises the environment name
- The `SGRAPH_SEND_STORAGE_BACKEND` and `SGRAPH_SEND_S3_BUCKET` variables already allow per-environment bucket selection
- The `SGRAPH_SEND_FRONTEND_URL` variable already supports per-environment CORS origins
- CloudFront behaviour rules (path patterns routing to S3 vs Lambda origins) are identical across environments -- only the origin endpoints differ

**No architectural change required.** The parameterisation model defined by Explorer handles multi-environment deployment. DevOps creates the infrastructure instances; the application code is identical.

### 2.5 DNS Transition Risk

The brief specifically mentions a real incident: DNS entries were changed from one CloudFront distribution to another with a window where production could have been unreachable. The Architect's assessment:

- Route 53 alias records pointing to CloudFront have a 60-second TTL by default
- The production discipline workflow (test before, test after, rollback plan) is the correct mitigation
- CloudFront distributions take 15-30 minutes to deploy -- plan for overlap periods
- Recommendation: create new distributions first, verify they serve content correctly, THEN update DNS. Never delete the old distribution until the new one is confirmed working.

---

## 3. SA (Server Analytics) Pipeline Architecture

### 3.1 Classification: Villager Territory

**The SA pipeline is infrastructure for understanding and operating the existing product.** It does not add user-facing features, does not change API contracts, does not modify the transfer workflow. It processes data that AWS services already generate (CloudFront logs, CloudWatch metrics) and presents it through the existing admin dashboard.

This is analogous to adding monitoring dashboards to a production system. The product is unchanged; the team's visibility into the product improves.

**Confirmation:** The brief's Conductor section explicitly states: "no new features in the Villager team. The SA pipeline is infrastructure that helps us understand and operate the product -- it's not a user-facing feature."

### 3.2 LETS Pipeline Architecture (CloudFront Logs)

The LETS (Log, Extract, Transform, Store) pipeline follows a five-step architecture:

```
Step 1: RAW INGESTION
    S3 (tab-delimited CloudFront logs via Firehose)
        |
        v
    [Transform: parse tab-delimited -> typed JSON]
        |
        v
    Cache Service (raw/ prefix)

Step 2: CONSOLIDATION
    Cache Service (raw/)
        |
        v
    [Consolidate: group identical requests, extract uniques, compress]
        |
        v
    Cache Service (consolidated/ prefix)

Step 3: TEMPORAL AGGREGATION
    Cache Service (consolidated/)
        |
        v
    [Aggregate: 30min -> hourly -> daily -> monthly]
        |
        v
    Cache Service (temporal paths with finality flags)

Step 4: ARCHIVE AND CLEAN
    S3 (live log bucket)
        |
        v
    [Move to archive bucket (Glacier/IA), delete from live]
        |
        v
    S3 (archive bucket)

Step 5: EVENT-DRIVEN AUTOMATION (future)
    S3 event (new log file) -> Lambda -> Steps 1-3 automatically
    Scheduled: daily archive/cleanup
```

### 3.3 Architectural Fit Assessment

The LETS pipeline integrates with existing architecture as follows:

| Component | Existing Pattern | SA Pipeline Usage | Architectural Change? |
|-----------|-----------------|-------------------|----------------------|
| Cache Service | `Send__Cache__Client` with latest + temporal | Stores raw, consolidated, aggregated data | **No** -- extends existing client with new methods |
| Admin Lambda | FastAPI routes via `Serverless__Fast_API` | New route group `Routes__Metrics` / `Routes__SA` | **No** -- add routes to existing app |
| S3 Access | Via `osbot-aws` (never boto3 directly) | Read CloudFront logs, write archives | **Exception needed** -- see 3.4 |
| Type_Safe | All schemas extend `Type_Safe` | New schemas for log records, aggregations | **No** -- follows existing pattern |
| Memory-FS | Storage abstraction | Not directly used (SA reads from S3 log buckets) | N/A |

### 3.4 boto3 Exception for Digital Twin Collectors

The brief specifies collectors for Route 53, CloudFront, Firehose, Lambda, and S3 configuration. These require AWS API calls that go beyond what `osbot-aws` currently wraps.

The observability pipeline proposal (`v0.3.6__implementation-proposal__observability-pipeline.md`) already established the pattern: use `boto3` with lazy imports inside `Type_Safe` service classes, storing the boto3 client as an underscore-prefixed attribute (`self._boto3_client`) outside of Type_Safe's attribute system.

**This is not a new architectural decision.** Decision D050 (registered 15 Feb) already covers this pattern. The digital twin collectors follow the same `CloudWatch__Client` pattern -- one Type_Safe wrapper class per AWS service, with a corresponding `__Stub` class for testing.

### 3.5 Finality Tracking Architecture

The temporal aggregation with finality is a novel caching pattern but fits within the existing cache service model:

```
Cache key structure:
    sa/cloudfront/aggregate/{period}/{time_key}

Finality metadata:
    sa/cloudfront/aggregate/{period}/{time_key}/__meta.json
    {
        "status": "final" | "partial",
        "computed_at": <timestamp>,
        "source_count": <int>,
        "sources_final": <int>
    }

Cascade rule:
    30min bucket -> final when the 30-minute window has elapsed
    hourly bucket -> final when all 2x 30min buckets are final
    daily bucket -> final when all 24x hourly buckets are final
    monthly bucket -> final when all daily buckets are final
```

**Architect note:** The finality model is a read optimisation, not a data model change. Final buckets are served from cache without recomputation. Partial buckets are recomputed on request. This matches the on-demand + cache pattern recommended in the observability pipeline proposal (Option C from Q2).

### 3.6 SA REST API Assessment

The brief defines approximately 20 API endpoints under `/api/sa/`. These are all admin-only endpoints (they live on the admin Lambda behind OSBot-Fast-API auth). They follow the existing pattern:

- Thin route layer (`Routes__SA`) delegates to service classes
- Services use `Send__Cache__Client` for storage
- Services use collector classes for AWS API calls
- All schemas are `Type_Safe`

**No API contract violation.** These endpoints are additive to the admin Lambda. They do not modify any existing public or admin endpoint. The existing `/tokens/*`, `/stats/*`, and `/health` routes are untouched.

---

## 4. Translator Role Architecture

### 4.1 Current i18n System

The frontend i18n system is already in place, designed by Explorer:

**Architecture:**
- JSON locale files at `sgraph_ai_app_send__ui__user/v0/v0.1/{version}/i18n/{locale}.json`
- An `I18n` JavaScript module (`i18n.js`) loads locale files and provides string lookup
- IFD versioning: locale files are versioned alongside components (v0.1.3, v0.1.4)
- v0.1.6 introduces an IFD override pattern: a JS file that patches `I18n.strings.en` at runtime

**Current locale files (v0.1.4):**

| File | Locale | Key Count | Status |
|------|--------|-----------|--------|
| `en.json` | English | 74 keys | Complete (base) |
| `pt.json` | Brazilian Portuguese (pt-BR) | 119 keys | More complete than en -- has keys en is missing |
| `pt-PT.json` | European Portuguese | 119 keys | Complete, culturally distinct from pt-BR |
| `tlh.json` | Klingon | 119 keys | Easter egg -- complete |

**Observation:** The pt-BR and pt-PT files have 119 keys while en.json has only 74. This means 45 keys were added to the Portuguese translations (e.g., `upload.progress.reading`, `upload.progress.creating`, `download.result.send_another`, `access_gate.*`, `download.history.*`, `transparency.*`, `app.tagline`) but were NOT added back to `en.json`. The v0.1.6 i18n.js override patches some of these into English at runtime, but the base `en.json` is incomplete relative to the other locales.

**This is the "untranslated English content" bug the brief references.** It is not missing translations FROM English -- it is missing English strings that the Portuguese translators added. The Translator's first audit should reconcile all locale files to the same key set.

### 4.2 Architectural Implications of the Translator Role

The Translator is the first Villager-exclusive role. Its architectural impact on the frontend is minimal because the i18n infrastructure already exists:

| Concern | Architectural Impact | Change Required? |
|---------|---------------------|-----------------|
| Adding translated strings | Update JSON files in i18n/ folders | No code change |
| Adding new languages | Add new `{locale}.json` files | No code change -- i18n module already supports arbitrary locales |
| Language picker UI | Already exists in the frontend | No code change |
| Translation memory / glossary | New data store (could use Issues FS or cache service) | Villager decision -- no architectural change |
| Human reviewer workflow | Uses SG/Send itself (dogfooding) | No architectural change |
| Content pipeline trigger | Process concern, not architecture | No architectural change |

### 4.3 IFD Versioning Concern

The i18n files live within IFD-versioned directories (v0.1.3, v0.1.4). The v0.1.6 override demonstrates a pattern where later IFD versions can surgically patch i18n strings without replacing the full locale files.

**Architect recommendation for the Translator:** When updating translations, follow the IFD pattern:
1. If fixing missing keys in existing locales, update the current version's i18n files (v0.1.4)
2. If adding significant new content, create a new IFD minor version with updated i18n files
3. Do NOT modify i18n files in older versions (v0.1.3) -- those are frozen

The v0.1.6 runtime override pattern is an acceptable IFD surgical fix for brand strings but should not be the primary mechanism for translation updates. Full locale files are the source of truth.

### 4.4 Key Discrepancy: Brief vs Reality

The brief references i18n files at `v0.1.4/i18n/` and `v0.1.6/`. In reality:
- `v0.1.4/i18n/` contains the full locale JSON files (en, pt, pt-PT, tlh)
- `v0.1.6/` has NO `i18n/` directory -- instead it has `js/i18n.js` which patches strings at runtime
- `v0.1.3/i18n/` also contains locale files (an older version)

The Translator should work from `v0.1.4/i18n/` as the current canonical locale source, aware that `v0.1.6/js/i18n.js` overrides some English strings at runtime.

---

## 5. Briefing Packs Structure

### 5.1 Folder-Per-Pack Model

The briefing packs brief defines a self-contained folder structure:

```
{pack-name}/
    BRIEF.md
    .issues/
        tasks.issues
    [optional: architecture.md, code-context.md, addenda/, reference/]
```

### 5.2 Architectural Validation

The folder-per-pack model is architecturally sound because:

1. **Git-compatible** -- each pack is a directory that can be committed, branched, and tracked
2. **Portable** -- zip and share; no external dependencies
3. **Issues FS compatible** -- `.issues/` subfolder follows the existing Issues FS pattern already used in the project root (`.issues/`)
4. **Does not conflict with existing repo structure** -- packs would live in their own directory (not yet defined where)

### 5.3 .issues/ Integration

The existing `.issues/` structure at the project root uses a hierarchical JSON-based model:

```
.issues/
    issue.json
    issues/
        Project-1/
            issue.json
            issues/
                Phase-1/
                    issue.json
                    issues/
                        Feature-1/ ... Task-1/ ...
```

The briefing pack `.issues/` subfolder uses a simplified flat format (`tasks.issues` text file, not the nested JSON hierarchy). This is intentional -- the brief says "simplified format" -- but there is a potential inconsistency between the two Issues FS formats used in the same repo.

**Architect recommendation:** The Librarian should clarify whether briefing pack `.issues/` files use the simplified text format exclusively, or whether they should follow the existing JSON hierarchy. For consistency, I recommend the simplified format for packs (they are disposable work units, not persistent project tracking) and the JSON format for the persistent project `.issues/`.

### 5.4 Pack Storage Location

The brief does not specify where packs live in the repo. Options:

| Location | Pros | Cons |
|----------|------|------|
| `packs/` at repo root | Clean, discoverable | New top-level directory |
| `team/packs/` | Grouped with team structure | Deeper path |
| `library/packs/` | Grouped with knowledge base | Semantically odd (packs are work, not reference) |

**Architect recommendation:** `packs/` at repo root, parallel to `team/`, `library/`, `.issues/`. This is a Conductor/Librarian decision, not architectural.

---

## 6. Feature Freeze Assessment

For each major item in the brief, classified by team territory:

### VILLAGER TERRITORY (infrastructure, productisation, monitoring, deployment, hardening)

| Item | Classification | Rationale |
|------|---------------|-----------|
| Three-subdomain production environment | **VILLAGER** | Infrastructure setup, deployment, environment isolation |
| Environment mapping document (CloudFront, Route 53, S3, Lambda per env) | **VILLAGER** | Infrastructure documentation and checklist |
| Production discipline workflow (identify, test, plan, risk assess, migrate, deploy, verify) | **VILLAGER** | Change management process |
| CloudFront LETS log pipeline (raw -> typed JSON -> consolidated -> aggregated) | **VILLAGER** | Monitoring infrastructure for existing product |
| Digital twin collectors (Route 53, CloudFront, Firehose, Lambda, S3 config) | **VILLAGER** | Infrastructure state capture for monitoring |
| SA REST API endpoints | **VILLAGER** | Admin-only monitoring API on existing admin Lambda |
| Temporal aggregation with finality tracking | **VILLAGER** | Monitoring data management optimisation |
| Log archive and cleanup workflow | **VILLAGER** | Infrastructure operations |
| Integration tests for production environment | **VILLAGER** | QA for production deployment |
| Admin UI views (cache browser, digital twin, traffic dashboard) | **VILLAGER** | Admin monitoring visualisation (admin-only, not user-facing) |
| Issues FS S3 storage adapter | **VILLAGER** | Infrastructure -- new storage backend for existing abstraction |
| Audit current website for untranslated content | **VILLAGER** | Productisation -- fixing i18n gaps |
| Produce pt-BR and pt-PT translations | **VILLAGER** | Productisation -- completing existing i18n system |
| Establish translation pipeline (trigger, review, approve, deploy) | **VILLAGER** | Productisation process |
| Create glossary of key terms | **VILLAGER** | Productisation -- translation consistency |
| Find native speaker reviewers | **VILLAGER** | Productisation -- quality assurance |
| Research language-specific LLM models | **VILLAGER** | Productisation research |
| Marketing copy for beta invites | **VILLAGER** | User acquisition (marketing, not features) |
| Physical/digital invite card design | **VILLAGER** | User acquisition (marketing) |
| Daily journalist/historian report templates | **VILLAGER** | Reporting process definition |
| DPO/AppSec/GRC evidence collection and articles | **VILLAGER** | Documentation and publishing |
| Briefing packs process definition | **VILLAGER** | Team process improvement |

### EXPLORER TERRITORY (new features, new capabilities, behaviour changes)

| Item | Classification | Rationale |
|------|---------------|-----------|
| Interactive encrypted data workflows (JSON in -> JSON out with UI schemas) | **EXPLORER** | New product capability -- encrypted workflow platform |
| Client-side translation as a product feature | **EXPLORER** | New user-facing feature with P&L |
| UI component library for dynamic form rendering | **EXPLORER** | New frontend capability |
| LLM-generated UI schemas | **EXPLORER** | New product capability |
| Identity-linked encryption (Cognito sub, PKI) | **EXPLORER** | New encryption model research |
| Three-word key UX concept | **EXPLORER** | New UX pattern requiring security review |

### BOUNDARY (items straddling both teams)

| Item | Classification | Rationale | Recommendation |
|------|---------------|-----------|----------------|
| Server-side workflow triggers (S3 event -> token-based routing) | **BOUNDARY** | The brief asks the Architect to "design" this, but it adds new server behaviour (routing uploads based on token type). The design is architecture; the implementation is a new feature. | **Villager Architect captures the design pattern. Explorer implements when ready.** |
| Token-based routing (`support` token -> queue, `beta-feedback` -> analysis) | **BOUNDARY** | Token validation exists (Villager). Token-specific server-side behaviour is new (Explorer). | **Design the extension point in Villager. Implementation in Explorer.** |
| SG/Send for translator reviewer workflow | **BOUNDARY** | Using the existing product as-is = Villager (dogfooding). Adding interactive review UI = Explorer. | **Phase 1 (send JSON files) = Villager. Phase 2 (interactive forms) = Explorer.** |
| Feedback platform using SG/Send | **BOUNDARY** | Research is Villager. Building a feedback token with special behaviour is Explorer. | **Research = Villager. Implementation = Explorer.** |
| Customer-facing translation profiles (enterprise) | **BOUNDARY** | Architecture awareness = Villager (plan for extensibility). Building the feature = Explorer. | **Architect notes the future pattern. No implementation now.** |
| QR code generation with pre-loaded tokens | **BOUNDARY** | If using existing URL patterns (`?token=xxx`) = Villager. If requiring new URL handling = Explorer. | **Check if existing token URL handling supports this. If yes, Villager.** |

### Key Boundary Ruling

The brief assigns several items to the Architect that involve designing future features (token-based routing, identity-linked encryption, feedback architecture). **As Villager Architect, I capture these patterns in review documents for awareness but do NOT design them.** They are Explorer territory. The Villager Architect's role is to verify that the current architecture can accommodate these future patterns without requiring retroactive changes -- and it can, because the Memory-FS abstraction, S3 event model, and token validation service are all extensible by design.

---

## 7. Questions for the Human

### Q1: Subdomain Domain Discrepancy

The brief says `dev.send.sgraph.com`, but the current production URL is `send.sgraph.ai`. Are we moving to `sgraph.com`? Or should the environments be:
```
dev.send.sgraph.ai
qa.send.sgraph.ai
send.sgraph.ai
```
This affects SSL certificate configuration (ACM), Route 53 hosted zone, and CloudFront alternate domain names.

### Q2: SA Pipeline Ownership (Dev + Architect)

The brief assigns "Dev + Architect" to build the SA pipeline and API. In Villager mode, the Architect is a consultant, not a builder. Should the Villager Architect:
- (a) Review the dev's implementation for architectural compliance (as defined in ROLE.md), or
- (b) Actively co-design the API and schema structure (expanding beyond ROLE.md)?

The observability pipeline proposal from 15 Feb (`v0.3.6`) already defines the schemas and implementation plan. Should Dev follow that proposal, or does the 16 Feb brief supersede it?

### Q3: SA API Prefix

The brief uses `/api/sa/` as the API prefix. The existing architecture uses no base path (per Decision from v0.1.2: "No /api/v1/ prefix"). Should the SA endpoints follow the existing convention (bare paths like `/sa/collect/route53`) or introduce the `/api/` prefix? Consistency matters for the admin UI's API client.

### Q4: CloudFront Log Processing vs CloudWatch Metrics

The 15 Feb observability pipeline proposal (`v0.3.6`) focuses on CloudWatch metrics (aggregate data from the CloudWatch API). The 16 Feb brief focuses on CloudFront log processing (raw log files from S3 via Firehose). These are complementary but different data sources. Should we:
- (a) Build the CloudWatch metrics pipeline first (already designed in v0.3.6), then add log processing?
- (b) Build the CloudFront log pipeline first (as this brief emphasises), then add CloudWatch metrics?
- (c) Build both in parallel?

The v0.3.6 proposal recommended deferring log processing to Phase 2 (Q4 in that document). The 16 Feb brief now makes it Phase 1. Clarification on sequencing would help Dev prioritise.

### Q5: Issues FS S3 Adapter Scope

The brief says "Issues FS already supports memory FS, so the jump to S3 should be manageable." Is this referring to the Issues FS used by the project (`.issues/` in the repo) or a new Issues FS instance specifically for SA pipeline metadata? The existing Issues FS uses a nested JSON hierarchy in the filesystem. An S3 adapter would need to handle this hierarchy via S3 key prefixes. Should this be a general-purpose `Issues_FS__S3` backend (usable by any Issues FS consumer) or a specific SA pipeline metadata store?

### Q6: Event-Driven Automation Timeline

Step 5 of the LETS pipeline (S3 event triggers Lambda) requires a new Lambda function or an EventBridge rule. This is infrastructure that doesn't exist yet. The brief says "once the manual pipeline is proven, automate it." Is automation a Phase 1 deliverable or Phase 2? This affects DevOps planning.

### Q7: Translator Role Scope in v0.1.6

The v0.1.6 IFD version changed the brand name from "SGraph Send" to "SG/Send" via the i18n override. Should the Translator update the Portuguese translations to match this brand name change? Currently `pt.json` and `pt-PT.json` still say "SGraph Send" in `app.title`.

---

## 8. Phased Approach: Recommended Order of Execution for Villager Items

### Phase 1: Foundation (Days 1-3)

**Goal:** Production environment and monitoring foundation.

| Order | Task | Owner | Dependency | Rationale |
|-------|------|-------|------------|-----------|
| 1.1 | Environment mapping document (all settings per env) | DevOps | None | Everything else depends on knowing the target state |
| 1.2 | Create dev/QA/prod CloudFront distributions + Route 53 records | DevOps | 1.1 | Unblocks all environment-specific work |
| 1.3 | Reconcile en.json keys with pt.json / pt-PT.json (i18n audit) | Translator, Dev | None | Quick win -- fixes the untranslated content bug |
| 1.4 | Update pt-BR and pt-PT translations for any new/changed English strings | Translator | 1.3 | Depends on knowing the full key set |
| 1.5 | Verify production deployment on new CloudFront distribution | DevOps, QA | 1.2 | Validates the infrastructure change |

### Phase 2: SA Pipeline Core (Days 3-7)

**Goal:** First end-to-end pipeline from raw logs to aggregated data.

| Order | Task | Owner | Dependency | Rationale |
|-------|------|-------|------------|-----------|
| 2.1 | Implement CloudFront log parser (tab-delimited -> typed JSON) | Dev | None | First step of LETS pipeline |
| 2.2 | Implement digital twin collectors (Route 53, CloudFront, Firehose, Lambda, S3) | Dev | None | Parallel with 2.1 |
| 2.3 | Implement consolidation step (typed JSON -> compressed summary) | Dev | 2.1 | Depends on typed JSON output |
| 2.4 | Implement temporal aggregation with finality tracking | Dev | 2.3 | Depends on consolidated data |
| 2.5 | Implement SA REST API endpoints (admin Lambda) | Dev | 2.1-2.4 | Expose pipeline steps as API calls |
| 2.6 | DPO/AppSec: empirical verification that IP addresses are NOT in CloudFront logs | AppSec, DPO | 2.1 | Must verify before processing any log data |

### Phase 3: Visualisation and Translation Pipeline (Days 7-10)

**Goal:** Admin UI for SA data, translation pipeline operational.

| Order | Task | Owner | Dependency | Rationale |
|-------|------|-------|------------|-----------|
| 3.1 | Build cache service browser (admin UI) | Dev, Designer | 2.5 | Unblocks debugging all SA data |
| 3.2 | Build digital twin visualisation (admin UI) | Dev, Designer | 2.2, 2.5 | Visual representation of infrastructure |
| 3.3 | Build traffic dashboard (admin UI) | Dev, Designer | 2.4, 2.5 | The "Google Analytics replacement" |
| 3.4 | Establish translation pipeline process (trigger -> review -> approve -> deploy) | Translator, DevOps | 1.3, 1.4 | Formalise the workflow |
| 3.5 | Create glossary of key terms with approved translations | Translator | 1.4 | Consistency document for all future translations |
| 3.6 | Define daily report templates (journalist + historian) | Journalist, Historian | 2.4 | Ready when SA data starts flowing |

### Phase 4: User Acquisition and Operations (Days 10-14)

**Goal:** Beta programme infrastructure, automated operations.

| Order | Task | Owner | Dependency | Rationale |
|-------|------|-------|------------|-----------|
| 4.1 | Produce marketing copy for beta invites (multi-channel) | Ambassador | None | Can start any time |
| 4.2 | Design invite card template (physical + digital) | Designer | None | Can start any time |
| 4.3 | Implement log archive and cleanup workflow | DevOps | 2.4 | Depends on pipeline being proven |
| 4.4 | Write integration tests for production environment (uptime, flow, SSL) | QA | 1.5 | Depends on production being on new infrastructure |
| 4.5 | Research user feedback platforms | Sherpa, Ambassador | None | Background research task |
| 4.6 | Issues FS S3 storage adapter | Dev | None | Can be done independently |
| 4.7 | Find native speaker reviewers for pt-BR and pt-PT | Translator, Ambassador | 3.4 | Need the pipeline first |

### Phase 5: Background / Ongoing

| Task | Owner | Notes |
|------|-------|-------|
| DPO/AppSec/GRC evidence collection | Librarian, Historian | Runs in parallel, does not block engineering |
| Research language-specific LLM models | Translator | Research task, no deadline pressure |
| Briefing packs: create first CloudFront pipeline pack | Librarian, Architect | Process improvement, can be done iteratively |
| Design server-side workflow trigger model (DESIGN ONLY) | Architect | Capture the pattern for Explorer. No implementation. |
| Automate daily journalist/historian reports | Dev, Journalist, Historian | After SA pipeline is producing data |

### Phasing Rationale

1. **Production environment first** because everything else (deployment, monitoring, user access) depends on having proper environment separation.
2. **SA pipeline second** because it is the highest-value Villager deliverable -- it gives the team visibility into the product's behaviour.
3. **Translation and visualisation third** because they depend on the pipeline data and the i18n audit.
4. **User acquisition fourth** because the Ambassador and Designer can work in parallel but the full beta workflow needs the production environment to be stable.
5. **Background tasks continuously** because evidence collection and research do not block engineering.

---

## Appendix A: Existing Architecture Decisions Referenced

| Decision ID | Decision | Source |
|-------------|----------|--------|
| D048 | Adopt CloudWatch metrics pipeline in admin Lambda | v0.3.6 observability proposal |
| D049 | LETS aggregation pattern for analytics (30min -> hourly -> daily) | v0.3.6 observability proposal |
| D050 | boto3 lazy import (not a class attribute) | v0.3.6 observability proposal |
| D051 | CloudWatch__Client__Stub for tests (not mocks) | v0.3.6 observability proposal |
| D052 | HTML/CSS/SVG dashboards (no matplotlib) | v0.3.6 observability proposal |
| D053 | CloudFront metrics use separate us-east-1 client | v0.3.6 observability proposal |

## Appendix B: Documents Referenced

| Document | Path |
|----------|------|
| Villager daily brief (16 Feb) | `team/humans/dinis_cruz/briefs/02/16/v0.4.4__daily-brief__villager-team-16-feb-2026.md` |
| Briefing packs process brief | `team/humans/dinis_cruz/briefs/02/16/v0.4.4__briefs__briefing-packs-for-agents.md` |
| DPO/AppSec/GRC evidence pack | `team/humans/dinis_cruz/briefs/02/16/v0.4.4__briefs__dpo-appsec-grc-evidence-pack.md` |
| Translator role definition | `team/humans/dinis_cruz/briefs/02/16/v0.4.3__role-definition__translator.md` |
| Explorer daily brief (reference) | `team/humans/dinis_cruz/briefs/02/16/v0.4.4__daily-brief__explorer-team-16-feb-2026.md` |
| Explorer encrypted workflows (reference) | `team/humans/dinis_cruz/briefs/02/16/v0.4.4__explorer-brief__interactive-encrypted-data-workflows.md` |
| Observability pipeline proposal | `team/roles/architect/reviews/26-02-15/v0.3.6__implementation-proposal__observability-pipeline.md` |
| Data model and storage | `team/roles/architect/v0.1.2/v0.1.2__data-model-and-storage.md` |
| FastAPI service plan (revised) | `team/roles/architect/v0.1.2/v0.1.2__fastapi-service-plan-revised.md` |
| Villager Architect ROLE.md | `team/villager/roles/architect/ROLE.md` |
| i18n files (en) | `sgraph_ai_app_send__ui__user/v0/v0.1/v0.1.4/i18n/en.json` |
| i18n files (pt-BR) | `sgraph_ai_app_send__ui__user/v0/v0.1/v0.1.4/i18n/pt.json` |
| i18n files (pt-PT) | `sgraph_ai_app_send__ui__user/v0/v0.1/v0.1.4/i18n/pt-PT.json` |
| i18n override (v0.1.6) | `sgraph_ai_app_send__ui__user/v0/v0.1/v0.1.6/js/i18n.js` |

---

*Villager Architect Review*
*Version: v0.4.4*
*Date: 2026-02-16*
*Architecture is frozen from Explorer. This review explains, verifies, and guards boundaries.*
