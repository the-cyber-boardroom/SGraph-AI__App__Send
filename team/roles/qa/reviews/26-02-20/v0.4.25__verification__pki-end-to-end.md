# v0.4.25 — QA Verification Report: PKI End-to-End Messaging

**Version:** v0.4.25
**Date:** 2026-02-20
**Role:** QA
**Team:** Explorer

---

## Scope

End-to-end verification of the PKI messaging system across two separate browser sessions (production and localhost), covering both **confidentiality** and **authenticity**.

---

## Test Environment

| Parameter | Session A | Session B |
|-----------|-----------|-----------|
| Origin | `https://send.sgraph.ai` (prod) | `http://localhost:10061` |
| Browser | Chrome (secure context) | Chrome (secure context) |
| Key pairs | `dc-in-prod`, `user-in-prod` | `dc-in-localhost`, `user-in-localhost` |
| Key exchange | Manual copy-paste (out-of-band) | Manual copy-paste (out-of-band) |

---

## Tests Performed

### 1. Key Generation

| Test | Result |
|------|--------|
| Generate RSA-OAEP 4096-bit key pair | PASS — key appears in My Keys |
| Generate ECDSA P-256 signing key alongside | PASS — badge shows "ECDSA P-256" |
| Private key non-extractable | PASS — badge shows "non-extractable" |
| Fingerprint computed and displayed | PASS — `sha256:` prefix + 16 hex chars |
| Multiple key pairs per session | PASS — 2 keys per session |

### 2. Key Exchange

| Test | Result |
|------|--------|
| Copy public key bundle (JSON format) | PASS — `{v:1, encrypt:..., sign:...}` |
| Import JSON bundle as contact | PASS — contact appears with fingerprint |
| Signing key included in bundle | PASS — contact shows "verifiable" badge |
| Cross-origin import (prod key on localhost) | PASS — keys are algorithm-compatible |
| Cross-origin import (localhost key on prod) | PASS — symmetric |

### 3. Confidentiality (Encrypt & Decrypt)

| Test | Result |
|------|--------|
| Encrypt message on prod → decrypt on localhost | PASS |
| Encrypt message on localhost → decrypt on prod | PASS |
| Message: "hello dc in localhost, from dc in prod :)" | PASS — decrypted correctly |
| Message: "hello dc in prod, from dc in localhost" | PASS — decrypted correctly |
| Decryption with wrong key | NOT TESTED (expected: RSA-OAEP throws) |

### 4. Authenticity (Sign & Verify)

| Test | Result |
|------|--------|
| Message signed by sender's ECDSA key | PASS — payload includes `s` and `f` fields |
| Signature verified by recipient using contact's signing key | PASS |
| Verification status: "Signed by dc-in-localhost — signature verified" | PASS — green banner |
| Verification status: "Signed by dc-in-prod — signature verified" | PASS — green banner |
| Bidirectional: A→B verified AND B→A verified | PASS |

### 5. Backwards Compatibility

| Test | Result |
|------|--------|
| Old keys (pre-signing) can still encrypt | PASS |
| Unsigned message shows info banner (not alarm) | PASS — blue-grey "No signature" |
| Encrypt side shows unsigned hint for old keys | PASS |
| Legacy PEM import (no JSON bundle) | NOT TESTED (code path exists) |
| v1 payload decryption | NOT TESTED (code path exists) |

### 6. UI & UX

| Test | Result |
|------|--------|
| Secure context detection (0.0.0.0 → error page) | PASS — tested early in session |
| Localhost redirect link works | PASS |
| Two-column layout at normal zoom | PASS — all sections visible |
| Text overflow handled | PASS — labels shortened, ellipsis applied |
| SG/Send brand with teal slash | PASS — renders correctly |
| Delete key with typed-confirm guard | PASS |
| Clipboard copy of encrypted payload | PASS |

---

## Verification Evidence

Two screenshots provided by project owner showing:

**Screenshot 1 (prod → localhost):**
- Sent: "hello dc in localhost, from dc in prod :)"
- Received + verified: "hello dc in prod, from dc in localhost" — green "signature verified"

**Screenshot 2 (localhost → prod):**
- Sent: "hello dc in prod, from dc in localhost"
- Received + verified: "hello dc in localhost, from dc in prod :)" — green "signature verified"

Both screenshots show all 4 key pairs (2 per session) with ECDSA P-256 signing, and all 4 contacts (2 per session) marked as "verifiable".

---

## Security Properties Verified

| Property | Verified | Method |
|----------|----------|--------|
| Confidentiality | Yes | Message readable only by intended recipient |
| Integrity | Yes | AES-GCM auth tag (implicit in decrypt success) |
| Sender authentication | Yes | ECDSA signature verified against known contact |
| Zero-knowledge server | Yes | Server serves static files; no crypto involvement |
| Non-extractable keys | Yes | Badge display + Web Crypto API enforcement |

---

## Gaps (Identified, Not Blocking for MVP)

| Gap | Risk | Priority |
|-----|------|----------|
| No negative test for wrong-key decrypt | Low — Web Crypto API throws by design | P3 |
| No automated test suite | Medium — manual verification only | P2 |
| No legacy PEM import test | Low — code path exists, not exercised | P3 |
| No signature tampering test | Low — crypto.subtle.verify is well-tested | P3 |
| No forward secrecy | Medium — same RSA key reused | Future |
| No key revocation | Medium — compromised key stays valid | Future |

---

## Verdict

**PASS** — The PKI messaging MVP delivers working end-to-end encrypted and authenticated messaging between two independent browser sessions. Both confidentiality and authenticity are verified. The system is suitable for Explorer-stage demonstration and further iteration.

---

## Cross-References

| Document | Location |
|----------|----------|
| Architect briefing | [`v0.4.25__briefing__pki-messaging-architecture.md`](../../architect/reviews/26-02-20/v0.4.25__briefing__pki-messaging-architecture.md) |
| Librarian master index | [`v0.4.25__master-index__pki-messaging-session.md`](../../librarian/reviews/26-02-20/v0.4.25__master-index__pki-messaging-session.md) |
| Historian milestone | [`v0.4.25__milestone__first-pki-message-exchange.md`](../../historian/reviews/26-02-20/v0.4.25__milestone__first-pki-message-exchange.md) |
