# v0.2.24 — QA Response to Daily Brief (13 Feb 2026)

**Version:** v0.2.24
**Date:** 2026-02-13
**Role:** QA
**Context:** Response to `team/humans/dinis_cruz/briefs/02/13/v0.2.16__daily-brief__sgraph-send-13-feb-2026.md`

---

## 1. Test Implications for New Features

### Hash-Fragment URLs

**New tests needed:**

| Test | Type | Description |
|------|------|-------------|
| `test_download_page_parses_hash_fragment` | Unit (JS) | Verify `#{transferId}/{key}` is correctly parsed |
| `test_download_page_fallback_query_param` | Unit (JS) | Verify `?id=xxx` still works when no hash present |
| `test_hash_fragment_not_in_server_logs` | Integration | Verify Lambda event object does not contain fragment |
| `test_history_replace_after_decrypt` | E2E (Playwright) | Verify URL bar cleared after successful decryption |
| `test_combined_url_copy_button` | E2E (Playwright) | Verify single copy button produces correct URL format |
| `test_upload_generates_hash_url` | Unit (JS) | Verify upload success shows `#id/key` format URL |

### Text Input

**New tests needed:**

| Test | Type | Description |
|------|------|-------------|
| `test_text_input_encrypts_correctly` | Unit (JS) | Text → bytes → encrypt → decrypt → original text |
| `test_text_mode_toggle` | E2E (Playwright) | Tab switching between file and text modes |
| `test_text_displays_after_decrypt` | E2E (Playwright) | Text content shown in pre element, not auto-downloaded |
| `test_text_copy_to_clipboard` | E2E (Playwright) | Copy button works for decrypted text |
| `test_text_xss_protection` | Security | Verify HTML in text is escaped (textContent not innerHTML) |
| `test_text_transfer_backend` | Unit (Python) | Backend accepts and returns content_type field |

### Admin Tokens

**New tests needed:**

| Test | Type | Description |
|------|------|-------------|
| `test_token_create` | Unit (Python) | Create token via admin API |
| `test_token_create_batch` | Unit (Python) | Create multiple tokens in one call |
| `test_token_list` | Unit (Python) | List tokens with status filter |
| `test_token_revoke` | Unit (Python) | Revoke a token |
| `test_token_lifecycle` | Integration | Create → use → mark used → cannot reuse |
| `test_token_expiry` | Unit (Python) | Expired tokens are rejected |
| `test_token_in_url` | E2E (Playwright) | `?token=xxx` grants access |
| `test_token_storage_indexed` | Unit (Python) | Token stored at `/tokens/{id}/token.json` |

### i18n

**New tests needed:**

| Test | Type | Description |
|------|------|-------------|
| `test_i18n_loads_default_language` | Unit (JS) | English loaded when no preference |
| `test_i18n_loads_saved_language` | Unit (JS) | Respects localStorage preference |
| `test_i18n_fallback_to_english` | Unit (JS) | Missing key falls back to English |
| `test_all_keys_present_in_translations` | CI | Every key in en.json exists in pt.json |
| `test_no_hardcoded_strings` | CI | Grep for string literals in component render methods |

### Themes

**New tests needed:**

| Test | Type | Description |
|------|------|-------------|
| `test_theme_switching` | E2E (Playwright) | data-theme attribute changes |
| `test_theme_persists` | E2E (Playwright) | Reload preserves theme |
| `test_theme_respects_system_preference` | E2E (Playwright) | prefers-color-scheme → default theme |
| `test_theme_accessibility_contrast` | Accessibility | All themes meet WCAG AA (4.5:1 text contrast) |
| `test_all_themes_render` | Visual regression | Screenshot each theme, compare for layout breakage |

---

## 2. Updated Test Count Estimate

| Area | Current Tests | New Tests Needed | Total |
|------|--------------|-----------------|-------|
| Transfer lifecycle (existing) | ~56 | 0 | 56 |
| Hash-fragment URLs | 0 | 6 | 6 |
| Text input | 0 | 6 | 6 |
| Admin tokens | 0 | 8 | 8 |
| i18n | 0 | 5 | 5 |
| Themes | 0 | 5 | 5 |
| Email sharing | 0 | 3 | 3 |
| Event data UI | 0 | 2 | 2 |
| **Total** | **56** | **35** | **~91** |

---

## 3. Testing Priorities

### Immediate (with P1 features)
1. Hash-fragment parsing tests (unit) — can write now
2. Text encryption round-trip test (unit) — can write now
3. Backend content_type field test (unit) — can write once schema updated

### Before Public Launch
4. Playwright E2E for full upload → share → download flow
5. Token lifecycle tests
6. Accessibility contrast tests for all themes

### Synthetic User Testing (per Sherpa/Advocate roles)
7. Each synthetic user persona tests the hash-fragment flow
8. Each theme variant tested by appropriate synthetic user
9. Multi-language flow tested (en, pt)

---

## 4. Regression Risk

The hash-fragment change touches the core download flow. **Regression risk: MEDIUM.**

Mitigation:
- Maintain backwards compatibility (query param fallback)
- E2E smoke test after deployment: upload → get combined URL → download → verify
- The existing transfer lifecycle tests cover the backend — frontend changes are the risk area

---

## Summary: QA Actions

| # | Action | Priority |
|---|---|---|
| 1 | Write hash-fragment parsing unit tests | P1 |
| 2 | Write text encryption round-trip tests | P1 |
| 3 | Write token lifecycle tests (once backend implemented) | P2 |
| 4 | Define Playwright E2E for combined URL flow | P2 |
| 5 | Create i18n key completeness CI check | P2 |
| 6 | Define accessibility contrast test matrix | P2 |
