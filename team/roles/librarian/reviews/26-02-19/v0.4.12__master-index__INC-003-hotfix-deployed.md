# v0.4.12 -- Master Index: INC-003 Access Token Leak Hotfix Deployed

**Version:** v0.4.12
**Date:** 19 February 2026
**Role:** Librarian
**Session:** Explorer team
**Type:** Incident-specific index (supplement to [`v0.4.12__master-index__briefs-17-18-19-feb.md`](v0.4.12__master-index__briefs-17-18-19-feb.md))

---

## Read This First

This is a **supplementary index** covering the INC-003 security incident -- discovery, hotfix, deployment, and all role responses produced on 19 February 2026. It does not replace the main 17-18-19 Feb master index; it extends it with the incident-specific deliverables.

**Key fact:** The access token leak was discovered at ~13:50, and the fix was deployed to production by ~15:30 -- approximately 100 minutes from discovery to resolution.

---

## 1. Documents Produced

### 1.1 Incident Response Chain

| # | Document | Role | Location | Status |
|---|----------|------|----------|--------|
| 1 | **Incident response report** | AppSec | [`team/roles/appsec/reviews/26-02-19/v0.4.12__incident-response__access-token-leak.md`](../../appsec/reviews/26-02-19/v0.4.12__incident-response__access-token-leak.md) | Complete |
| 2 | **Security hotfix** (code) | Dev | Commit `eb084f5` (8 files changed) | **Deployed to production** |
| 3 | **Incident record** | Historian | [`team/roles/historian/reviews/26-02-19/v0.4.12__incident-record__INC-003__access-token-leak-hotfix.md`](../../historian/reviews/26-02-19/v0.4.12__incident-record__INC-003__access-token-leak-hotfix.md) | Complete |
| 4 | **Article: The 100-Minute Security Hotfix** | Journalist | [`team/roles/journalist/reviews/26-02-19/v0.4.12__article__100-minute-security-hotfix.md`](../../journalist/reviews/26-02-19/v0.4.12__article__100-minute-security-hotfix.md) | Complete |
| 5 | **This master index** | Librarian | This file | Complete |
| 6 | **Feature brief: delegated token authorization** | AppSec/Architect | [`team/roles/appsec/reviews/26-02-19/`](../../appsec/reviews/26-02-19/) (if produced) | See note below |

**Note on feature brief:** An AppSec review produced a "delegated token authorization" feature brief as a forward-looking recommendation. Check the appsec reviews folder for this document.

### 1.2 Code Changes (Hotfix)

| File | Change | Version Affected |
|------|--------|-----------------|
| `sgraph_ai_app_send__ui__user/v0/v0.1/v0.1.3/components/send-upload/send-upload.js` | Removed token from URL construction | v0.1.3 |
| `sgraph_ai_app_send__ui__user/v0/v0.1/v0.1.4/components/send-upload/send-upload.js` | Removed token from URL construction | v0.1.4 |
| `sgraph_ai_app_send__ui__user/v0/v0.1/v0.1.5/components/send-upload/send-upload.js` | Removed token from URL construction | v0.1.5 |
| `sgraph_ai_app_send__ui__user/v0/v0.1/v0.1.6/components/send-upload/send-upload.js` | Removed token from URL construction | v0.1.6 |
| `sgraph_ai_app_send/lambda__user/routes/Routes__Transfers.py` | Removed `token_name` from complete endpoint response | Backend |
| `tests/unit/test_Routes__Transfers__with_tokens.py` | Assertions now verify token_name is NOT in response | Test |
| `tests/unit/test_url_sanitisation.py` | **New file** -- negative security tests for URL content | Test |

### 1.3 Test Evidence

- **153 tests passing** (local run by human before deployment)
- New `test_url_sanitisation.py` suite: verifies no `token`, `key`, `secret`, or `password` patterns in URL construction paths
- Existing test `test__complete_returns_token_name` renamed to `test__complete_does_not_return_token_name` with inverted assertions

---

## 2. Incident Timeline

| Time (19 Feb) | Event | Actor | Evidence |
|---------------|-------|-------|----------|
| ~13:50 | Token discovered in live shareable URL | Dinis Cruz | Screenshot (before) |
| ~14:00 | Classified P3-as-P1 | Dinis Cruz | |
| 14:56 | AppSec incident response report committed | Agent | Git log |
| ~15:04 | Security hotfix committed (8 files) | Agent | Commit `eb084f5` |
| ~15:10 | Review: fix on wrong branch (feature branch with unreviewed work) | Dinis Cruz | |
| ~15:20 | Cherry-picked to clean `hotfix-token-leak` branch from `dev` | Agent | Commit `3437719` |
| ~15:30 | Deployed to production | Dinis Cruz | Screenshot (after) |
| ~15:30 | 153 tests confirmed passing | Dinis Cruz | Local test run |

### Production Evidence

**Before (token visible in query string):**
```
https://send.sgraph.ai/send/v0/v0.1/v0.1.6/download.html?token=[REDACTED]#[TRANSFER-ID-1]/[DECRYPTION-KEY-1]
```

**After (clean URL, no query parameters):**
```
https://send.sgraph.ai/send/v0/v0.1/v0.1.6/download.html#[TRANSFER-ID-2]/[DECRYPTION-KEY-2]
```

---

## 3. Cross-Reference: Incident Registry

| ID | Date | Type | Severity | Documents | Status |
|----|------|------|----------|-----------|--------|
| INC-001 | 12 Feb | Commit impersonation | Process | [`v0.2.16__incident-analysis__INC-001__commit-impersonation.md`](../../appsec/reviews/26-02-12/v0.2.16__incident-analysis__INC-001__commit-impersonation.md) | Resolved |
| INC-002 | 17 Feb | External security review | P1 (process) | [Incident pack](../../../../library/sgraph-send/incidents/2026-02-17-security-review/BRIEF.md), [GRC framework](../../grc/reviews/26-02-17/v0.4.9__vulnerability-classification-framework.md), [Conductor dispatch](../../conductor/reviews/26-02-17/v0.4.9__wave-1-dispatch__INC-002.md) | In progress (P3 fixes pending) |
| **INC-003** | **19 Feb** | **Access token in URLs** | **P3-as-P1** | **This index + 4 documents above** | **Resolved -- deployed to production** |

---

## 4. Decision Register Additions

The Historian logged six decisions (D068-D073) for this incident. Key decisions for cross-referencing:

| ID | Decision | Impact |
|----|----------|--------|
| D068 | Sender tokens must never appear in shareable URLs | Security principle |
| D069 | Backend must not return token_name in transfer completion response | Code pattern |
| D070 | URL sanitisation tests are mandatory for all URL construction paths | Testing policy |
| D071 | Security hotfixes use dedicated branches from dev | Process pattern |
| D072 | Downloads work without tokens in the URL | Architecture confirmation |
| D073 | All affected IFD versions patched simultaneously for security fixes | IFD override policy |

---

## 5. Outstanding Actions

| # | Action | Priority | Owner | Status |
|---|--------|----------|-------|--------|
| 1 | ~~Deploy hotfix to production~~ | ~~P1~~ | ~~Dinis Cruz~~ | **DONE (19 Feb ~15:30)** |
| 2 | Rotate all active tokens for affected users | P2 | Dinis Cruz | **Pending** -- Q014 in Historian record |
| 3 | Audit server logs for exposed tokens | P2 | DevOps | **Pending** -- Q015 in Historian record |
| 4 | CI/CD URL scanner (regex check for sensitive patterns in URL construction) | P2 | DevOps | Backlog |
| 5 | Shareable URL contract (formal spec) | P2 | Architect | Backlog |
| 6 | Referrer-Policy header audit | P2 | AppSec | Backlog |
| 7 | Download authorization model design | P3 | Architect | **Pending** -- Q016 in Historian record |

---

## 6. Reading Order

For anyone coming to this incident fresh:

1. **This index** (you're reading it) -- overall orientation and document map
2. **AppSec incident response** -- technical root cause, blast radius, hotfix details, preventive measures
3. **Journalist article** -- narrative account of the 100-minute response, lessons learned
4. **Historian incident record** -- milestone M016, decisions D068-D073, patterns 17-19, open questions Q014-Q016

---

## 7. Connection to Main Index

This supplementary index should be read alongside the main 17-18-19 Feb master index:

- [`v0.4.12__master-index__briefs-17-18-19-feb.md`](v0.4.12__master-index__briefs-17-18-19-feb.md)

The main index catalogued the AppSec incident response report as one of the documents produced on 19 Feb. This supplementary index adds the three role responses (Historian, Journalist, Librarian) that were produced after the hotfix was deployed and confirmed in production.

**Updated document count for 19 Feb:** Main index documents + 4 new documents (this index, Historian record, Journalist article, and the code hotfix itself).

---

*Librarian supplementary index complete. INC-003 is resolved and deployed. Four documents produced across four roles (AppSec, Historian, Journalist, Librarian). Six decisions logged. Three outstanding actions remain: token rotation, server log audit, and download authorization model design. Next Librarian action: update the main master index to cross-reference this supplementary index.*
