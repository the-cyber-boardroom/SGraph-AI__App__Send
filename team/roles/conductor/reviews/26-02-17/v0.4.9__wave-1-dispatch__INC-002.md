# v0.4.9 — Conductor Wave 1 Dispatch: INC-002

**Version:** v0.4.9
**Date:** 2026-02-17
**Role:** Conductor
**Incident:** INC-002
**Wave:** 1 — Immediate

---

## Wave 1 Scope Adjustment

The original incident declaration placed three findings in Wave 1 as P3:
- #4 Token validation fails open
- #5 Plaintext in localStorage
- #1 Token race condition

**Finding #1 is reclassified to P5 and removed from Wave 1.** The joint GRC + AppSec + Architect risk analysis (`v0.4.9__risk-analysis__finding-1-token-race-condition.md`) concludes:

- The race condition is a **quota bypass**, not a data breach
- Server stores only encrypted bytes — exploitation gains no data access
- All fix options (DynamoDB, S3 conditional, CAS) introduce more architectural risk than they remove
- The proper fix belongs in the production storage architecture redesign
- **Decision: accept with monitoring** (pending human sign-off)

This leaves **two P3 findings** for Wave 1, plus the classification work and critical test gap.

---

## Wave 1 Tasks: DISPATCHED

### Track A: P3 Fixes (Developer + AppSec)

| # | Task | Owner | Effort | Dependency |
|---|------|-------|--------|-----------|
| W1-01 | **Fix #4: Token validation fails closed** — raise exception at startup if admin config missing. Replace silent exception catch. No code path may skip auth silently. | Developer | Small | None |
| W1-02 | **AppSec validate #4** — audit all code paths for other fails-open patterns. Confirm fix fails closed in all scenarios (missing config, invalid config, exception, timeout). | AppSec | Small | W1-01 |
| W1-03 | **Fix #5: localStorage** — switch decrypted text to sessionStorage (or encrypt). Make history opt-in. Remove plaintext access tokens from localStorage. Add clear-data button. | Developer | Medium | None |
| W1-04 | **AppSec validate #5** — verify no plaintext remains in localStorage by default after decryption. Review opt-in flow. | AppSec | Small | W1-03 |
| W1-05 | **DPO review #5** — review privacy implications of any local storage approach. | DPO | Small | W1-03 |

### Track B: Finding Classification (GRC + AppSec)

| # | Task | Owner | Effort | Dependency |
|---|------|-------|--------|-----------|
| W1-06 | **Classify all 29 findings** as known/accepted or unknown using the new vulnerability classification framework. | GRC + AppSec | Medium | Framework done (v0.4.9) |
| W1-07 | **2nd/3rd story analysis** for any findings classified as "unknown / missed" — why did we miss this? What systemic change prevents similar misses? | AppSec + GRC | Medium | W1-06 |
| W1-08 | **Human sign-off on #1 reclassification** — review risk analysis, approve P5 classification and risk acceptance. | Human | — | Risk analysis done (v0.4.9) |

### Track C: Critical Test (QA)

| # | Task | Owner | Effort | Dependency |
|---|------|-------|--------|-----------|
| W1-09 | **Write test: plaintext never reaches server** — the most important test for a zero-knowledge product. | QA | Medium | None |
| W1-10 | **Write tests: auth edge cases** — expired, revoked, and exhausted tokens. Missing config. Invalid config. | QA | Medium | None |

### Track D: Monitoring (Developer)

| # | Task | Owner | Effort | Dependency |
|---|------|-------|--------|-----------|
| W1-11 | **Add usage anomaly logging for #1** — log when `usage_count` exceeds `usage_limit`. One-line change. This is the monitoring component of the risk acceptance. | Developer | Tiny | None |

### Track E: Quick Win (GRC)

| # | Task | Owner | Effort | Dependency |
|---|------|-------|--------|-----------|
| W1-12 | **Fix README** — remove false claim about "SHA-256 with daily rotating salt." Update to reflect actual IP handling (currently hardcoded to empty string). | GRC | Tiny | None |

---

## Parallelisation

Tracks A through E are independent and can proceed in parallel:

```
Track A: Developer → AppSec → DPO     (P3 fixes)
Track B: GRC + AppSec                  (classification)
Track C: QA                            (tests)
Track D: Developer                     (one-line logging)
Track E: GRC                           (README fix)
```

---

## Wave 1 Completion Criteria

Wave 1 is complete when:

1. Finding #4 fixed, validated by AppSec, tests passing
2. Finding #5 fixed, validated by AppSec, DPO reviewed, tests passing
3. All 29 findings classified as known/accepted or unknown
4. 2nd/3rd story analysis complete for unknowns
5. Human has signed off on #1 reclassification
6. Plaintext-never-reaches-server test exists and passes
7. Auth edge case tests exist and pass
8. Usage anomaly logging deployed
9. README is accurate

**After Wave 1:** Conductor dispatches Wave 2 (P4 quick wins: GitHub Actions SHA pinning, URL hash clearing, CSP, path traversal fix, markdown rendering).

---

## Key References

| Document | Location |
|----------|----------|
| Incident declaration | `team/roles/conductor/reviews/26-02-17/v0.4.9__incident-declaration__INC-002__first-external-security-disclosure.md` |
| Vulnerability framework | `team/roles/grc/reviews/26-02-17/v0.4.9__vulnerability-classification-framework.md` |
| #1 risk analysis | `team/roles/grc/reviews/26-02-17/v0.4.9__risk-analysis__finding-1-token-race-condition.md` |
| P3-04 pack | `library/sgraph-send/incidents/2026-02-17-security-review/p3-04-token-validation-fails-open/` |
| P3-05 pack | `library/sgraph-send/incidents/2026-02-17-security-review/p3-05-localstorage-plaintext/` |
| Test gaps pack | `library/sgraph-send/incidents/2026-02-17-security-review/test-gaps/` |

---

*Dispatched by Conductor | INC-002 Wave 1 | SGraph Send v0.4.9*
