# v0.4.9 -- Conductor Incident Declaration: INC-002 — First External Security Disclosure

**Version:** v0.4.9
**Date:** 2026-02-17
**Role:** Conductor
**Team:** Explorer (primary), Villager (deployment pipeline when fixes ready)
**Incident ID:** INC-002
**Severity:** P1 (process rigour — not individual finding severity)
**Type:** Externally reported vulnerability disclosure

---

## 1. INCIDENT DECLARED

**Trigger:** Human daily brief (`v0.4.7__daily-brief__all-teams-17-feb-2026.md`) — P1 INCIDENT status.

**What happened:** Two beta users provided feedback on SG/Send. User A (security professional) conducted a full-stack security code review of the open-source codebase and delivered a 29-finding security report via SG/Send itself. User B (beta tester) confirmed the product works and provided 3 feature requests.

**Why P1:** Not because any individual finding is P1 (none are — all reclassified P3-P8 on our business-impact scale). P1 because:

- This is our **first external security disclosure** — we set the standard now
- The report is comprehensive (29 findings) and deserves a thorough, structured response
- The reporter is a key stakeholder who used our product to deliver the report
- This is the opportunity to prove our incident response process works
- Per our incident philosophy: P3 incidents are run with P1 rigour — the systemic weakness is the same, only the luck differs

**Data impact:** None. Zero-knowledge model validated by external reviewer. No sensitive data on platform. No active exploitation.

**Disclosure status:** Reporter is aware. Code is open source.

---

## 2. TEAM ASSEMBLED — Role Activation Roster

| Role | Activation | Responsibility | Priority |
|------|-----------|---------------|----------|
| **Conductor** | ACTIVE — incident lead | Orchestrate response, track progress, manage communications | Continuous |
| **AppSec** | ACTIVE — technical lead | Validate findings, classify known/unknown, review fixes, security testing | P1 |
| **Developer** | ACTIVE | Implement P3 fixes, P4 quick wins | P1 |
| **Architect** | ACTIVE | Review race condition fix (#1, #23), pre-signed URL research (#3) | P2 |
| **GRC** | ACTIVE | Vulnerability classification framework, risk acceptance statements, known/unknown classification | P2 |
| **DPO** | ACTIVE | IP address decision (#6, #7), localStorage privacy review (#5) | P2 |
| **DevOps** | ACTIVE | GitHub Actions pin to SHA (#2), security.txt, deployment of fixes | P2 |
| **QA** | ACTIVE | Write missing tests (plaintext-never-reaches-server, auth edge cases, E2E encryption) | P2 |
| **Librarian** | ACTIVE | Maintain incident pack, master index, debrief | P3 |
| **Journalist** | ACTIVE | Case study article, stakeholder communications, User A interview | P3 |
| **Ambassador** | ACTIVE | Firefox Send research, messaging from User A validation quote, bug bounty page | P3 |
| **Sherpa** | ACTIVE | User A relationship management, User B relationship, UX friction from report | P3 |
| **Historian** | ACTIVE | Decision records for risk acceptance, IP address decision, incident timeline | P3 |

**Not activated:** Designer (no UI design work in incident scope), Translator (no translation work), CISO (covered by AppSec + GRC for this scope).

---

## 3. SITUATION BRIEF

### What We Know

- **Crypto is sound.** AES-256-GCM via Web Crypto API. Server never sees plaintext or keys. Zero-knowledge model validated by independent external reviewer.
- **29 findings.** Reclassified from reviewer's P0-P3 to our P3-P8. 0 P0, 0 P1, 0 P2.
- **3 must-fix-before-production (P3):**
  1. Token validation fails open — missing env var silently skips all auth (#4)
  2. Plaintext in localStorage — decrypted text and tokens persist across sessions (#5)
  3. Token race condition — non-atomic read-modify-write bypasses usage limits (#1)
- **Client-side data exposure chain** — findings #5 + #10 (no CSP) + #9 (key visible in URL) form an interconnected threat: XSS could exfiltrate decryption history.
- **12 of 13 feature suggestions** already on our roadmap — strong product-direction validation.
- **User A validated core value proposition:** "I can't tell you how many times I've needed something like this."

### What We Don't Know

- **Known vs Unknown classification:** For each finding — did we already know about it? Was risk previously accepted? Or is this a gap in our security review process? AppSec + GRC must classify.
- **Pre-signed URL size constraints:** When we move to S3 direct uploads, can we enforce max upload size? Research needed (#3).
- **IP address / fingerprinting direction:** The DPO position is "no IPs" but implementation is accidental (hardcoded empty string). Need a deliberate decision.
- **Firefox Send abuse vectors:** How do we prevent SG/Send from being used for malware distribution? Research needed before scaling.

### Initial Hypothesis

The findings cluster around four themes: auth/access control, client-side data exposure, supply chain hygiene, and documentation accuracy. None compromise user data today (encrypted bytes only on server), but the auth and client-side themes become critical before production launch with real users. The systemic question: why didn't our internal reviews catch the "fails open" pattern? That's the 2nd/3rd story investigation for AppSec and GRC.

---

## 4. INVESTIGATION TASKS — Routed to Roles

### Wave 1: Immediate (P3 fixes + classification)

| Task | Owner | Dependency | Output |
|------|-------|-----------|--------|
| Classify all 29 findings as known/accepted or unknown | AppSec + GRC | None | Classification document |
| For unknowns: 2nd/3rd story root cause analysis | AppSec + GRC | Classification | Process improvement recommendations |
| Fix #4: Token validation fails closed at startup | Developer + AppSec | None | Code fix + test |
| Fix #5: localStorage — sessionStorage or encrypt, history opt-in | Developer + AppSec | None | Code fix + test |
| Fix #1: Token race condition — atomic increment | Developer + Architect | Architecture decision (DynamoDB ADD or S3 conditional write) | Code fix + test |
| Write test: plaintext never reaches server | QA | None | Test |
| Write tests: auth edge cases (expired/revoked/exhausted tokens) | QA | None | Tests |

### Wave 2: Should-fix (P4) + Quick Wins

| Task | Owner | Dependency | Output |
|------|-------|-----------|--------|
| Pin GitHub Actions to commit SHA | DevOps | None | CI fix (4 lines) |
| Clear decryption key from URL hash immediately | Developer | None | One-line code fix |
| Add Content-Security-Policy to all pages | Developer + AppSec | Requires moving inline JS to external files | Code fix |
| Path injection fix in admin cache browser (#14) | Developer | None | Code fix + test |
| Research: pre-signed URL size constraints | Architect + DevOps | None | Research document |
| Markdown rendering on decryption page (mini parser + sandboxed iframe) | Developer + AppSec | None | Feature |

### Wave 3: Decisions + Defence-in-Depth

| Task | Owner | Dependency | Output |
|------|-------|-----------|--------|
| IP address decision: remove hashing code vs browser fingerprinting | DPO + AppSec + Sherpa | Sherpa maps use case first | Decision record |
| Fix README: remove "SHA-256 with daily rotating salt" claim | GRC | None (immediate) | README fix |
| Define vulnerability classification framework (P0-P10) | GRC | None | Published framework |
| Prepare risk acceptance statements for no-fix items | GRC | Classification (Wave 1) | Risk acceptance docs |
| S3 public access block | DevOps | None | Infrastructure fix |
| Rate limiting research | Architect | None | Research document |

### Wave 4: Infrastructure + Communications

| Task | Owner | Dependency | Output |
|------|-------|-----------|--------|
| Create security.txt at well-known URI | DevOps | None | Infrastructure |
| Create bug bounty page | Ambassador + AppSec | None | Documentation |
| Create security-report access token for SG/Send | Developer | None | Configuration |
| Vulnerability register (public page) | GRC + Librarian | All findings classified | Published page |
| Firefox Send research | Ambassador + AppSec + GRC | None | Research document |
| Browser security / WebAuthn research | Architect + AppSec | None | Research document |
| Case study article: "How Our First Security Review Went" | Journalist + Historian | Fixes deployed | Published article |
| User A voice interview | Journalist + Ambassador + Sherpa + AppSec + Advocate | Interview brief ready (DONE: v0.4.9) | Interview transcript |

### Wave 5: Stakeholder Follow-up

| Task | Owner | Dependency | Output |
|------|-------|-----------|--------|
| Share incident brief with User A: "does this capture it all?" | Conductor (via human) | This document | Communication |
| Report fix status to User A as items resolve | Sherpa | Wave 1-2 fixes | Ongoing updates |
| Invite User A to review deployed fixes | Sherpa | Fixes deployed | Relationship |
| Credit User A publicly (with consent) | Ambassador + Journalist | User A consent | Publication |
| Notify User B when expiring links ship | Sherpa | TTL feature built | Communication |

---

## 5. SIMULATION CHECKPOINT

Before deploying any fix to production, the team must:

1. **Model the fix** — Developer describes the change, Architect confirms it doesn't introduce new issues
2. **AppSec validates** — security review of the fix itself (especially for auth changes)
3. **QA confirms** — tests pass, no regression, new tests cover the finding
4. **Simulate before acting** — for auth changes (#1, #4), walk through the failure modes: what happens if the fix itself has a bug? Does it fail open or closed?

This is especially critical for #4 (token validation fails open) — the fix must guarantee that ANY failure mode results in auth denial, never auth bypass.

---

## 6. COMMUNICATIONS PLAN

| Audience | Channel | Content | When |
|----------|---------|---------|------|
| **User A** (security reviewer) | SG/Send + direct message | Incident brief summary, acknowledge all 29 findings, share severity reclassification rationale | Immediate (human sends) |
| **User B** (beta tester) | WhatsApp community | Acknowledge feedback, confirm features on roadmap | Done (human already responded) |
| **Internal team** | This document + pack-of-packs | Full incident detail, task assignments, wave plan | Now |
| **Public** (when fixes deployed) | GitHub security advisory + blog | Findings, fixes, credits, transparency narrative | After Wave 1-2 complete |

---

## 7. TIMELINE

| Date | Event |
|------|-------|
| 16 Feb 2026 | User A delivers security report via SG/Send |
| 16 Feb 2026 | User B confirms product works, provides 3 feature requests |
| 17 Feb 2026 | Human publishes daily brief — declares P1 incident |
| 17 Feb 2026 | **Conductor declares INC-002** — this document |
| 17 Feb 2026 | Pack-of-packs created in `library/sgraph-send/incidents/2026-02-17-security-review/` |
| TBD | Wave 1 complete (P3 fixes + classification) |
| TBD | Wave 2 complete (P4 fixes + quick wins) |
| TBD | Wave 3 complete (decisions + defence-in-depth) |
| TBD | Wave 4 complete (infrastructure + communications) |
| TBD | Wave 5 complete (stakeholder follow-up) |
| TBD | Incident closed — post-incident review |

---

## Sprint Plan Adjustment

The current sprint is **paused for incident response**. All Explorer team work is redirected to INC-002 until Wave 1 (P3 fixes) and Wave 2 (P4 fixes) are complete. The Villager team continues normal operations but prepares the deployment pipeline for receiving fixes.

**Previous sprint items** (from v0.3.12 action plan) are deferred, not cancelled. They resume after the incident is resolved.

---

## Key References

| Document | Location |
|----------|----------|
| Triggering brief | `team/humans/dinis_cruz/briefs/02/17/v0.4.7__daily-brief__all-teams-17-feb-2026.md` |
| Incident pack | `library/sgraph-send/incidents/2026-02-17-security-review/` |
| Incident philosophy | `team/humans/dinis_cruz/briefs/02/13/v0.2.23__briefs__incident-philosophy-p3-as-p1.md` |
| Incident practice | `team/humans/dinis_cruz/briefs/02/13/v0.2.23__briefs__incident-practice-running-p3-as-p1.md` |
| Previous incident (INC-001) | `team/roles/appsec/reviews/26-02-12/v0.2.16__incident-analysis__INC-001__commit-impersonation.md` |
| Tabletop exercise | `team/roles/appsec/reviews/26-02-13/v0.2.24__tabletop-exercise__total-aws-compromise.md` |
| Briefing pack pattern | `team/humans/dinis_cruz/briefs/02/16/v0.4.4__briefs__briefing-packs-for-agents.md` |
| User A interview brief | `team/roles/journalist/reviews/26-02-17/v0.4.9__interview-brief__user-a-security-reviewer.md` |

---

*Declared by Conductor | INC-002 | SGraph Send v0.4.9*
