# Dev Review: Vault Manager Feature Enhancements

**version** v0.5.19
**date** 22 Feb 2026
**role** Dev
**status** Complete

---

## Summary

Enhanced both the user-facing vault (`user-vault.js`) and admin vault manager (`vault-manager.js`) with six improvements to usability and UX.

## Changes

### 1. Generate Key Pair Button UX Fix

**Problem:** RSA-4096 key generation takes several seconds. The previous "loading" state showed "Loading vault..." which was misleading. Users had no indication that key generation was in progress.

**Fix:** Added a dedicated `'generating'` state that shows "Generating RSA-4096 key pair... this may take a few seconds". The no-key screen also now includes a hint below the button: "RSA-4096 -- may take a few seconds to generate".

**Files:** `user-vault.js` (user-facing component)

### 2. Sortable Columns

**Before:** Items sorted alphabetically (folders first), no user control.
**After:** Sort by Name or Size. Clicking toggles ascending/descending. Sort indicator arrow shown. Folders always float to top regardless of sort.

**User vault:** Sort buttons in toolbar ("Sort: Name | Size").
**Admin vault:** Clickable table column headers (Name, Size) with active state highlighting.

### 3. Inline Folder Creation

**Before:** Browser `prompt('Folder name:')` dialog.
**After:** Inline input row appears at the top of the file list. Enter to create, Escape to cancel, or click Create/Cancel buttons. Auto-focuses the input.

### 4. Inline Delete Confirmation

**Before:** Browser `confirm('Delete "file"?')` dialog.
**After:** The row's action buttons transform into "Delete? [Yes] [No]" inline. No modal interruption. Cancel returns to normal buttons.

### 5. Vault Statistics Bar

**User vault:** Footer shows "X folders | Y files | Z encrypted" plus a lock icon with "Zero-knowledge encrypted" label.
**Admin vault:** Status bar extended with live stats: "X folders, Y files, Z encrypted" alongside key fingerprint and vault ID.

### 6. File/Folder Rename

**Both components:** Rename button on each row. Double-click on item name also enters rename mode. Inline input with Enter to save, Escape to cancel, blur to save. Updates encrypted index on server.

## Files Changed

| File | Change |
|------|--------|
| `sgraph_ai_app_send__ui__user/v0/v0.1/v0.1.7/components/user-vault/user-vault.js` | Full feature upgrade |
| `sgraph_ai_app_send__ui__admin/v0/v0.1/v0.1.5/components/vault-manager/vault-manager.js` | Full feature upgrade |

## Testing

- 211 backend tests pass, 0 failures
- Frontend changes are UI-only (no backend API changes)
- All existing vault API contracts preserved

## Security Notes

- No crypto changes in this commit
- Rename updates only the encrypted client-side index (server never sees names)
- `extractable: false` preserved per AppSec directive (separate commit)

---

This document is released under the Creative Commons Attribution 4.0 International licence (CC BY 4.0).
