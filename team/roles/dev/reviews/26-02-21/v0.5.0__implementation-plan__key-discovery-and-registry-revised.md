# v0.5.0 â€” Implementation Plan: Key Discovery & Registry (REVISED)

**Version:** v0.5.0
**Date:** 2026-02-21
**Role:** Developer
**Team:** Explorer
**Status:** Revised based on human decisions â€” ready for implementation
**Previous plan:** [`v0.5.0__implementation-plan__key-discovery-and-registry.md`](v0.5.0__implementation-plan__key-discovery-and-registry.md)
**IFD architecture reference:** `library/guides/development/ifd/ifd__issues-fs/`

---

## Revision Summary

The original plan assumed standalone HTML pages (matching the `pki.html` pattern). The project owner has directed a **full architectural shift** to the IFD Issues-FS modular UI pattern. Key changes:

1. **All components loaded inside the admin shell** â€” no standalone pages
2. **IFD architecture** â€” EventBus, Shell+Router, Web Components (light DOM), Services
3. **3 debug side panels** â€” API Invocations, UI Events, UI Messages (from Issues-FS)
4. **Refactor pki.html** â€” break into separate components, each doing one thing, communicating via events
5. **New version v0.1.3** â€” per IFD methodology, new features = new version
6. **Case-insensitive lookup codes** â€” normalise to lowercase at API boundary
7. **Backend data browser** â€” expose Memory-FS content for visual debugging
8. **API-first** â€” everything exposed via REST API (admin-only), which powers the UI
9. **All endpoints on Admin Lambda** â€” already protected by Fast_API cookie auth

---

## 1. Non-Negotiable Constraints

1. **IFD architecture** â€” EventBus for all component communication, Shell+Router for navigation, light DOM (no Shadow DOM), self-contained components
2. **All schemas use Type_Safe** â€” never Pydantic
3. **All storage goes through Memory-FS** (`Send__Cache__Client`) â€” never direct filesystem or S3
4. **All tests use real implementations** â€” no mocks, no patches, in-memory Memory-FS
5. **No plaintext names on server** â€” only Obj_Ids, PEM keys, timestamps, codes
6. **Case-insensitive lookup codes** â€” normalise to lowercase at API boundary, display uppercase
7. **New version v0.1.3** â€” previous versions (v0.1.0, v0.1.1, v0.1.2) are frozen
8. **3 debug panels required** â€” API Invocations, UI Events, UI Messages

---

## 2. Architecture: IFD Admin Shell

The admin UI migrates from the current simple shell (Shadow DOM, `data-panel` switching) to the full IFD Issues-FS architecture.

### 2.1 Core Services (loaded first, in order)

```
window.sgraphAdmin = {
    events   : new EventBus(),          // Central event routing
    config   : new ConfigManager(),     // Persistent settings (localStorage)
    keys     : new KeysService(),       // API client for key CRUD
    messages : new MessagesService(),   // User-facing notifications
    router   : null                     // Set by shell after DOM ready
};
```

**Namespace:** `window.sgraphAdmin` (not `window.issuesApp` â€” this is the admin console).

### 2.2 Shell Layout

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  SG/Send Admin Console                                        [v0.1.3] â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Left Nav â”‚         Main Area              â”‚    Right Sidebar (Debug)    â”‚
â”‚          â”‚                                 â”‚                             â”‚
â”‚ PKI      â”‚  One component visible          â”‚  [Msgs] [Events] [API]     â”‚
â”‚ â”œ My Keysâ”‚  at a time:                     â”‚                             â”‚
â”‚ â”œ Encryptâ”‚                                 â”‚  <messages-panel>           â”‚
â”‚ â”œ Contactsâ”‚  <pki-keys>     (key mgmt)    â”‚  <events-viewer>            â”‚
â”‚          â”‚  <pki-encrypt>   (encrypt/dec)  â”‚  <api-logger>              â”‚
â”‚ Registry â”‚  <pki-contacts>  (contacts)     â”‚                             â”‚
â”‚ â”œ Publishâ”‚  <key-publish>   (publish flow) â”‚                             â”‚
â”‚ â”œ Lookup â”‚  <key-lookup>    (lookup by codeâ”‚                             â”‚
â”‚ â”œ Browse â”‚  <key-registry>  (all keys)     â”‚                             â”‚
â”‚          â”‚  <key-log>       (transparency) â”‚                             â”‚
â”‚ Tokens   â”‚                                 â”‚                             â”‚
â”‚ â”œ Manage â”‚  <token-manager> (existing)     â”‚                             â”‚
â”‚          â”‚                                 â”‚                             â”‚
â”‚ Storage  â”‚  <storage-browser> (Memory-FS)  â”‚                             â”‚
â”‚ â”œ Browse â”‚                                 â”‚                             â”‚
â”‚          â”‚                                 â”‚                             â”‚
â”‚ System   â”‚  <system-info>   (existing)     â”‚                             â”‚
â”‚ â”œ Info   â”‚  <cache-browser> (existing)     â”‚                             â”‚
â”‚ â”œ Cache  â”‚                                 â”‚                             â”‚
â”‚          â”‚  <analytics-dashboard> (exist.) â”‚                             â”‚
â”‚ Monitor  â”‚  <metrics-dashboard>  (exist.)  â”‚                             â”‚
â”‚ â”œ Metricsâ”‚                                 â”‚                             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Ready â”‚ Active: My Keys â”‚ Components: 12 â”‚ [Debug Panel ğŸ”´2]           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 2.3 Component Inventory (v0.1.3)

**New PKI components (broken out from pki-manager.js):**

| Component | Tag | Purpose | Events Consumed | Events Emitted |
|-----------|-----|---------|-----------------|----------------|
| `pki-keys` | `<pki-keys>` | Key pair generation, list, delete | `key-published`, `refresh` | `key-selected`, `key-deleted` |
| `pki-encrypt` | `<pki-encrypt>` | Encrypt/decrypt messages | `contact-selected` | `message-encrypted`, `message-decrypted` |
| `pki-contacts` | `<pki-contacts>` | Imported contacts list | `key-imported`, `refresh` | `contact-selected`, `contact-deleted` |

**New Key Discovery components:**

| Component | Tag | Purpose | Events Consumed | Events Emitted |
|-----------|-----|---------|-----------------|----------------|
| `key-publish` | `<key-publish>` | Publish key to registry | `key-selected` | `key-published` |
| `key-lookup` | `<key-lookup>` | Look up key by code | â€” | `key-imported` |
| `key-registry` | `<key-registry>` | Browse all published keys | `key-published`, `refresh` | `key-imported` |
| `key-log` | `<key-log>` | Transparency log viewer | `key-published`, `refresh` | â€” |

**New Infrastructure component:**

| Component | Tag | Purpose |
|-----------|-----|---------|
| `storage-browser` | `<storage-browser>` | Browse Memory-FS content (admin debugging) |

**Debug side panels (from IFD Issues-FS):**

| Component | Tag | Purpose |
|-----------|-----|---------|
| `messages-panel` | `<messages-panel>` | User-facing notifications (error/warning/success/info) |
| `events-viewer` | `<events-viewer>` | Live stream of all EventBus events |
| `api-logger` | `<api-logger>` | Network inspector (fetch interceptor) |

**Existing components (migrated from v0.1.2 to v0.1.3 shell):**

| Component | Tag | Migration Notes |
|-----------|-----|-----------------|
| `token-manager` | `<token-manager>` | Wrap in IFD pattern (EventBus, register with router) |
| `system-info` | `<system-info>` | Same |
| `cache-browser` | `<cache-browser>` | Same |
| `analytics-dashboard` | `<analytics-dashboard>` | Same |
| `metrics-dashboard` | `<metrics-dashboard>` | Same |

### 2.4 Event Catalogue

```
Key lifecycle:
  key-generated          { keyId, fingerprint, algorithm }
  key-deleted            { keyId, fingerprint }
  key-selected           { keyId, record }
  key-published          { code, fingerprint, objId }
  key-unpublished        { code, fingerprint }

Contact lifecycle:
  contact-imported       { contactId, fingerprint, source }
  contact-selected       { contactId, record }
  contact-deleted        { contactId }

Message operations:
  message-encrypted      { recipientFingerprint, payloadSize }
  message-decrypted      { senderFingerprint, verified }

Registry:
  registry-loaded        { count }
  log-loaded             { entryCount, headHash }
  log-verified           { valid, entries }

Navigation:
  navigated              { appId, previousAppId }
  app-registered         { appId, navLabel }

Service:
  api-call               { id, method, url, status, duration }
  api-error              { operation, error }
  message-added          { type, text, autoOpen }
  message-dismissed      { id }
  refresh                {}
  event-bus-ready        {}
  config-changed         { key, value }
  cache-cleared          {}

Storage browser:
  storage-path-selected  { path }
  storage-data-loaded    { path, data }
```

---

## 3. Backend API (unchanged from original plan, with additions)

### 3.1 Key Discovery Endpoints (on Admin Lambda)

| Method | Path | Purpose |
|--------|------|---------|
| POST | `/keys/publish` | Publish a public key â†’ get lookup code |
| GET | `/keys/lookup/{code}` | Look up key by code |
| DELETE | `/keys/unpublish/{code}` | Unpublish a key |
| GET | `/keys/list` | List all published keys |
| GET | `/keys/log` | Get transparency log entries |

**Auth:** All endpoints inherit Admin Lambda cookie auth. No additional auth needed for MVP.

**Case-insensitive codes:** All endpoints normalise `code` to lowercase before processing.

### 3.2 Storage Browser Endpoints (NEW â€” admin-only)

| Method | Path | Purpose |
|--------|------|---------|
| GET | `/storage/namespaces` | List all Memory-FS namespaces |
| GET | `/storage/browse/{namespace}` | List files in a namespace |
| GET | `/storage/read/{namespace}/{path}` | Read a specific file's content |

These endpoints expose the Memory-FS backend for admin debugging. They show exactly what's stored on the server â€” encrypted blobs, tokens, key entries, log entries. This is critical for development visibility.

### 3.3 Data Models (unchanged)

```python
class Schema__Key__Publish__Request(Type_Safe):
    public_key_pem  : str
    signing_key_pem : str = ''

class Schema__Key__Registry__Entry(Type_Safe):
    code            : str       # Lookup code (lowercase, e.g., "dc-7x4f")
    obj_id          : str       # 8-hex Obj_Id
    public_key_pem  : str
    signing_key_pem : str = ''
    fingerprint     : str       # "sha256:xxxx..."
    algorithm       : str       # "RSA-OAEP" or "ECDH"
    key_size        : int = 0
    created         : str       # ISO 8601
    active          : bool = True
```

### 3.4 Lookup Code Format

- Format: `XX-XXXX` (2 + dash + 4, base-36: a-z, 0-9)
- **Generated uppercase** for display: `DC-7X4F`
- **Stored lowercase** on server: `dc-7x4f`
- **Case-insensitive lookup**: server does `code.lower()` at API boundary
- **~2.2 billion** possible codes (36^6)

---

## 4. Phased Implementation

### Phase 1: IFD Foundation (v0.1.3 shell + EventBus + debug panels)

**Goal:** Create the v0.1.3 admin UI with IFD architecture. Migrate existing components. Add the 3 debug panels. No new features yet â€” just the architecture.

**New files:**

| File | Purpose |
|------|---------|
| `v0.1.3/index.html` | Admin entry point, loads all scripts |
| `v0.1.3/js/event-bus.js` | EventBus singleton (`window.sgraphAdmin.events`) |
| `v0.1.3/js/config-manager.js` | Persistent settings (localStorage) |
| `v0.1.3/js/messages-service.js` | User-facing notification service |
| `v0.1.3/js/admin-api.js` | API client (extends v0.1.0, adds key endpoints) |
| `v0.1.3/components/admin-shell/admin-shell.js` | New shell (light DOM, left nav, sidebar, router) |
| `v0.1.3/components/events-viewer/events-viewer.js` | Events debug panel |
| `v0.1.3/components/api-logger/api-logger.js` | API call debug panel |
| `v0.1.3/components/messages-panel/messages-panel.js` | Messages debug panel |
| `v0.1.3/css/admin.css` | Updated styles for new layout |

**Migrated components (wrap in IFD pattern):**

| Original | v0.1.3 Version | Changes |
|----------|---------------|---------|
| `v0.1.2/components/token-manager/` | `v0.1.3/components/token-manager/` | Add static `appId`/`navLabel`/`navIcon`, EventBus integration |
| `v0.1.0/components/system-info/` | `v0.1.3/components/system-info/` | Same wrapping |
| `v0.1.1/components/cache-browser/` | `v0.1.3/components/cache-browser/` | Same wrapping |
| `v0.1.1/components/metrics-dashboard/` | `v0.1.3/components/metrics-dashboard/` | Same wrapping |
| `v0.1.2/components/analytics-dashboard/` | `v0.1.3/components/analytics-dashboard/` | Same wrapping |

**Verification:** Admin console loads, left nav works, all existing components visible, debug panels open/close, events stream in events viewer, API calls logged.

**Complexity:** High (architectural foundation).

---

### Phase 2: PKI Component Refactor (break up pki-manager.js)

**Goal:** Split the 1821-line `pki-manager.js` into 3 focused components + shared utilities. Each component does one thing well, communicates via events.

**New files:**

| File | Purpose |
|------|---------|
| `v0.1.3/js/pki-common.js` | Shared PKI utilities (exported from pki-manager.js) |
| `v0.1.3/js/keys-service.js` | KeysService â€” API client for key CRUD, wraps IndexedDB + REST |
| `v0.1.3/components/pki-keys/pki-keys.js` | Key pair generation, list, delete |
| `v0.1.3/components/pki-encrypt/pki-encrypt.js` | Encrypt/decrypt message workflow |
| `v0.1.3/components/pki-contacts/pki-contacts.js` | Contacts management (import, list, delete) |

**What goes where:**

| Current pki-manager.js Section | New Component |
|-------------------------------|---------------|
| Key generation, key list, key deletion, key export | `pki-keys` |
| Encrypt, decrypt, sign, verify | `pki-encrypt` |
| Contact import, contact list, contact delete | `pki-contacts` |
| IndexedDB, fingerprint, PEM helpers | `pki-common.js` |
| API calls for keys | `keys-service.js` |

**Event flow example:**

```
User generates a key in <pki-keys>
  â†’ pki-keys emits 'key-generated' { keyId, fingerprint }
    â†’ pki-encrypt listens, updates "My Keys" dropdown
    â†’ events-viewer shows event
    â†’ messages-service shows "Key generated" success

User clicks "Publish" in <pki-keys>
  â†’ pki-keys emits 'key-selected' { record }
    â†’ key-publish listens, shows publish form
    â†’ keys-service calls POST /keys/publish
      â†’ api-logger records the call
      â†’ key-publish emits 'key-published' { code, fingerprint }
        â†’ pki-keys updates key card with "Published as DC-7X4F"
        â†’ key-registry refreshes
        â†’ key-log refreshes
```

**Verification:** All existing PKI functionality works â€” generate key, export, import contact, encrypt, decrypt, sign, verify. Events flow correctly through EventBus.

**Complexity:** High (refactoring 1821 lines into 3 components + service).

---

### Phase 3: Backend API + Key Discovery Components

**Goal:** Build the 5 API endpoints, the key service, and the 4 new UI components (publish, lookup, registry, log).

**Backend files:**

| File | Purpose |
|------|---------|
| `sgraph_ai_app_send/lambda__admin/schemas/Schema__Key__Publish__Request.py` | Type_Safe request |
| `sgraph_ai_app_send/lambda__admin/schemas/Schema__Key__Registry__Entry.py` | Type_Safe entry |
| `sgraph_ai_app_send/lambda__admin/service/Service__Keys.py` | Key lifecycle service |
| `sgraph_ai_app_send/lambda__admin/fast_api/routes/Routes__Keys.py` | API route handlers |
| `tests/unit/lambda__admin/service/test_Service__Keys.py` | Service tests |
| `tests/unit/lambda__admin/fast_api/routes/test_Routes__Keys.py` | Route tests |

**Frontend files:**

| File | Purpose |
|------|---------|
| `v0.1.3/components/key-publish/key-publish.js` | Publish flow (select key â†’ confirm â†’ get code) |
| `v0.1.3/components/key-lookup/key-lookup.js` | Lookup by code (enter code â†’ view key â†’ import) |
| `v0.1.3/components/key-registry/key-registry.js` | Browse all published keys |
| `v0.1.3/components/key-log/key-log.js` | Transparency log viewer + chain verification |

**Modifications:**

| File | Change |
|------|--------|
| `Send__Cache__Client.py` | Add `NS_KEYS`, key CRUD methods, log methods |
| `Fast_API__SGraph__App__Send__Admin.py` | Register `Routes__Keys`, instantiate `Service__Keys` |
| `v0.1.3/js/keys-service.js` | Add REST API calls for publish/lookup/unpublish/list/log |

**Test plan:**

```
test__publish_key                   â€” POST returns code, obj_id, fingerprint
test__publish_key__duplicate        â€” same PEM twice â†’ 409
test__publish_key__invalid_pem      â€” malformed PEM â†’ 400
test__publish_key__with_signing     â€” PEM + signing key â†’ both stored
test__lookup_key                    â€” GET by code â†’ full entry
test__lookup_key__case_insensitive  â€” DC-7X4F = dc-7x4f = Dc-7x4F
test__lookup_key__not_found         â€” unknown code â†’ 404
test__unpublish_key                 â€” DELETE â†’ status unpublished
test__unpublish_key__already_gone   â€” unpublish twice â†’ 404
test__list_keys                     â€” returns all active keys
test__list_keys__excludes_deleted   â€” unpublished keys not in list
test__log_entries                   â€” after publish+unpublish, log has 2 entries
test__log_integrity                 â€” each entry's previous_hash matches prior
test__log_head                      â€” head hash matches last entry
```

**Complexity:** Medium-high.

---

### Phase 4: Storage Browser + Backend Visibility

**Goal:** Build the storage browser component and API endpoints for admin debugging.

**Backend files:**

| File | Purpose |
|------|---------|
| `sgraph_ai_app_send/lambda__admin/fast_api/routes/Routes__Storage.py` | Storage browse/read endpoints |

**Frontend files:**

| File | Purpose |
|------|---------|
| `v0.1.3/components/storage-browser/storage-browser.js` | Memory-FS content browser |

**Features:**
- Tree view of all Memory-FS namespaces and files
- Click to view file contents (JSON formatted)
- Shows tokens, keys, transfers, log entries â€” everything stored on the server
- Search/filter by path or content
- Critical for development: "I can see what the backend actually stored"

**Complexity:** Medium.

---

### Phase 5: QR Codes + Polish

**Goal:** QR code generation for lookup codes, navigation polish, final acceptance testing.

**Files:**

| File | Purpose |
|------|---------|
| `v0.1.3/js/qr-code.js` | Minimal inline QR encoder (zero dependencies) |

**Modifications:** Add QR buttons to `key-publish` success view and `key-registry` entries.

**Complexity:** Low.

---

## 5. Component Pattern (template for all new components)

```javascript
(function() {
    'use strict';

    class ComponentName extends HTMLElement {
        static get appId()    { return 'component-name'; }
        static get navLabel() { return 'Component Name'; }
        static get navIcon()  { return 'ğŸ”‘'; }

        constructor() {
            super();
            this._boundHandlers = {};
        }

        connectedCallback() {
            this.render();
            this.setupEventListeners();
        }

        disconnectedCallback() {
            this.cleanup();
        }

        onActivate() {
            // Called when this component becomes visible
        }

        onDeactivate() {
            // Called when this component is hidden
        }

        render() {
            this.innerHTML = `
                <style>${this.getStyles()}</style>
                <div class="cn-container">
                    <!-- component HTML -->
                </div>
            `;
        }

        setupEventListeners() {
            this._boundHandlers.onRefresh = () => this.loadData();
            this.events.on('refresh', this._boundHandlers.onRefresh);
        }

        cleanup() {
            this.events.off('refresh', this._boundHandlers.onRefresh);
        }

        getStyles() {
            return `.cn-container { /* styles */ }`;
        }

        get events() { return window.sgraphAdmin.events; }
    }

    customElements.define('component-name', ComponentName);
})();
```

**Key rules:**
- **Light DOM** (no Shadow DOM) â€” enables surgical overrides and style cascading
- **IIFE pattern** â€” keeps internal state private
- **Bound handlers** â€” store in `_boundHandlers` so you can `off()` them
- **Always cleanup** â€” every `on()` must have a matching `off()` in `disconnectedCallback()`
- **CSS prefix** â€” use short prefix per component (e.g., `pk-` for pki-keys, `kl-` for key-lookup)

---

## 6. File Inventory (complete)

### v0.1.3 Admin UI (all paths relative to `sgraph_ai_app_send__ui__admin/v0/v0.1/v0.1.3/`)

| File | Phase | Purpose |
|------|-------|---------|
| `index.html` | 1 | Entry point |
| `css/admin.css` | 1 | Styles |
| `js/event-bus.js` | 1 | EventBus |
| `js/config-manager.js` | 1 | Settings |
| `js/messages-service.js` | 1 | Notifications |
| `js/admin-api.js` | 1 | API client |
| `js/pki-common.js` | 2 | Shared PKI utilities |
| `js/keys-service.js` | 2 | Key CRUD service |
| `js/qr-code.js` | 5 | QR encoder |
| `components/admin-shell/admin-shell.js` | 1 | Shell + Router |
| `components/events-viewer/events-viewer.js` | 1 | Debug: events |
| `components/api-logger/api-logger.js` | 1 | Debug: API |
| `components/messages-panel/messages-panel.js` | 1 | Debug: messages |
| `components/token-manager/token-manager.js` | 1 | Migrated |
| `components/system-info/system-info.js` | 1 | Migrated |
| `components/cache-browser/cache-browser.js` | 1 | Migrated |
| `components/metrics-dashboard/metrics-dashboard.js` | 1 | Migrated |
| `components/analytics-dashboard/analytics-dashboard.js` | 1 | Migrated |
| `components/pki-keys/pki-keys.js` | 2 | Key management |
| `components/pki-encrypt/pki-encrypt.js` | 2 | Encrypt/decrypt |
| `components/pki-contacts/pki-contacts.js` | 2 | Contacts |
| `components/key-publish/key-publish.js` | 3 | Publish flow |
| `components/key-lookup/key-lookup.js` | 3 | Lookup by code |
| `components/key-registry/key-registry.js` | 3 | Registry browser |
| `components/key-log/key-log.js` | 3 | Transparency log |
| `components/storage-browser/storage-browser.js` | 4 | Memory-FS browser |

### Backend (unchanged from original plan)

| File | Phase |
|------|-------|
| `lambda__admin/schemas/Schema__Key__Publish__Request.py` | 3 |
| `lambda__admin/schemas/Schema__Key__Registry__Entry.py` | 3 |
| `lambda__admin/service/Service__Keys.py` | 3 |
| `lambda__admin/fast_api/routes/Routes__Keys.py` | 3 |
| `lambda__admin/fast_api/routes/Routes__Storage.py` | 4 |
| `tests/unit/lambda__admin/service/test_Service__Keys.py` | 3 |
| `tests/unit/lambda__admin/fast_api/routes/test_Routes__Keys.py` | 3 |

---

## 7. Answers to Open Questions (from human)

| Question | Answer |
|----------|--------|
| Case-insensitive lookup codes? | **Yes.** Normalise to lowercase at API boundary. Display uppercase. |
| Registry accessible without admin auth? | **No.** Admin-only for now. |
| Challenge-response for publish? | **Not for now.** MVP stage, high trust. GRC tracks the transition risk. |
| Admin-shell navigation? | **Everything in admin shell.** No standalone pages. Refactor pki.html into shell components. |
| Versioned path for new pages? | **Yes, always.** New version v0.1.3. Never modify v0.1.2. |
| Access token case-sensitivity? | **Fixed.** `autocapitalize="off"` + `.toLowerCase()` applied to `send-access-gate.js` in v0.1.4. |

---

## 8. Cross-References

| Document | Location |
|----------|----------|
| Original dev brief | `team/humans/dinis_cruz/briefs/02/21/v0.4.27__dev-brief__key-discovery-and-public-registry.md` |
| IFD Issues-FS guide | `library/guides/development/ifd/ifd__issues-fs/` |
| AppSec: read now | `team/roles/appsec/reviews/26-02-21/v0.5.0__appsec__read-now.md` |
| AppSec: future findings | `team/roles/appsec/reviews/26-02-21/v0.5.0__appsec__future-findings-catalogue.md` |
| GRC risk: auth transition | `team/roles/appsec/reviews/26-02-21/v0.5.0__grc-risk__auth-model-transition.md` |
| Original impl plan | `team/roles/dev/reviews/26-02-21/v0.5.0__implementation-plan__key-discovery-and-registry.md` |
| PKI manager (source) | `sgraph_ai_app_send__ui__admin/v0/v0.1/v0.1.2/components/pki-manager/pki-manager.js` |
| Admin shell (current) | `sgraph_ai_app_send__ui__admin/v0/v0.1/v0.1.2/components/admin-shell/admin-shell.js` |

---

*End of revised implementation plan.*
