# v0.5.0 — AppSec: Future Findings Catalogue (Chain of Trust + Secure Pod)

**Version:** v0.5.0
**Date:** 2026-02-21
**Role:** AppSec
**Team:** Explorer
**Status:** DEFERRED — all findings in this document are future work, dependent on customer demand
**Context:** Extracted from [revised review](v0.5.0__review__pki-architecture-security-revised.md)

---

## Purpose

This document catalogues all security findings for features that are **not being built now**. They are preserved here so that when the features move to implementation, the AppSec review is already done and the team knows exactly what to address.

**Important context from the project owner:**
- Many of these issues only exist when endpoints are exposed to the User Lambda (non-admin, potentially unauthenticated paths)
- Some features require server capabilities that don't exist yet (e.g., server-issued challenges to clients for proof-of-possession)
- Implementation is triggered by customer demand, not scheduled

---

## Chain of Trust Findings (8)

| ID | Finding | Risk (when deployed) | Revisit When |
|----|---------|---------------------|--------------|
| CT-1 | **Equivocation attack on hash chain** — single server can show different chains to different clients | Critical | Hash chain implementation begins |
| CT-2 | **Group admin compromise propagates trust** — one compromised admin key poisons entire group | Critical | Trust groups are implemented |
| CT-3 | **Challenge-response replay/nonce management** — needs 128-bit, single-use, time-bounded, context-bound nonces | High | Server gains challenge-response capability |
| CT-4 | **OAuth/Cognito as trust anchor** — IdP compromise enables key takeover for any user | High | OAuth/Cognito integration begins |
| CT-5 | **4-layer key model complexity** — implement incrementally (Persona + API first) | Low | Layered identity is designed |
| CT-6 | **Trust graph cache staleness** — revoked users still trusted in cached graphs | Medium | Trust graph queries are implemented |
| CT-7 | **PKI-encrypted web delivery TOFU** — Service Worker must be delivered securely on first visit | High | Encrypted page delivery is prototyped |
| CT-8 | **Hash chain signing authority** — must strictly enforce which key types may sign which commit types | Medium | Hash chain signing is implemented |

### Key Dependencies

- **CT-3 (challenge-response):** Requires a new server capability — the ability to issue a cryptographic challenge and verify the signed response. This is needed for:
  - Proof-of-key-ownership on publish (when users beyond admins can publish)
  - Proof-of-key-ownership on delete (when users delete their own keys)
  - Layered authentication (device/session/persona/admin key verification)
  - This capability does not exist in the current server architecture

- **CT-1 (equivocation):** Requires either external witnesses, client gossip, or a third-party auditor. None of these exist yet. The transparency log (Phase 1) is the foundation.

- **CT-2 (group admin compromise):** Only relevant when trust groups exist. Mitigation (threshold signing, K-of-N) is itself a significant feature.

---

## Secure Pod Findings (5)

| ID | Finding | Risk (when deployed) | Revisit When |
|----|---------|---------------------|--------------|
| SP-1 | **Pod as single point of failure** — pod down = no access for anyone | High | Secure Pod architecture is designed |
| SP-2 | **Pod compromise blast radius** — pod MUST NOT cache blobs; each request must be fresh fetch | High | Secure Pod is prototyped |
| SP-3 | **Micro-payment budget as security control** — enforcement MUST be external to the pod | Medium | Budget system is designed |
| SP-4 | **Client-side pod trust model** — acceptable for personal use, not for enterprise data rooms | Medium | Pod implementation options are evaluated |
| SP-5 | **Pod unavailability** — strict mode (deny access) is the only secure default; NEVER implement fallback-to-direct-PKI | Medium | Pod availability strategy is designed |

### Key Architecture Notes

- **Two operation modes:** Mode 1 (Direct PKI, current) stays as-is. Mode 2 (Pod-Mediated) is the future capability.
- **SP-5 is a hard rule:** Fallback-to-direct-PKI during pod outage creates a trivial revocation bypass (DDoS the pod, access content during fallback). This must never be implemented.
- **SP-3 (micro-payment budget):** A genuinely novel security control concept. Budget enforcement must be external to the pod — a compromised pod cannot be trusted to enforce its own budget.

---

## Cross-Cutting Concerns (3)

| ID | Finding | Risk | Revisit When |
|----|---------|------|--------------|
| CC-1 | **Incremental complexity** — build and security-test each layer independently before composing | Low | Any new PKI layer is added |
| CC-2 | **Server metadata surface expansion** — trust graphs, access logs, etc. expand what the server sees (though never plaintext content) | Low | Trust graph or pod is deployed |
| CC-3 | **Auth model transition** — current high-trust model masks risks that become critical with wider access | GRC tracking item | [See GRC risk document](v0.5.0__grc-risk__auth-model-transition.md) |

---

## When to Reactivate This Document

| Trigger | Findings to Review |
|---------|-------------------|
| Customer requests data room with revocable access | SP-1 through SP-5 |
| Trust groups / company membership is designed | CT-1, CT-2, CT-6 |
| Server challenge-response capability is built | CT-3, CT-4 |
| OAuth/Cognito integration begins | CT-4 |
| Key discovery endpoints exposed on User Lambda | KD-1, KD-2, KD-3, KD-5 (from NOW document, re-escalated) |
| PKI-encrypted web delivery prototyped | CT-7 |
| Layered identity designed | CT-5, CT-8 |

---

## Cross-References

| Document | Location |
|----------|----------|
| What to read NOW | [`v0.5.0__appsec__read-now.md`](v0.5.0__appsec__read-now.md) |
| Full revised review | [`v0.5.0__review__pki-architecture-security-revised.md`](v0.5.0__review__pki-architecture-security-revised.md) |
| GRC risk tracking | [`v0.5.0__grc-risk__auth-model-transition.md`](v0.5.0__grc-risk__auth-model-transition.md) |
| Original review | [`v0.5.0__review__pki-architecture-security.md`](v0.5.0__review__pki-architecture-security.md) |
| Chain of Trust brief | `team/humans/dinis_cruz/briefs/02/21/v0.4.27__architecture__chain-of-trust-and-key-graphs.md` |
| Secure Pod brief | `team/humans/dinis_cruz/briefs/02/21/v0.4.27__architecture__secure-pod-multi-user-encryption.md` |
