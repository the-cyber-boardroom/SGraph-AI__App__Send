# AppSec Review: Part-3 Briefs — Security Assessment

**version** v0.5.13
**date** 21 Feb 2026
**role** AppSec
**type** Review — security assessment of v0.5.10 briefs

---

## Briefs Assigned to AppSec

| Brief | Priority | Key Security Concern |
|-------|----------|---------------------|
| `architecture__browser-pod` | High | SW threat model, API key protection, budget enforcement bypass |
| `architecture__identity-spectrum-and-friendly-search` | Medium | Name squatting, impersonation, rainbow table on hashed names |
| `dev-brief__fastapi-ec2-management-routes` | High | Admin compromise blast radius, SSH exec from API, runaway cost |
| `brief__ssh-key-utility-and-marketing-campaign` | Low | Anonymous access risk, key generation quality, code integrity |

---

## Security Findings

### Browser Pod — Critical Research Needed

The brief explicitly lists 6 research questions for AppSec. These must be answered before implementation:

| # | Question | Risk if Unanswered |
|---|----------|-------------------|
| 1 | Can compromised page read SW in-memory variables? | Secret exposure between fetch and inject |
| 2 | Can browser extension intercept SW outbound fetch? | API key visible to extension |
| 3 | Can page read response headers after SW strips them? | Credential leakage via caching/timing |
| 4 | Can `getRegistrations()` be spoofed? | Detection mechanism defeated |
| 5 | Does crypto.subtle work in SW across all browsers? | Pod unusable on some browsers |
| 6 | What happens on browser data clear? | UX impact, acceptable by design |

**Threat model assessment**: The pod's "acceptable residual risk" stance is reasonable — XSS can use the LLM within budget, but can't exfiltrate the API key. Browser extensions are explicitly out of scope (documented). The "nuke and recreate" model for updates is clean.

### FastAPI EC2 Routes — Highest Attack Surface

This is the **highest-risk addition** in the entire brief set. EC2 management via API means:
- A compromised admin key can create instances (cost), exec SSH commands (access), and terminate instances (availability)
- The SSH exec route (`POST /instances/{id}/exec`) is essentially remote code execution behind an API key

**Required before implementation:**
1. Threat model: hostile admin / compromised admin key scenario
2. Rate limiting on instance creation
3. Budget controls must be enforced at the API layer (not optional)
4. Audit trail must be immutable (hash-chained)
5. SSH exec should be in a separate Lambda (isolation from main API)
6. Consider allowlist for permitted SSH commands

**Positive security properties:**
- EC2 instances have zero egress — even SSH access can't exfiltrate to the internet
- All content is encrypted with user keys — admin can't read data room content
- Budget controls cap financial damage

### Identity Spectrum

**Phase 1 (data rooms, client-side search)**: low risk. Admin controls the directory.

**Phase 2 (public registry)**: significant risk. Name squatting, impersonation, and social engineering via fake identities. Requires:
- Minimum email verification for public identities
- Prominent display of verification level
- Rate limiting on identity creation

### SSH Key Utility

Low risk. Static page, no server interaction. Main concerns:
- **Code integrity**: if the served page is compromised, it could generate weak keys or exfiltrate them. SRI hashes recommended.
- **Key generation quality**: verify Web Crypto API entropy source matches OpenSSH quality. Document any differences.
- **Liability**: anonymous users generating keys — assess "we helped generate keys used for X" reputational risk.

---

## Priority Ranking (Security Risk)

| Priority | Brief | Reason |
|----------|-------|--------|
| P1 | FastAPI EC2 Routes | Remote code execution via API. Highest blast radius. |
| P2 | Browser Pod | New trust boundary (SW). Research questions must be answered. |
| P3 | Identity Spectrum | Phase 2 impersonation risk. Phase 1 is low risk. |
| P4 | SSH Key Utility | Low risk. Standard static page security. |
