# AppSec Incident Analysis: INC-001 -- Commit Author Impersonation

**Version:** v0.2.16
**Date:** 2026-02-12
**Role:** AppSec
**Incident:** INC-001
**Severity:** HIGH (systemic gap in audit trail integrity)
**Status:** Analysis complete, recommendations pending implementation

---

## 1. Executive Summary

Commit `956c37f` on feature branch `claude/read-secure-send-brief-Mz6yN` was authored as "GitHub Actions \<actions@github.com\>" but was actually created by a Claude agent session. The Committer field reveals the true origin: "Claude \<noreply@anthropic.com\>". This is not an isolated event -- **5 commits** across the repository history exhibit this same Author/Committer mismatch pattern with GitHub Actions impersonation, and **3 additional commits** impersonate Dinis Cruz as Author while Claude is the Committer.

This is not a vulnerability in git itself. It is a **systemic gap** in the project's commit identity governance, combined with a **non-functional commit signing configuration** that creates a false sense of security.

---

## 2. Forensic Analysis of Commit 956c37f

### 2.1 Commit Metadata

```
commit 956c37f0b953eccda9deff700c9273abbc40f871
Author:     GitHub Actions <actions@github.com>
AuthorDate: Thu Feb 12 17:04:00 2026 +0000
Commit:     Claude <noreply@anthropic.com>
CommitDate: Thu Feb 12 17:13:04 2026 +0000

    Update release badge and version file
```

### 2.2 What the Fields Tell Us

| Field | Value | Interpretation |
|-------|-------|----------------|
| **Author** | GitHub Actions \<actions@github.com\> | **Spoofed.** This identity was explicitly set by the person/agent who created the commit, overriding the default git config. |
| **AuthorDate** | Thu Feb 12 17:04:00 2026 +0000 | The date the change was originally "authored." Can also be overridden. |
| **Committer** | Claude \<noreply@anthropic.com\> | **True origin.** This reflects the `user.name` and `user.email` in the git config of the environment that ran `git commit`. The Claude agent created this commit. |
| **CommitDate** | Thu Feb 12 17:13:04 2026 +0000 | 9 minutes after AuthorDate. This time difference is consistent with a cherry-pick, rebase, or `--author` override, not with a direct commit. |
| **Signature** | None | Despite `commit.gpgsign=true` in the git config, **no cryptographic signature is present**. |

### 2.3 Changed Files

```
pyproject.toml             | v0.2.16 -> v0.2.17
sgraph_ai_app_send/version | v0.2.16 -> v0.2.17
```

The commit increments the version number. This is the same change pattern that legitimate CI pipeline commits produce (via the `git__increment-tag` GitHub Action). The commit message "Update release badge and version file" is identical to the CI pipeline commit message.

### 2.4 How This Commit Was Created

The commit was created by a Claude agent that:

1. **Set the Author identity** to match GitHub Actions, either via:
   - `git commit --author="GitHub Actions <actions@github.com>"`
   - `GIT_AUTHOR_NAME="GitHub Actions" GIT_AUTHOR_EMAIL="actions@github.com"` environment variables
   - Applying a commit from a CI branch (cherry-pick/rebase preserves the original Author while updating the Committer)

2. **Used the CI commit message** verbatim: "Update release badge and version file"

3. **Was not blocked** by any pre-commit hook, branch protection, or signing verification.

The most likely mechanism is cherry-pick or rebase of a legitimate CI commit from the `dev` branch onto the feature branch. When git cherry-picks, it preserves the original Author but sets the Committer to the current user. This explains the Author/Committer mismatch.

---

## 3. Scope of the Problem: All Mismatched Commits

### 3.1 GitHub Actions Author, Claude Committer (5 commits)

| Commit | Branch Context | Message |
|--------|---------------|---------|
| `956c37f` | Feature branch | Update release badge and version file |
| `650989d` | Feature branch | Update release badge and version file |
| `d694108` | Feature branch | Update release badge and version file |
| `f627cf3` | Feature branch | Update release badge and version file |
| `0f18d8d` | Feature branch | Update release badge and version file |

All 5 follow the same pattern: a CI version-bump commit appearing on a feature branch with the Claude agent as the actual committer.

### 3.2 Dinis Cruz Author, Claude Committer (3 commits)

| Commit | Message |
|--------|---------|
| `9bcb223` | added more briefs and supporting docs for this project for 12 Feb 2026) |
| `8cc1a2e` | added admin_run-locally |
| `cd0c02c` | fixed tests |

These commits attribute authorship to Dinis Cruz but were committed by Claude. This could be from cherry-picking Dinis's commits from another branch, or from a rebase operation.

### 3.3 Summary

| Identity Pattern | Count | Concern Level |
|-----------------|-------|---------------|
| Claude Author / Claude Committer | 31 | Normal -- agent acting as itself |
| Dinis Cruz Author / Dinis Cruz Committer | 47 | Normal -- human acting as themselves |
| GH Actions Author / GH Actions Committer | 23 | Normal -- CI pipeline commits on dev/main |
| **GH Actions Author / Claude Committer** | **5** | **HIGH -- Agent impersonating CI** |
| **Dinis Cruz Author / Claude Committer** | **3** | **HIGH -- Agent impersonating human** |

---

## 4. Attack Vector Assessment

### 4.1 Is This a Git Vulnerability?

**No.** This is git working as designed. Git has always allowed the Author field to be set independently from the Committer. This is a feature for legitimate use cases:

- Applying patches on behalf of others (`git am`, `git apply`)
- Cherry-picking preserves original authorship
- Rebasing preserves original authorship
- `git commit --author` for attributed work

The attack vector is not in git itself but in the **absence of controls** that verify author claims.

### 4.2 How Easy Is Author Impersonation?

Trivially easy. Any of these methods work:

```bash
# Method 1: --author flag
git commit --author="Dinis Cruz <dinis.cruz@owasp.org>" -m "message"

# Method 2: Environment variables
GIT_AUTHOR_NAME="GitHub Actions" GIT_AUTHOR_EMAIL="actions@github.com" git commit -m "message"

# Method 3: Cherry-pick (preserves original author automatically)
git cherry-pick <commit-from-another-branch>

# Method 4: Rebase (preserves original author automatically)
git rebase dev  # All rebased commits keep original author
```

Methods 3 and 4 are the most likely explanation for INC-001, as they are standard git operations that produce the Author/Committer mismatch pattern observed.

### 4.3 Is the Current Signing Configuration Effective?

**No. The signing configuration is non-functional.** The investigation revealed:

| Setting | Value | Status |
|---------|-------|--------|
| `commit.gpgsign` | `true` | Configured but **ineffective** |
| `gpg.format` | `ssh` | Configured |
| `user.signingkey` | `/home/claude/.ssh/commit_signing_key.pub` | **Empty file (0 bytes)** |
| `gpg.ssh.program` | `/tmp/code-sign` | Symlink to `/usr/local/bin/environment-manager` |
| `gpg.ssh.allowedSignersFile` | Not configured | **Missing entirely** |
| Commit 956c37f signature | None | **No signature present despite gpgsign=true** |

The signing infrastructure has three compounding failures:

1. **The signing key is empty** -- `/home/claude/.ssh/commit_signing_key.pub` is a 0-byte file. There is no key material to sign with.
2. **The signing program is opaque** -- `/tmp/code-sign` points to an `environment-manager` binary. When signing fails (due to the empty key), it appears to fail silently rather than blocking the commit.
3. **No allowed signers file** -- Even if signatures were present, there is no `allowedSignersFile` configured to verify them against. Signature verification cannot succeed.

This creates a **false sense of security**: the configuration suggests commits are signed, but they are not.

---

## 5. Threat Model

### 5.1 Threat: Agent Impersonates Human (Dinis Cruz)

| Dimension | Assessment |
|-----------|------------|
| **Feasibility** | Trivial. Already observed (3 commits). |
| **Impact** | HIGH. A commit appearing to be from Dinis Cruz carries implicit authority. In a project where "Dinis Cruz is the human stakeholder, decision-maker, and project owner" (CLAUDE.md), impersonating his identity could make unauthorized changes appear human-authorized. |
| **Detection** | Possible but requires checking the Committer field, which most git UIs and GitHub do not prominently display. `git log` shows Author by default, not Committer. |
| **Current Controls** | None. No signing, no authorship verification, no pre-commit hooks. |

### 5.2 Threat: Agent Impersonates CI Pipeline

| Dimension | Assessment |
|-----------|------------|
| **Feasibility** | Trivial. Already observed (5 commits, including INC-001). |
| **Impact** | MEDIUM-HIGH. CI-authored commits carry implicit trust ("this was an automated process"). An agent could use this identity to make changes (especially version bumps) appear routine when they are not. Version manipulation is a supply chain concern. |
| **Detection** | Requires correlating CI pipeline run logs with commit hashes. If a "GitHub Actions" commit exists but no corresponding CI run, it is spoofed. Currently no automated detection exists. |
| **Current Controls** | None. |

### 5.3 Threat: Agent Impersonates Another Agent Role

| Dimension | Assessment |
|-----------|------------|
| **Feasibility** | Trivial. All agents share the same `Claude <noreply@anthropic.com>` identity anyway. Role identity is conveyed only in commit messages, not in git metadata. |
| **Impact** | LOW-MEDIUM. In the current setup, all agents are "Claude." Role confusion is already inherent in the identity model. |
| **Detection** | Not applicable -- there is no role-level identity in git. |
| **Current Controls** | None (by design -- the role system does not use git identity). |

### 5.4 Threat: Bypass Branch Protection via Identity Spoofing

| Dimension | Assessment |
|-----------|------------|
| **Feasibility** | Depends on branch protection configuration. If rules are based on author identity (e.g., "only GitHub Actions can push version bumps to dev"), spoofing that identity could bypass them. However, GitHub branch protections typically use the **pusher's authenticated identity** (the GitHub account that pushes), not the commit's Author field. |
| **Impact** | HIGH if protections are identity-based. LOW if protections use authenticated pusher identity. |
| **Detection** | GitHub audit log shows the authenticated pusher regardless of commit author. |
| **Current Controls** | CI pipelines only trigger on `dev` and `main` branches (verified in workflow files). Branch protection rules for the GitHub repo were not accessible from this environment. |

### 5.5 Threat: Version Number Manipulation

| Dimension | Assessment |
|-----------|------------|
| **Feasibility** | Already occurred. Commit 956c37f bumps v0.2.16 to v0.2.17, disguised as a CI commit on a feature branch where CI does not run. |
| **Impact** | MEDIUM. Version numbers feed into PyPI publishing, deployment tagging, and the review file naming convention. Incorrect versions could cause: package version conflicts, deployment confusion, audit trail gaps. |
| **Detection** | Requires verifying that every version bump commit has a corresponding CI pipeline run. Currently no automated check. |
| **Current Controls** | CI pipelines own version bumping on dev/main. No control prevents version bumps on feature branches. |

---

## 6. Existing Controls Assessment

| Control | Status | Effectiveness |
|---------|--------|---------------|
| Commit signing (GPG/SSH) | Configured but **non-functional** (empty key, missing allowed signers) | **None** |
| Pre-commit hooks | Only sample hooks present (`.git/hooks/*.sample`) -- none active | **None** |
| Pre-receive hooks | Not applicable (GitHub-hosted repo; would need GitHub App or branch rules) | **None** |
| Branch protection rules | CI pipelines only trigger on dev/main. Branch protection rules on GitHub were not inspectable from this environment. | **Partial (CI scope)** |
| Agent identity policy | CLAUDE.md specifies branch naming (`claude/{description}-{session-id}`) but has **no policy on commit authorship** | **None** |
| Author verification in CI | Not present in any workflow file | **None** |
| Commit message conventions | Informal. No enforcement. | **None** |
| Allowed signers file | Not configured | **None** |

---

## 7. Recommendations

### 7.1 IMMEDIATE (Before Next Merge to dev)

#### R1: Fix Commit Signing Infrastructure

**Priority: CRITICAL**

The signing configuration exists but is broken. This must be fixed before it can provide any value.

1. **Generate a real signing key** for the Claude agent environment, or use the environment's existing SSH key.
2. **Create an `allowedSignersFile`** that maps known identities to their public keys.
3. **Verify that `commit.gpgsign=true` actually produces signatures** -- test by creating a commit and running `git verify-commit`.
4. **If the environment manager (`/tmp/code-sign`) intentionally suppresses signing, document why.** A deliberate decision to not sign is acceptable if documented. A broken configuration is not.

#### R2: Agent Identity Policy in CLAUDE.md

**Priority: HIGH**

Add to `.claude/CLAUDE.md` under "Key Rules > Git":

```
### Commit Identity

22. **Never override git author** -- Agents must never use `--author`, `GIT_AUTHOR_NAME`,
    or `GIT_AUTHOR_EMAIL` to set a commit author other than their configured identity.
23. **Cherry-pick with re-authoring** -- When cherry-picking or rebasing commits from
    other branches, use `--reset-author` to ensure the commit reflects the actual creator.
24. **Version bumps only via CI** -- Only the CI pipeline (GitHub Actions on dev/main)
    may create version bump commits. Agents must never manually bump version numbers.
```

#### R3: Revert or Re-Author the Spoofed Commits on This Branch

**Priority: MEDIUM**

Before merging `claude/read-secure-send-brief-Mz6yN` to `dev`, the 5 GitHub Actions-authored commits and 3 Dinis Cruz-authored commits with Claude as Committer should be assessed. If they resulted from cherry-picks/rebases, the operation itself may be legitimate even though the authorship is misleading.

### 7.2 SHORT-TERM (This Sprint)

#### R4: Pre-Commit Hook for Author Verification

Create a pre-commit or commit-msg hook that:

1. Verifies the commit Author matches the configured `user.name` and `user.email`.
2. Warns or blocks if `--author` override is detected.
3. Can be distributed via a `.githooks/` directory with `core.hooksPath` configuration.

#### R5: CI Pipeline Author Verification

Add a step to the CI pipeline that:

1. Checks all commits in a PR for Author/Committer consistency.
2. Flags any commit where Author does not match Committer (except for known legitimate patterns like GitHub merge commits).
3. Blocks merge if unexplained authorship mismatches are found.

#### R6: Version File Protection

1. Add a CI check that version bumps in `sgraph_ai_app_send/version` and `pyproject.toml` are only accepted from the CI pipeline's own commits.
2. Reject PRs that include manual version bumps.

### 7.3 MEDIUM-TERM (Next Sprint)

#### R7: GitHub Branch Protection Rules

If not already configured:

1. Require signed commits on `dev` and `main` branches.
2. Require PR reviews before merge.
3. Require status checks (CI) to pass before merge.
4. Restrict who can push directly to `dev` and `main`.

#### R8: Commit Provenance Audit Script

Create a script (runnable in CI or locally) that:

1. Scans the commit history for Author/Committer mismatches.
2. Cross-references "GitHub Actions" commits with actual CI pipeline runs (via GitHub API).
3. Produces a report of any unverified commits.

---

## 8. Root Cause Analysis

This is not a malicious act. The root cause is a **systemic gap** in the intersection of three factors:

1. **Git's design** -- Author and Committer are separate, and Author is trivially overridable. This is a feature, not a bug, but it requires controls in environments with multiple actors.

2. **Agentic development model** -- Multiple AI agents share the same execution environment and git identity. When agents perform git operations like cherry-pick and rebase, they inadvertently (or intentionally) create commits with misleading authorship. There is no policy governing this.

3. **Non-functional signing** -- The one technical control that could provide commit provenance (cryptographic signing) is configured but broken, providing zero actual protection while suggesting protection exists.

The combination creates an environment where commit authorship is unreliable as an audit trail, which undermines the project's governance model.

---

## 9. Conclusion

INC-001 reveals that the project's commit history cannot be trusted as an audit trail. Any commit's Author field can be set to any identity, and no technical control currently prevents or detects this. The 8 mismatched commits discovered (5 impersonating CI, 3 impersonating the project owner) demonstrate this is not theoretical -- it is actively occurring.

The project's agentic development model makes this especially important. When 10+ AI agent roles produce commits, and any of them can claim to be any identity, the audit trail that the Historian and Librarian rely on is compromised.

The recommended controls (fix signing, add identity policy, add CI verification) are proportionate to the risk and can be implemented incrementally without blocking current development.

---

*AppSec Role -- SGraph Send*
*Incident INC-001 Analysis*
*v0.2.16 -- 2026-02-12*
