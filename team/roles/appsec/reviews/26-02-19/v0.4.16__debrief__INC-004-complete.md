# v0.4.16 -- AppSec Debrief: INC-004 Documentation Token Leak — Complete

**Version:** v0.4.16
**Date:** 19 February 2026
**Role:** AppSec
**Team:** Explorer
**Incident:** INC-004
**Status:** CLOSED

---

## 1. Executive Summary

INC-004 was a data breach caused by the documentation pipeline. AI agents writing the INC-003 incident report included real credentials (access token, transfer ID, decryption key) as examples. The decryption key + transfer ID combination created a full data access path to a real user file.

The breach was contained in 28 minutes. The encrypted file was permanently deleted from S3. The affected user classified the data as Level 1 — Public. No evidence of unauthorised access. No ICO notification required.

This debrief covers the technical root cause, the security response, what the architecture got right, what the process got wrong, and what needs to change.

---

## 2. Technical Root Cause Analysis

### The Vulnerability Chain

```
Agent writes documentation
  → Uses real token value as example (no redaction convention)
    → Uses real transfer ID as example
      → Uses real decryption key as example
        → All three committed to git
          → Pushed to GitHub branch
            → Transfer ID + decryption key = full data access path
              → Anyone with branch access can download + decrypt the file
```

### Why This Happened

| Factor | Detail |
|--------|--------|
| **No redaction convention** | No rule existed telling agents to use `[REDACTED]` instead of real values |
| **No credential scanning** | No pre-commit hook to detect tokens, keys, or IDs in committed files |
| **Thoroughness bias** | Agents prioritised accurate, complete documentation — which meant using real values |
| **Context confusion** | Agents treated credentials as "examples" in documentation context, not recognising them as live secrets |
| **Three parallel paths** | Historian, Journalist, and Librarian independently included the same values — no single point of failure, but also no single point of detection |

### Root Cause Classification

**Category:** Operational process bypass of technical security architecture

The zero-knowledge architecture ensures the server never sees plaintext. But the documentation pipeline is not part of the zero-knowledge architecture — it's a human/agent workflow that operates outside the encryption boundary. The agents documented the exact values needed to bypass zero-knowledge (transfer ID + decryption key), effectively creating a plaintext data access path in markdown.

---

## 3. What the Architecture Got Right

### The Zero-Knowledge Advantage

The zero-knowledge model provided three critical protections during this incident:

| Protection | How It Helped |
|-----------|---------------|
| **S3 deletion = permanent remedy** | In a traditional system, deleting the server copy doesn't help if data was copied in transit. In zero-knowledge, deleting the ciphertext makes the key useless — there's nothing left to decrypt. |
| **Token ≠ data access** | The leaked token (`linkedin-user`) grants platform access (upload, metadata) but NOT data access. Even without rotation, no file content is at risk. |
| **Download count as detection** | The download count of 1 (believed to be the user's own) provides evidence that no unauthorised party accessed the file during the exposure window. |

### Security Model Validation

| Claim | Tested By INC-004 | Result |
|-------|-------------------|--------|
| Server never sees plaintext | Agents documented the decryption key, proving they had access to it — but the server did not | **Validated** — the key was in documentation, not on the server |
| Decryption key never leaves sender | The key WAS leaked — but through a documentation pipeline, not through the encryption system | **Architecture validated** — the leak was operational, not cryptographic |
| S3 stores only ciphertext | Deleting S3 objects made the leaked key useless | **Validated** — ciphertext deletion is an effective remedy |

---

## 4. Security Response Assessment

### Response Timeline Quality

| Phase | Time | Assessment |
|-------|------|-----------|
| Discovery (~16:00) | 10 min after push | **Fast** — human review caught what automated tools didn't |
| Token redaction (~16:04) | 4 min | **Fast** — straightforward find-and-replace |
| Key/ID redaction (~16:12) | 8 min | **Adequate** — required human to identify the second exposure vector |
| Escalation (~16:15) | 3 min | **Fast** — correct decision to escalate from P4 to P2 |
| S3 deletion (~16:20-16:28) | 8 min | **Fast** — permanent, irreversible containment |
| Breach notification (~16:30-16:40) | 10 min | **Fast** — process created from scratch |

### What AppSec Produced During the Incident

| Deliverable | Purpose |
|-------------|---------|
| Data breach notification process | Reusable process for future breaches |
| User breach notification (INC-004) | Formal notification to affected user |
| ICO reporting assessment | Regulatory decision framework |
| Voice interview brief | Voice-mode questionnaire for content sensitivity |

All four deliverables were created during the incident response, not after. This demonstrates the team's ability to build process while responding — but also highlights that these processes should have existed before the incident.

---

## 5. Vulnerability Assessment: Git History

### Current Exposure

The following values remain in git commit history on the feature branch:

| Value | In Git History | Current Risk |
|-------|:-------------:|-------------|
| `linkedin-user` access token | Yes | **Low** — deliberately left active (20 uses, D080) |
| Transfer ID `16bff884b7da` | Yes | **None** — S3 object deleted, transfer returns 404 |
| Decryption key for `16bff884b7da` | Yes | **None** — nothing to decrypt (ciphertext deleted) |

### Remediation Options

| Option | Pros | Cons | Recommendation |
|--------|------|------|----------------|
| **Do nothing** (current) | Simple; token serves as honeypot | Values persist indefinitely | Acceptable for now (D080) |
| **Rotate token** | Eliminates platform access risk | Loses honeypot experiment | After experiment concludes |
| **Rewrite git history** | Removes all values completely | Destructive; affects all collaborators; complex | Not recommended unless values become higher risk |
| **BFG Repo-Cleaner** | Targeted removal from history | Still destructive; requires force-push | Reserve for genuine emergency |

**AppSec recommendation:** Rotate the token after the honeypot experiment concludes (when usage reaches 50/50 or after a defined observation period). Do not rewrite git history — the S3 deletion already neutralised the data access path.

---

## 6. Security Controls: Before and After

| Control | Before INC-004 | After INC-004 |
|---------|:--------------:|:-------------:|
| `[REDACTED]` convention for documentation | Did not exist | **Established** (D074) |
| Pre-commit credential scanning | Did not exist | **Planned** (D076, not yet implemented) |
| Data breach notification process | Did not exist | **Documented and tested** |
| ICO assessment framework | Did not exist | **Documented and tested** |
| Transfer IDs classified as secrets | Not recognised | **Classified** (D077) |
| S3 deletion as breach remedy | Not documented | **Documented** (D079) |
| Voice interview for regulatory questionnaires | Did not exist | **Validated** (2 uses) |
| Risk acceptance framework | Informal | **Formalised** (D080-D082) |

---

## 7. Recommendations

### Immediate (P2)

| # | Recommendation | Owner |
|---|---------------|-------|
| 1 | **Implement pre-commit hook** scanning for token patterns, transfer IDs (12-char hex), and base64 key patterns | Dev/DevOps |
| 2 | **Add `[REDACTED]` convention to agent system prompts** — agents must never write real credentials in documentation, even as examples | Conductor |
| 3 | **Self-review step** before documentation commits — agent reviews its own output for credential patterns before committing | Dev |

### Short-term (P3)

| # | Recommendation | Owner |
|---|---------------|-------|
| 4 | **Git history audit** — scan all branches for credential patterns using trufflehog or similar | DevOps |
| 5 | **Token rotation schedule** — define when the `linkedin-user` token experiment ends and rotation occurs | Human |
| 6 | **Documentation pipeline security review** — treat the documentation workflow as a security boundary, not just the code | AppSec |

### Long-term (P4)

| # | Recommendation | Owner |
|---|---------------|-------|
| 7 | **Automated credential scanning in CI** — GitHub Actions step that fails the build if credentials are detected in any committed file | DevOps |
| 8 | **Agent security training data** — examples of what NOT to include in documentation, tested as part of the agent's operational context | Conductor |

---

## 8. INC-003 / INC-004 Relationship

These two incidents share a root cause and should be understood together:

| Dimension | INC-003 | INC-004 |
|-----------|---------|---------|
| **Root cause** | Code defect — token in URL construction | Documentation practice — real values as examples |
| **Shared root cause** | **Credential treated as non-sensitive in context** |
| **Created by** | Agent (Dev) | Agent (Historian, Journalist, Librarian) |
| **Discovered by** | Human | Human |
| **Data at risk** | Platform access (token) | File content (transfer ID + decryption key) |
| **Severity** | P4-as-P1 | P2-as-P1 |
| **Fix complexity** | Code change (8 files) | Process change (convention + tooling) |

**The pattern:** In both cases, a credential was treated as non-sensitive because of the context it appeared in. In INC-003, the token was "just a URL parameter." In INC-004, the values were "just examples in documentation." The lesson is the same: **a secret's sensitivity is intrinsic to its value, not to its context.**

---

## 9. Incident Closure

| Field | Value |
|-------|-------|
| **Incident** | INC-004 |
| **Classification** | P2-as-P1 (data breach) |
| **Opened** | 19 February 2026, ~15:50 |
| **Closed** | 19 February 2026, ~17:15 |
| **Duration** | ~85 minutes |
| **ICO notification** | Not required (Level 1 — Public) |
| **User data compromised** | None |
| **Documents produced** | 15+ across 10 roles |
| **Decisions** | 9 (D074-D082) |
| **Patterns** | 3 (P20-P22) |
| **New capabilities** | 8+ (see Section 6) |
| **Residual risk** | Low — token monitored, S3 deleted, convention established |

**INC-004 is CLOSED.**

---

*AppSec debrief for INC-004. Data breach contained in 28 minutes. Zero user data compromised. Architecture validated — zero-knowledge model held. Process failed — documentation pipeline lacked security controls. 8 recommendations across 3 priority tiers. 8 new security controls established. Incident closed.*
