# v0.4.12 -- Data Breach Notification Process

**Version:** v0.4.12
**Date:** 19 February 2026
**Role:** AppSec
**Type:** Process definition
**Status:** ACTIVE — triggered by INC-004
**Related:** [INC-004 incident record](../../historian/reviews/26-02-19/v0.4.12__incident-record__INC-004__documentation-token-leak.md)

---

## 1. Purpose

This process defines how SGraph Send handles data breaches — incidents where user data is exposed to unauthorised parties. It covers detection, containment, assessment, user notification, and regulatory reporting.

This process was created in response to INC-004 (19 February 2026), the project's first data breach. The zero-knowledge architecture was designed to make data breaches impossible at the technical layer, but INC-004 demonstrated that operational processes (documentation) can bypass the technical architecture.

---

## 2. When This Process Is Triggered

A data breach occurs when **any combination of values that allows access to user data** is exposed outside the intended access path. For SGraph Send, this specifically means:

| Leaked Combination | Breach? | Reason |
|-------------------|---------|--------|
| Transfer ID alone | No | Cannot decrypt without key |
| Decryption key alone | No | Cannot locate the transfer |
| Transfer ID + decryption key | **YES** | Full access to user data |
| Access token alone | No (credential leak) | Grants platform access, not data access |
| Access token + transfer ID + key | **YES** | Data access + impersonation |

**Key principle:** The zero-knowledge model means that a breach requires BOTH the transfer ID (locator) AND the decryption key (secret). Either alone is insufficient.

---

## 3. Breach Response Steps

### Step 1: Immediate Containment (Target: <15 minutes)

| Action | Owner | Details |
|--------|-------|---------|
| **Delete the S3 object** | Data controller or DevOps | Remove the ciphertext from storage. This is the single most effective remediation — without the ciphertext, the decryption key is useless. |
| **Redact leaked values** | Whoever discovers the leak | Replace all instances of transfer IDs, decryption keys, and tokens with `[REDACTED]` or placeholder values. |
| **Confirm download count** | Data controller or DevOps | Check how many times the file was downloaded during the exposure window. This informs the impact assessment. |

### Step 2: Impact Assessment (Target: <1 hour)

| Question | How to Answer | Why It Matters |
|----------|---------------|----------------|
| What data was in the transfer? | Ask the affected user | Determines severity and regulatory obligations |
| How sensitive is the data? | User assessment (see classification below) | Determines ICO reporting threshold |
| Who had access during the exposure window? | Review access logs, repository permissions | Determines blast radius |
| Was the data actually accessed? | Check download count, access logs | Distinguishes potential from confirmed breach |
| Is the data still accessible anywhere? | Check git history, caches, CDN, backups | Determines if further containment is needed |

### Step 3: Data Sensitivity Classification

The affected user must classify the exposed data. This classification drives the regulatory assessment:

| Level | Description | Examples | ICO Reporting? |
|-------|-------------|----------|----------------|
| **Level 1: Public** | Data the user has already published or would not mind being public | Marketing materials, published articles | No |
| **Level 2: Internal** | Business data not intended for public consumption but not highly sensitive | Internal surveys with non-personal answers, project notes | Unlikely unless volume is significant |
| **Level 3: Confidential** | Personal data, business-sensitive data, data about identifiable individuals | Filled surveys with personal opinions, customer data, financial info | Likely — 72-hour ICO assessment required |
| **Level 4: Restricted** | Special category data (health, biometric, political, religious, sexual orientation, criminal records) | Medical records, political views, trade union membership | **Mandatory** — 72-hour ICO notification |

### Step 4: User Notification (Target: <24 hours)

**Every affected user must be notified regardless of data sensitivity level.** The notification must include:

1. **What happened** — plain-language description of the breach
2. **What data was exposed** — specific to the user's transfer
3. **Exposure window** — when the data was accessible
4. **Actions already taken** — containment steps completed
5. **Remaining risks** — what exposure may persist (git history, caches)
6. **What the user should do** — any actions needed on their part
7. **Contact point** — how to reach the data controller with questions

See the user notification template: [`v0.4.12__user-breach-notification__INC-004.md`](v0.4.12__user-breach-notification__INC-004.md)

### Step 5: Regulatory Assessment (Target: <24 hours, report within 72 hours if required)

Under UK GDPR Article 33, the data controller must notify the ICO within 72 hours of becoming aware of a personal data breach, **unless** the breach is unlikely to result in a risk to the rights and freedoms of individuals.

The assessment must consider:
- Nature of the personal data breached
- Number of individuals affected
- Likely consequences of the breach
- Measures taken to mitigate the breach

See the ICO assessment template: [`v0.4.12__ico-reporting-assessment__INC-004.md`](v0.4.12__ico-reporting-assessment__INC-004.md)

### Step 6: Information Gathering from Affected User

To complete the regulatory assessment, the data controller must gather the following from each affected user:

**Questions for the affected user:**

1. **What was the content of the file?** (General description — do not request the user re-share the actual data)
2. **Did the file contain personal data?** (Names, email addresses, opinions attributable to individuals, etc.)
3. **Did the file contain special category data?** (Health, political, religious, sexual orientation, biometric, genetic, trade union, criminal)
4. **What is the sensitivity classification?** (Level 1-4 per the table above)
5. **What are the potential consequences if this data were accessed by an unauthorised party?** (Reputational, financial, emotional, discriminatory)
6. **Are there any other individuals whose data was in the file?** (Determines number of affected individuals)
7. **Has the user taken any action in response?** (Changed passwords, notified others, etc.)

### Step 7: Final Decision and Documentation

Based on the user's responses:

| If Classification Is... | Action |
|------------------------|--------|
| Level 1 (Public) | Document, close incident. No ICO notification. |
| Level 2 (Internal) | Document, close incident. ICO notification unlikely but record the reasoning. |
| Level 3 (Confidential) | ICO notification likely required within 72 hours. Prepare submission. |
| Level 4 (Restricted) | ICO notification mandatory within 72 hours. Prepare and submit immediately. |

---

## 4. Roles and Responsibilities

| Role | Responsibility |
|------|---------------|
| **Data Controller** (Dinis Cruz) | Final decisions on ICO reporting, user notification content, S3 deletion authorisation |
| **AppSec** | Breach assessment, containment guidance, regulatory analysis |
| **Historian** | Incident recording, decision logging, timeline maintenance |
| **DevOps** | S3 object deletion, log auditing, access review |
| **Librarian** | Document indexing, ensuring all breach docs are cross-referenced |

---

## 5. Prevention

This process should be triggered as rarely as possible. Prevention measures:

1. **D074:** Never use real values in documentation — use `[REDACTED]` or synthetic placeholders from the start
2. **D076:** Implement credential/key scanning in the content pipeline (pre-commit hooks)
3. **D077:** Treat transfer IDs + decryption keys as secrets at the same level as credentials
4. **Pattern 21:** Recognise that operational processes operate outside the technical security boundary — the zero-knowledge architecture cannot protect against values being published in documentation

---

## 6. Record Keeping

All breach-related documents must be retained for a minimum of 5 years (UK GDPR requirement for accountability). This includes:

- Incident records
- User notifications sent
- ICO assessment (whether reported or not — the reasoning must be documented)
- User responses to sensitivity questionnaire
- Containment action logs

---

*Data breach notification process established 19 February 2026 in response to INC-004. This is a living document — update after each breach or near-miss.*
