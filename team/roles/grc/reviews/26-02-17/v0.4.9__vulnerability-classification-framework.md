# v0.4.9 — GRC Vulnerability Classification Framework

**Version:** v0.4.9
**Date:** 2026-02-17
**Role:** GRC
**Team:** Explorer
**Triggered by:** INC-002 (daily brief Step 2: "GRC should define our severity scale")

---

## Purpose

This framework defines how SG/Send classifies vulnerability severity. It replaces ad hoc severity judgements with a repeatable, business-impact-based scale. All future vulnerability reports — internal or external — use this framework.

The framework has two components:
1. **Severity scale (P0-P10)** — based on actual business impact, not theoretical exploitability
2. **Risk decision matrix** — a structured method for deciding fix / accept / defer

---

## Principles

### 1. Business Impact Over Theoretical Exploitability

A vulnerability's severity is determined by **what actually happens if it's exploited**, not by whether exploitation is theoretically possible. A critical-sounding vulnerability with zero real-world impact is not a critical vulnerability.

### 2. Architecture is a Mitigating Factor

SG/Send's zero-knowledge architecture means the server only stores encrypted bytes. This is a **permanent, structural mitigating factor** for any server-side vulnerability. An attacker who compromises the server gets ciphertext they cannot decrypt. This doesn't eliminate vulnerabilities — it changes their impact class.

### 3. Preconditions Matter

A vulnerability requiring 5 unlikely preconditions to exploit is less severe than one requiring none, even if the theoretical impact is the same. We count preconditions explicitly.

### 4. The Fix is Also a Risk

Every fix changes the system. Complex fixes introduce new failure modes, new dependencies, and new attack surface. **The risk of the fix must be weighed against the risk of the vulnerability.** Sometimes the pragmatic answer is "accept the risk" with monitoring, not "add complexity."

### 5. Known vs Unknown

A vulnerability we already identified and accepted is fundamentally different from one we missed. Known/accepted means our process worked — we made a deliberate decision. Unknown means our process has a gap. The gap is often more important than the individual finding.

---

## Severity Scale: P0-P10

### Crisis Tier

| Level | Name | Criteria | Response Time | Example |
|-------|------|----------|--------------|---------|
| **P0** | Total Crisis | Active exploitation confirmed. Plaintext data breach. System compromise with data exfiltration. Complete loss of zero-knowledge guarantee. | Immediate — drop everything | Decryption keys leaked to server; active attacker exfiltrating plaintext; complete auth bypass with sensitive data exposed |
| **P1** | Major Incident | Real customer impact occurring now. Data at risk (even if not yet exfiltrated). Critical infrastructure compromised. | Hours | Server-side decryption possible via bug; production database exposed; admin credentials compromised with real user data present |

### Impact Tier

| Level | Name | Criteria | Response Time | Example |
|-------|------|----------|--------------|---------|
| **P2** | Significant Incident | Customer impact likely if not addressed. Exploitable vulnerability with realistic preconditions and meaningful data at risk. | Days | Auth bypass exploitable in production with real user data present; XSS with confirmed exfiltration path for sensitive data |
| **P3** | Must Fix Before Production | No current customer impact, but **would have impact with real users and real data**. Exploitable vulnerability with realistic preconditions, but no sensitive data currently at risk. | Before next production release | Auth bypass in pre-production (server has no real user data); client-side storage of plaintext in a zero-knowledge app |

### Improvement Tier

| Level | Name | Criteria | Response Time | Example |
|-------|------|----------|--------------|---------|
| **P4** | Should Fix | Real vulnerability, but low current risk due to: no sensitive data, low traffic, infrastructure mitigations, or high preconditions. | Next sprint | Supply chain risk mitigated by lockfile; upload size uncapped but Lambda limits it; path traversal requiring admin API key |
| **P5** | Fix When Convenient | Defence-in-depth improvement. Unlikely preconditions, compound dependencies, or blocked by pending decisions. | Backlog | Missing rate limiting (Lambda throttles naturally); unsalted hash (blocked by IP decision); S3 public access block (AWS defaults mitigate) |
| **P6** | Minor Improvement | Good security practice but very low exploitability or minor impact. Worth doing when touching nearby code. | Opportunistic | Transfer ID entropy (collision at 19.7M transfers); missing security headers (hash fragments don't leak per HTTP spec) |

### Noise Tier

| Level | Name | Criteria | Response Time | Example |
|-------|------|----------|--------------|---------|
| **P7** | Cosmetic / Theoretical | Real issue on paper but negligible practical impact. Would require extraordinary circumstances to exploit. | No timeline | Integer overflow requiring the decryption key; unbounded array requiring 100K downloads |
| **P8** | Negligible | Edge case with minimal impact. Technically a finding but not meaningfully exploitable. | No fix planned | Zero-byte payload accepted |
| **P9** | Informational | Not a vulnerability. Design observation, code quality note, or documentation improvement. | N/A | Code style, naming, comment accuracy |
| **P10** | Not Applicable | Finding doesn't apply to our architecture, is based on incorrect assumptions, or has been superseded. | N/A | Historical-only finding (already fixed in newer version) |

---

## Risk Decision Matrix

For every finding, answer these five questions:

### Q1: What Actually Happens If Exploited?

| Impact Class | Description | Severity Floor |
|-------------|-------------|---------------|
| **Plaintext breach** | Attacker obtains decrypted user data | P0-P1 |
| **Key compromise** | Attacker obtains decryption keys | P0-P1 |
| **Auth bypass → sensitive data** | Attacker bypasses auth AND accesses real user data | P2 |
| **Auth bypass → encrypted data only** | Attacker bypasses auth but server has only ciphertext | P3-P4 |
| **Quota/rate bypass** | Attacker exceeds usage limits but gains no data access | P4-P6 |
| **Information disclosure (metadata)** | Attacker learns metadata (file size, existence, timing) | P5-P7 |
| **Denial of service** | Attacker degrades or prevents service | P4-P6 |
| **No direct impact** | Theoretical or compound-only risk | P7-P8 |

### Q2: How Many Preconditions?

Count the requirements an attacker needs before exploitation:

| Preconditions | Adjustment |
|--------------|------------|
| 0 — no special access needed | No adjustment |
| 1 — needs valid token OR network position OR timing | -0 to -1 level (less severe) |
| 2 — needs valid token AND specific timing | -1 to -2 levels |
| 3+ — needs token AND timing AND another vulnerability AND specific backend | -2 to -3 levels |

### Q3: Is This Known or Unknown?

| Classification | Meaning | Process Implication |
|---------------|---------|-------------------|
| **Known / risk accepted** | Previously identified, assessed, decision made | Review and confirm the acceptance. No process failure. |
| **Known / not yet addressed** | Previously identified, on backlog | Confirm priority is correct. No process failure. |
| **Unknown / missed** | Not previously identified | **Process gap.** Conduct 2nd/3rd story analysis: why did we miss this? What systemic change prevents similar misses? |

### Q4: What Is the Risk of the Fix?

| Fix Complexity | Risk | Consideration |
|---------------|------|---------------|
| **One-line change** | Very low | Fix immediately |
| **Localised refactor** | Low | Fix in next sprint |
| **New dependency** | Medium | Weigh: does the dependency add more attack surface than it removes? |
| **Architecture change** | High | Weigh: is the architectural complexity itself a risk? New failure modes? New operational burden? |
| **Cross-service coordination** | Very high | Serious consideration needed. Distributed systems bugs can be worse than the original vulnerability. |

### Q5: What's the Pragmatic Decision?

| Decision | When to Use |
|----------|------------|
| **Fix now** | Impact is high, fix is low-risk, preconditions are few |
| **Fix before production** | Impact would be high with real users, even if low today |
| **Fix later** | Impact is low, fix is straightforward but not urgent |
| **Accept with monitoring** | Impact is low, fix introduces more risk than it removes. Monitor for change in conditions. |
| **Accept permanently** | Theoretical only, or mitigated by architecture. Document and move on. |
| **Research first** | Unclear whether fix or acceptance is correct. Gather more data before deciding. |

---

## Mapping External Severity to Internal Scale

External reviewers will use their own scales. This mapping translates:

| External Rating | Typical Meaning | Our Mapping Process |
|----------------|----------------|-------------------|
| Critical / P0 | Remote code execution, data breach | Apply Q1-Q5. Often maps to our P2-P4 due to zero-knowledge architecture. |
| High / P1 | Auth bypass, injection, sensitive data exposure | Apply Q1-Q5. Server-side findings often downgrade because server has only ciphertext. |
| Medium / P2 | XSS, CSRF, information disclosure | Apply Q1-Q5. Client-side findings may stay at same level (client has plaintext). |
| Low / P3 | Minor info leak, best practice gaps | Usually maps to our P6-P8. |

**Critical rule:** client-side vulnerabilities do NOT benefit from the zero-knowledge architecture discount. The browser has plaintext — that's where the user's data actually is. Server-side vulnerabilities benefit heavily because the server never has plaintext.

---

## Risk Acceptance Process

1. **GRC classifies** the finding using this framework
2. **GRC prepares a risk acceptance statement** with: finding, severity, mitigating factors, recommended decision, acceptance period
3. **Human (project lead) reviews and signs off** — agents do not accept risk unilaterally
4. **Librarian records** the decision in the vulnerability register
5. **GRC reviews** all accepted risks quarterly (or when conditions change)

### Risk Acceptance Statement Template

```
Finding:        [#, title]
Our Severity:   [P0-P10]
Impact Class:   [from Q1]
Preconditions:  [from Q2]
Known/Unknown:  [from Q3]
Fix Risk:       [from Q4]

Decision:       [Fix now / Fix before production / Fix later / Accept / Research]
Rationale:      [Why this decision is correct]
Mitigating factors: [What reduces the risk]
Conditions for re-evaluation: [What would change this decision]
Acceptance period: [e.g., 6 months, until production launch, permanent]
Signed off by:  [Human name, date]
```

---

## Applying the Framework: INC-002

The 29 findings from the first external security disclosure have been classified using this framework. See the incident pack at `library/sgraph-send/incidents/2026-02-17-security-review/` for individual finding classifications.

Finding #1 (token race condition) has been flagged for deeper analysis — the human stakeholder questions whether the fix risk (architectural complexity) exceeds the vulnerability risk (quota bypass on encrypted-only data). See the dedicated risk analysis: `team/roles/grc/reviews/26-02-17/v0.4.9__risk-analysis__finding-1-token-race-condition.md`.

---

*Produced by GRC Role | INC-002 | SGraph Send v0.4.9*
