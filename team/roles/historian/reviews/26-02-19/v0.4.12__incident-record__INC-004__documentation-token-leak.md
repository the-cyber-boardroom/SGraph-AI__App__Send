# v0.4.12 -- Incident Record: INC-004 User Data Exposure via Documentation

**Version:** v0.4.12
**Date:** 19 February 2026
**Role:** Historian
**Type:** Incident record — data breach with known affected user
**Severity:** P2-as-P1 (confirmed user data exposure; P2 until content sensitivity assessed, handled as P1)
**Related:** [INC-003 record](v0.4.12__incident-record__INC-003__access-token-leak-hotfix.md), [AppSec INC-003 response](../../appsec/reviews/26-02-19/v0.4.12__incident-response__access-token-leak.md), [Data breach notification process](../../appsec/reviews/26-02-19/v0.4.12__data-breach-notification-process.md), [User breach notification](../../appsec/reviews/26-02-19/v0.4.12__user-breach-notification__INC-004.md), [ICO reporting assessment](../../appsec/reviews/26-02-19/v0.4.12__ico-reporting-assessment__INC-004.md)

---

## 1. Incident Summary

**INC-004: User data exposure via leaked transfer ID and decryption key in documentation**

While documenting INC-003 (the access token leak in shareable URLs), the Historian, Journalist, and Librarian included **real transfer IDs and decryption keys** in their example URLs. This gave anyone with repo access the ability to:

1. **Access the transfer** using the transfer ID
2. **Decrypt the file content** using the decryption key in the hash fragment

Transfer `16bff884b7da` contained real user data — an "Enterprise AI Time-to-Value Survey" with filled-in answers uploaded by Dinis Cruz. The combined leak of transfer ID + decryption key completely bypassed the zero-knowledge encryption model that is the core security property of SGraph Send.

**This is a data breach.** Unlike INC-003 (which leaked authentication credentials but no file content), INC-004 exposed actual user data by publishing the exact values needed to retrieve and decrypt it.

### Severity Distinction from INC-003

| Aspect | INC-003 (token leak) | INC-004 (data exposure) |
|--------|---------------------|------------------------|
| What leaked | Sender authentication token | Transfer ID + decryption key |
| Impact | Platform access, quota consumption | **Full access to encrypted user data** |
| User data exposed | None — zero-knowledge held | **Yes — file content retrievable and decryptable** |
| Zero-knowledge model | Intact | **Broken for affected transfer** |
| Classification | P3-as-P1 | **P2-as-P1** |
| Data breach | No | **Yes — known affected user** |
| Regulatory implications | None | **ICO assessment required** |

### What Was Exposed

- **Transfer ID:** `16bff884b7da` (now redacted from all docs)
- **Decryption key:** Full AES-256-GCM key (now redacted from all docs)
- **Content:** "Enterprise AI Time-to-Value Survey" — a filled-in survey with personal/business responses
- **File size:** 7.7 KB encrypted text
- **Upload time:** Thu, 19 Feb 2026 15:07:20 GMT
- **Downloads before deletion:** 1
- **Affected user:** Dinis Cruz (project owner)

### Chain of Custody (How the Leak Occurred)

1. **Dinis shared the download URL** (containing transfer ID + decryption key) with the agent in a **private Claude Code session**. This session is not exposed to the internet and not indexed. Sharing real URLs in a private agent session is normal and expected — this was not the breach.
2. **The agent (Historian, Journalist, Librarian roles) copied those real values** into documentation files as "example URLs" illustrating the before/after of the INC-003 hotfix.
3. **The agent committed and pushed those documentation files** to the GitHub branch `claude/read-explorer-guidance-StQko`.
4. **This made the real transfer ID + decryption key accessible** to anyone with repository access, and preserved them permanently in git history.

**The breach vector:** An agent took values from a private conversation context and published them into a shared repository. The user's action (sharing a link in a private session) was appropriate. The agent's action (writing real values into committed documentation) was the breach.

### Timeline (19 February 2026)

| Time | Event | Actor |
|------|-------|-------|
| ~15:07 | User uploads survey file via SGraph Send | Dinis Cruz |
| ~15:45 | INC-003 documentation committed with real transfer IDs and decryption keys | Agent (Historian, Journalist, Librarian) |
| ~15:50 | Documents pushed to GitHub branch | Agent |
| ~16:00 | Human spots token value in Journalist article | Dinis Cruz |
| ~16:04 | Token values redacted from 6 files (Round 1 — tokens only) | Agent |
| ~16:10 | Human identifies that transfer IDs + decryption keys are ALSO in the docs | Dinis Cruz |
| ~16:12 | Transfer IDs and decryption keys redacted from 3 files (Round 2) | Agent |
| ~16:15 | Human confirms transfer `16bff884b7da` contained real user data (filled survey) | Dinis Cruz |
| ~16:15 | Incident escalated from P4-as-P1 to **P2-as-P1** (data breach confirmed) | Dinis Cruz |
| ~16:20 | S3 object deletion initiated | Dinis Cruz |
| ~16:20 | Data breach notification process initiated | Agent |
| ~16:28 | **S3 deletion confirmed** — 2 objects (9.0 KB) permanently deleted, download URL returns "Transfer not found" | Dinis Cruz |
| ~16:28 | New SG/Send link created and sent to original recipient, informing them the previous link no longer works | Dinis Cruz |
| ~16:30 | Data breach notification process document created | Agent |
| ~16:35 | User breach notification document created | Agent |
| ~16:40 | ICO reporting assessment document created | Agent |
| ~16:36 | **Deliberate decision:** Feature branch merged to `dev` — token exposure increased with risk acceptance (D080-D082). GRC, Sherpa, DPO assessments completed. | Dinis Cruz |

---

## 2. Why This Is a Separate Incident (Not Part of INC-003)

INC-003 and INC-004 have different root causes, different impacts, and different remediation requirements:

| Dimension | INC-003 | INC-004 |
|-----------|---------|---------|
| **Root cause** | Code defect — token embedded in URL construction logic | Documentation practice — real values used as examples |
| **What leaked** | Authentication credential | User data access path (transfer ID + decryption key) |
| **Blast radius** | All shareable URLs since v0.1.3 | Specific transfers documented as examples |
| **Data breach** | No (no file content accessible) | **Yes** (file content retrievable + decryptable) |
| **Fix type** | Code change (hotfix) | Documentation redaction + S3 object deletion |
| **Regulatory scope** | None | **ICO notification assessment required** |
| **User notification** | Token rotation advisory | **Data breach notification required** |

INC-003 is resolved and fully fixed. INC-004 is a new incident requiring its own response chain.

---

## 3. Impact Assessment

### Exposure Window

- **Documentation pushed to GitHub:** ~15:50
- **Transfer IDs + keys redacted:** ~16:12
- **S3 object deletion initiated:** ~16:20
- **S3 object deletion confirmed:** 16:28 (2 objects, 9.0 KB permanently deleted; download URL returns "Transfer not found")
- **Total exposure window:** ~30 minutes (docs on GitHub) / ~38 minutes (file retrievable until S3 confirmed deleted)

### Access During Exposure Window

Anyone with access to the GitHub branch `claude/read-explorer-guidance-StQko` during the ~30-minute window could have:
1. Read the transfer ID from the documentation
2. Read the decryption key from the documentation
3. Constructed the download URL
4. Downloaded and decrypted the file

### Mitigating Factors

1. **Branch access is limited** — the branch is on a private/team repository, not a public-facing publication
2. **Short exposure window** — ~30 minutes from push to redaction
3. **Download count:** The file shows 1 download (likely the legitimate download by the sender)
4. **S3 object deleted** — the file is no longer retrievable even if someone still has the transfer ID + key
5. **Git history still contains the values** — the transfer ID and decryption key remain in git commit history even after redaction

### Remaining Risks

1. **Git history** — anyone who cloned or fetched the branch during the exposure window has the values in their local git history
2. **GitHub caching** — GitHub may cache commit diffs containing the values
3. **The decryption key is now permanently compromised for this transfer** — even though the S3 object is deleted, if anyone copied the encrypted data during the window, they can decrypt it

---

## 4. Remediation Actions

| # | Action | Priority | Status | Owner |
|---|--------|----------|--------|-------|
| 1 | Redact token values from documentation | P1 | **DONE** (~16:04) | Agent |
| 2 | Redact transfer IDs + decryption keys from documentation | P1 | **DONE** (~16:12) | Agent |
| 3 | Delete S3 object for transfer `16bff884b7da` | P1 | **DONE** (~16:28 confirmed — 2 objects, 9.0 KB permanently deleted) | Dinis Cruz |
| 4 | Create new SG/Send link and notify original recipient | P1 | **DONE** (~16:28) | Dinis Cruz |
| 5 | Create data breach notification process | P1 | **DONE** (~16:30) | Agent |
| 6 | Send user breach notification to affected user | P1 | **DONE** (~16:35) | Agent |
| 7 | Complete ICO reporting assessment | P1 | **DONE** (~16:40) | Agent |
| 8 | Gather content sensitivity information from affected user | P1 | **Pending — questionnaire in user breach notification** | Dinis Cruz (as user) |
| 9 | Make final ICO reporting decision based on content sensitivity | P1 | **Pending — 72-hour deadline: ~16:15 on 22 Feb 2026** | Dinis Cruz (as controller) |
| 10 | Rotate affected access tokens | P1 | Pending | Dinis Cruz |
| 11 | Assess need for git history rewrite | P2 | Open (Q017) | Dinis Cruz |

---

## 5. Milestone Record

### M017: First Data Breach — User Data Exposed via Documentation (Supersedes Previous M017)

**Date:** 19 February 2026
**Version:** v0.4.12
**Significance:** The project's first actual data breach. Previous incidents involved credential exposure (INC-003) or process issues (INC-001, INC-002). INC-004 is the first incident where **real user data was made accessible to unauthorised parties**.

**Why this matters for the historical record:**

1. **The zero-knowledge model was bypassed via documentation, not code.** The encryption architecture held in code — the server never saw plaintext. But the documentation pipeline published the exact values needed to defeat the encryption. The breach came from the process, not the technology.

2. **This triggers data protection obligations.** Unlike INC-003, which had no regulatory implications, INC-004 involves confirmed exposure of user data and requires assessment against ICO (UK GDPR) reporting thresholds.

3. **The "meta-incident" pattern (Pattern 20) is more serious than initially classified.** When INC-004 was first documented, it was treated as P4-as-P1 (a documentation issue). The escalation to P2-as-P1 recognises that the documentation didn't just leak credentials — it leaked the complete path to user data.

4. **A breach notification process had to be created from scratch.** No data breach notification process existed because the zero-knowledge architecture was designed to make data breaches impossible. This incident proves that operational processes (documentation, not code) can create breach paths that the architecture cannot prevent.

---

## 6. Decisions

### D074-D076 (retained from initial assessment)

| ID | Decision | Rationale |
|----|----------|-----------|
| D074 | All documentation must use `[REDACTED]` or synthetic placeholders for real values | Real values create exposure risk through git history, branch sharing, and publication |
| D075 | Token rotation required | Token value exists in git history across multiple branches |
| D076 | Content release pipeline needs credential scanning | No automated check exists for credentials/keys in documentation files |

### D077-D079 (new — escalated response)

| ID | Decision | Rationale |
|----|----------|-----------|
| D077 | **Transfer IDs and decryption keys are secrets on the same level as credentials** | Combined, they defeat the zero-knowledge model. D074 now explicitly covers transfer IDs and decryption keys, not just tokens. |
| D078 | **SGraph Send requires a data breach notification process** | The zero-knowledge architecture was designed to prevent breaches, but operational processes can bypass it. A formal process must exist for when it happens. |
| D079 | **S3 objects must be deleted immediately when their access path is compromised** | Deleting the ciphertext is the only remediation that works retroactively — even if the key is compromised, no data is recoverable if the ciphertext is gone. |

**Cumulative decision count: D001-D079 (79 decisions).**

---

## 7. Patterns

### Pattern 20: The Documentation Leak Paradox (Escalated)

**Updated from initial assessment.** The initial classification of Pattern 20 focused on "credentials in docs." The escalated assessment reveals a more serious variant: **documentation that publishes the complete access path to user data.** The paradox isn't just "incident reports leak credentials" — it's "incident reports can leak the very data they claim to protect."

### Pattern 21: Operational Process Bypass of Technical Architecture

**First observed:** 19 February 2026
**Description:** A zero-knowledge encryption architecture is designed so the server never sees plaintext. But the documentation process — which operates outside the encrypted data path — published the transfer ID and decryption key that together bypass the entire encryption layer. The security architecture protected against technical attacks but was bypassed by an operational process.

**Why this is a named pattern:** This is a category of vulnerability that no amount of code review or penetration testing will find. The code is correct. The architecture is sound. The breach came from a human/agent process that operates entirely outside the system's security boundary.

**Cumulative named patterns: 25** (21 numbered + 4 lettered).

---

## 8. Open Questions

| ID | Question | Status |
|----|----------|--------|
| Q017 | Should git history be rewritten to remove leaked values? | Open — destructive operation, rotation + S3 deletion may be sufficient |
| Q018 | Should a pre-commit hook scan documentation for token/key patterns? | Open — implementation details TBD |
| Q019 | **What was the exact content and sensitivity of the exposed survey?** | **Open — requires user input. Determines ICO reporting requirement.** |
| Q020 | **Does this incident meet the ICO 72-hour reporting threshold?** | **Open — depends on Q019 answer. Assessment document created.** |
| Q021 | **Should all existing documentation be audited for other leaked transfer IDs/keys?** | **Open — there may be other transfers referenced in docs that haven't been found yet.** |

---

## 9. Incident Registry

| ID | Date | Type | Severity | Resolution | Key Learning |
|----|------|------|----------|------------|--------------|
| INC-001 | 12 Feb | Commit impersonation | Process | Same day | Git config hygiene |
| INC-002 | 17 Feb | External security review | P1 (process) | Ongoing | 29 findings; zero-knowledge validated |
| INC-003 | 19 Feb | Access token in URLs | P3-as-P1 | ~100 min | Auth credentials must never be forwarded |
| **INC-004** | **19 Feb** | **User data exposure via documentation** | **P2-as-P1** | **In progress** | **Documentation can bypass zero-knowledge architecture; data breach notification process needed** |

---

## 10. Connection to INC-003

INC-003 and INC-004 occurred on the same day but are distinct incidents:

- **INC-003** was a **code defect** — the application embedded tokens in URLs. Fixed by changing the code. No user data exposed. **Resolved.**
- **INC-004** was an **operational process failure** — documentation included real transfer IDs and decryption keys. Fixed by redaction + S3 deletion. **User data was exposed.** Requires data breach notification. **In progress.**

The root cause connection: INC-003 created the conditions (the documentation context) in which INC-004 occurred. But they require different remediation, different notification, and different regulatory assessment.

---

*Historian INC-004 record updated 19 February 2026. Severity: P2-as-P1. S3 object permanently deleted (confirmed 16:28). New link sent to original recipient. Data breach notification process, user breach notification, and ICO reporting assessment all created. Awaiting content sensitivity classification from affected user (Q019) to make ICO reporting decision (Q020). 72-hour ICO deadline: ~16:15 on 22 February 2026.*
