# v0.3.12 -- Cartographer Action Plan: Brief Response (15 Feb 2026)

**Version:** v0.3.12
**Date:** 2026-02-15
**Role:** Cartographer
**Team:** Explorer
**Brief:** `team/humans/dinis_cruz/briefs/02/15/v0.3.10__daily-brief__explorer-team-15-feb-2026.md`
**Previous:** `team/roles/cartographer/reviews/26-02-14/v0.3.2__action-plan__explorer-next-steps.md`
**Master index:** `team/roles/librarian/reviews/26-02-15/v0.3.10__master-index__daily-brief-15-feb.md`
**Architect observability proposal:** `team/roles/architect/reviews/26-02-15/v0.3.6__implementation-proposal__observability-pipeline.md`

---

## Executive Summary

The v0.3.10 brief introduces the most significant expansion of the system's internal architecture since the two-Lambda model was established. The **Server Analytics (SA) dashboard** adds an entire sub-application within the admin Lambda, the **LETS pipeline** introduces a new class of data flow (event-driven and collected), and the **digital twin** concept creates a persistent, temporal representation of the AWS environment.

This action plan delivers:
1. Map updates needed for SA dashboard topology, LETS pipeline data flows, and digital twin architecture
2. New components to map -- path-based SA routes, cache browser, Lambda dashboard, CloudFront viewer, S3-triggered Lambda
3. Carryover status from v0.3.2 action plan
4. Updated ASCII topology diagram showing the SA dashboard and its relationships

---

## 1. Map Updates Needed

### 1.1 SA Dashboard Topology

The SA dashboard is a **new sub-application within the admin Lambda**. It does not add a new Lambda -- it adds a new routing tree, new service layer, and new UI layer within the existing admin infrastructure. This is a significant topology change: the admin Lambda evolves from a token management endpoint into a full operational console.

**What must be mapped:**

| Area | Current State (v0.3.0 map) | New State (v0.3.12) |
|------|---------------------------|---------------------|
| Admin Lambda routes | `/tokens/*`, `/health/pulse`, `/info` | Add `/admin/dashboard/*` with 7+ sub-routes |
| Admin UI architecture | Single-page placeholder (tabs: Tokens, Analytics, System) | Multi-page app: index page + SA dashboard (separate page) |
| URL structure | Hash-fragment navigation (`#tokens`, `#analytics`) | **Path-based navigation** (D038) for SA dashboard |
| Service layer | `Service__Tokens`, `Service__Analytics__Pulse`, `Send__Cache__Client` | Add `CloudWatch__Client`, 3 metric collectors, `SGraph_Send__Metrics__Snapshot`, `Service__Analytics__Aggregator`, `Dashboard__Generator` |
| Schema count | 6 Type_Safe schemas | Add 9 new metric schemas (from Architect proposal) = 15 total |

**Key architectural observation:** The SA dashboard introduces a **read-only pathway** through the admin Lambda. All existing routes (tokens, analytics pulse) are read-write. The SA dashboard routes are read-only views of data collected by background processes (LETS pipeline) or on-demand API calls. This distinction should be visible in the topology map -- read-only vs read-write routes have different security and caching characteristics.

### 1.2 LETS Pipeline Data Flows

The LETS pipeline introduces **two fundamentally different data collection patterns** that must be mapped separately. Neither existed in v0.3.0.

**Pattern A: Event-Driven Data (Logs)**

```
CloudFront / Lambda / S3
        |
        | (AWS writes logs automatically)
        v
S3 Log Bucket (raw logs)
        |
        | (S3 event notification -- NEW infrastructure)
        v
S3-Triggered Lambda (NEW component)
        |
        | Load: read raw log file
        | Extract: parse relevant fields
        | Transform: normalise, compress (~90% reduction)
        | Save: write curated version
        v
Cache Service (temporal + latest)
        |
        | (admin UI reads curated data)
        v
SA Dashboard (CloudFront log viewer)
```

**Pattern B: Collected Data (API Calls)**

```
Scheduled / On-Demand Trigger
        |
        v
CloudWatch__Client (NEW service)
        |
        | Load: call AWS APIs (CloudWatch, Lambda, S3 configs)
        | Extract: select ~20 relevant settings per service
        | Transform: schema-ify into Type_Safe objects
        | Save: write to cache (latest + temporal)
        v
Cache Service
   |         |
   |         +-- latest/     (current state snapshot)
   |         +-- temporal/   (historical snapshots, date-partitioned)
   |
   | (delta tracking -- only save if changed)
   v
SA Dashboard (Lambda view, CloudFront view, infrastructure overview)
```

**What must be mapped:**
- The S3-triggered Lambda is a **third Lambda function** (not a third application Lambda -- it's a data processing Lambda). This changes the deployment topology from "2 application Lambdas" to "2 application Lambdas + N data processing Lambdas."
- The cache service gains new namespaces: `metrics`, `aggregation`, `costs` (in addition to existing `analytics`, `tokens`, `transfers`, `costs`).
- Data flow is **bidirectional** for the first time: the admin Lambda both writes to (LETS save) and reads from (SA dashboard display) the cache service. Previously, write operations (analytics events, token operations) and read operations (pulse, token lookup) were on the same Lambda. Now the write side may happen on a different Lambda (S3-triggered).

### 1.3 Digital Twin Architecture

The digital twin concept extends the cache service's temporal storage pattern into a **versioned configuration repository**. This is not a new component -- it is a new usage pattern of the existing cache service.

**What must be mapped:**

```
Digital Twin Storage Layout (within cache service)
|
+-- latest/                          -- Current state of AWS environment
|   +-- lambda/{function-name}/      -- Lambda configs, metrics
|   +-- cloudfront/{dist-id}/        -- CloudFront configs, metrics
|   +-- s3/{bucket-name}/            -- S3 configs, metrics
|   +-- route53/                     -- DNS settings
|
+-- temporal/                        -- Historical snapshots
|   +-- {YYYY}/{MM}/{DD}/{HH}/
|       +-- lambda/{function-name}/  -- Point-in-time config snapshot
|       +-- cloudfront/{dist-id}/
|       +-- s3/{bucket-name}/
|
+-- diffs/                           -- Change tracking (future)
    +-- {YYYY}/{MM}/{DD}/
        +-- {component-id}.diff.json -- What changed between snapshots
```

**Cartographer observation:** The digital twin turns the cache service from a "data store" into an "environment state machine." Over time, this storage pattern becomes the foundation of compliance, debugging, and cost analysis. The Wardley evolution of the cache service integration (C16) should move further right -- from early Custom-Built toward solid Custom-Built -- because it now has a clear, repeatable, high-value usage pattern.

---

## 2. New Components to Map

### 2.1 Path-Based SA Routes

The SA dashboard introduces path-based routing (D038). Each route is a self-contained view that loads independently.

| Route | Purpose | Data Source | Priority |
|-------|---------|-------------|----------|
| `/admin/dashboard/` | SA overview -- summary of all views | Aggregated from all sources | P2 |
| `/admin/dashboard/lambda/` | All Lambda functions list | CloudWatch metrics via collectors | P2 |
| `/admin/dashboard/lambda/{id}` | Specific Lambda detail | CloudWatch metrics + config | P2 |
| `/admin/dashboard/cloudfront/` | CloudFront overview | CloudWatch us-east-1 metrics | P2 |
| `/admin/dashboard/cloudfront/logs/` | CloudFront log viewer | Curated logs from LETS pipeline | P2 |
| `/admin/dashboard/s3/` | S3 overview | S3 request metrics | P3 |
| `/admin/dashboard/cache/` | Cache service browser | Direct cache navigation | **P1** (gating) |
| `/admin/dashboard/costs/` | AWS cost dashboard | Cost data from cache | P3 |

**Evolution stage:** Genesis. Path-based routing is a known pattern externally (Product/Commodity), but our implementation within the IFD framework and admin Lambda is unexplored. Build priority is cache browser first (P1), then Lambda/CloudFront (P2), then S3/costs (P3).

### 2.2 Cache Service Browser

The cache browser is the **highest-priority SA view** (D039) because it is both a development tool and an operational dashboard. It provides visibility into the entire cache service -- every namespace, every temporal partition, every stored object.

**Component topology:**

```
/admin/dashboard/cache/
|
+-- Cache ID browser       -- List all cache IDs in a namespace
+-- Temporal navigator     -- Date-based navigation (YYYY/MM/DD/HH)
+-- Latest viewer          -- Current state of any cache entry
+-- Entry inspector        -- JSON/text/binary viewer for individual entries
+-- Folder navigator       -- Browse the folder structure within cache entries
```

**Dependencies:** Requires `Send__Cache__Client` read methods (existing), path-based routing infrastructure (new), admin UI page shell (existing).

**Evolution stage:** Genesis. No implementation exists.

### 2.3 Lambda Functions Dashboard

Displays configuration, metrics, and historical data for all Lambda functions in the environment.

**Data flow:**

```
CloudWatch__Client
    |
    +-- Lambda__Metrics__Collector
    |       |
    |       +-- Collects: invocations, errors, duration (avg/p50/p95/p99/max), throttles, concurrency
    |       +-- For: user Lambda, admin Lambda (+ data processing Lambdas in future)
    |       v
    |   Schema__Lambda__Metrics (per function)
    |       |
    v       v
Schema__Metrics__Snapshot
    |
    v
Cache Service (latest + temporal)
    |
    v
/admin/dashboard/lambda/
    |
    +-- Function list (name, status, last invocation, error rate)
    +-- Function detail (all metrics, config, historical comparison)
```

**Evolution stage:** Genesis. Data sources are live (CloudWatch metrics flowing per DevOps confirmation), but no collector or viewer exists.

### 2.4 CloudFront Log Viewer

Visualises CloudFront access logs processed through the LETS pipeline.

**Data flow:**

```
CloudFront Real-Time Logs
    |
    v
Kinesis --> Firehose --> S3 (raw logs, IP excluded per DPO)
    |
    v (S3 event trigger)
S3-Triggered Lambda
    |
    +-- Parse log entries
    +-- Normalise fields
    +-- Aggregate: "50x GET /api/file, unique IPs: 12"
    +-- Compress: ~90% reduction
    v
Cache Service (temporal + latest)
    |
    v
/admin/dashboard/cloudfront/logs/
    |
    +-- Traffic patterns (requests over time)
    +-- Response codes (2xx/3xx/4xx/5xx distribution)
    +-- Popular endpoints (top paths)
    +-- Request rates (requests per minute/hour)
```

**Evolution stage:** Genesis. The data source is live (CloudFront real-time logs via Firehose to S3 are configured), but no processing Lambda or viewer exists. The Architect proposal (v0.3.6) recommends deferring per-request log processing to Phase 2 and using CloudWatch aggregate metrics for Phase 1.

### 2.5 S3-Triggered Lambda (Data Processing)

This is a **new type of component** in the system: a data processing Lambda that is not part of either application Lambda. It runs automatically when log files land in S3.

**Topology change:**

```
Before (v0.3.0):
    2 Lambdas: User (public) + Admin (authenticated)

After (v0.3.12+):
    2 Application Lambdas: User (public) + Admin (authenticated)
    N Data Processing Lambdas: S3-triggered log transformers (automated)
```

**Characteristics of data processing Lambdas:**
- No HTTP endpoints (triggered by S3 events, not HTTP requests)
- No authentication layer (internal AWS event trigger)
- Single-purpose: read from one S3 location, write to cache service
- Stateless: each invocation processes one log file
- No UI: output is consumed by SA dashboard via cache service

**Evolution stage:** Genesis. The concept is defined but no implementation exists. DevOps needs to configure S3 event notifications (task #15).

### 2.6 Three Missing Admin UI Elements

The brief identifies three UI components that should be mapped as new sub-components of the admin console:

| Component | Purpose | Map Location |
|-----------|---------|--------------|
| API call log | Visualise every API call the admin UI makes | Admin UI -> debugging tools |
| Event log | Visualise UI events (clicks, triggers, loads) | Admin UI -> debugging tools |
| Message panel | System messages, status updates, errors | Admin UI -> user communication |

These are **developer/admin tools**, not user-facing features. They exist in code the human has from other projects. Evolution stage: Genesis within this project (Custom-Built externally -- code exists elsewhere).

---

## 3. Carryover from v0.3.2

### 3.1 Status of v0.3.2 Action Items

| # | v0.3.2 Action Item | Status | Notes |
|---|-------------------|--------|-------|
| A1 | Publish evolution map to all roles | **DONE** | v0.3.2 evolution map published in action plan |
| A2 | Support Explorer in Handover Package #1 brief | **PENDING** | No handover brief written yet. 5 components still ready. Not addressed in v0.3.10 brief -- Explorer focus shifted to SA dashboard |
| A3 | Create `.issues` file for Cartographer | **PENDING** | Issues FS adoption not yet started for Cartographer |
| A4 | Update system landscape map for two-team topology | **PARTIALLY DONE** | Two-team topology documented in v0.3.2 action plan. Full landscape map update pending (this document begins it) |
| A5 | Track component movement on evolution axis | **ACTIVE** | See Section 3.2 below |
| A6 | Update handover pipeline visual | **NO CHANGE** | No components entered or exited handover zone since v0.3.2 |
| A7 | Assess new components from briefs | **ACTIVE** | This document assesses 6+ new sub-components from v0.3.10 brief |
| A8 | Provide maturity data to Explorer/Villager | **NOT REQUESTED** | No requests received since v0.3.2 |
| A9 | Create living Wardley Map document | **PENDING** | P2, not started |
| A10 | Map design agency external dependency | **PENDING** | Design agency brief published (Designer v0.3.3), but engagement not yet started |
| A11 | Research Town Planners trigger criteria | **PENDING** | P3, too early -- no components at Product stage yet |

### 3.2 Evolution Map Updates Since v0.3.2

| # | Component | v0.3.2 Stage | v0.3.12 Stage | Movement | Reason |
|---|-----------|-------------|--------------|----------|--------|
| C8 | Admin interface | Custom-Built (early) | Custom-Built (expanding) | Rightward | SA dashboard adds substantial capability; admin is no longer a placeholder |
| C10 | Observability / SA | Genesis | Genesis -> Custom-Built (early) | **Rightward** | LETS pipeline is live (cache service logging), AWS logging fully configured, first collector deployed |
| C13 | Large file transfer | Genesis | Genesis (with research mandate) | Stationary | Upload/download resilience research mandated (D041) but no implementation |
| C16 | Cache integration | Custom-Built (early) | Custom-Built (maturing) | Rightward | Digital twin usage pattern, metrics/aggregation namespaces, central to SA dashboard |

**New sub-components identified (not top-level evolution map items, but worth tracking):**

| Sub-Component | Parent | Stage | Notes |
|---------------|--------|-------|-------|
| SA Dashboard (path-based routing) | C8, C10 | Genesis | D038 approved, not implemented |
| Cache browser | C10 | Genesis | Highest-priority SA view (D039) |
| Lambda dashboard | C10 | Genesis | Depends on cache browser + CloudWatch collectors |
| CloudFront log viewer | C10 | Genesis | Depends on LETS pipeline + S3-triggered Lambda |
| S3-triggered Lambda | C10 | Genesis | New Lambda type -- data processing |
| CloudWatch__Client | C10 | Genesis | Architect schema design complete (v0.3.6), not implemented |
| Metric collectors (3) | C10 | Genesis | Lambda, S3, CloudFront collectors designed |
| Digital twin storage | C16 | Genesis | Architectural concept, no implementation |

### 3.3 Updated Evolution Map v0.3.12

```
 VISIBILITY
 (to user)     GENESIS            CUSTOM-BUILT           PRODUCT         COMMODITY
    |
    |  HIGH
    |  (user                       [Browser Encryption]----->
    |   sees)                      [File Upload/Download]--->
    |                              [Link Sharing]----------->
    |
    |           [Landing Page/UX]----->
    |           [Unencrypted Mode].
    |           [Read Receipts]...
    |           [Multi-File Upload]..
    |           [3-Word Keys]....                              (D040: needs review)
    |
    |  MEDIUM
    |  (user                       [Token System]----------->
    |   uses                       [S3 Storage Backend]----->
    |   indirectly)
    |           [Design/Brand]....
    |           [Large File Xfer].                             (D041: research started)
    |
    |  LOW
    |  (internal                   [Admin Interface]=======>
    |   only)                      [Inter-Lambda Comms]
    |                              [Analytics Middleware]
    |           [SA Dashboard]------->
    |           [LETS Pipeline]------>
    |           [Digital Twin]....
    |           [Observability/SA]=======>
    |           [Multilingual].....
    |           [Theme System].....
    |           [Issues FS Integ]----->
    |           [Cache Integration]=====>
    |           [External Claude Bot]..
    |           [Slack/WhatsApp Bot]...
    |
    +---------|------------------|---------------------|-------------|------
              GENESIS            CUSTOM-BUILT          PRODUCT       COMMODITY

LEGEND:
  [Component]=======>   = significant rightward movement this version
  [Component]----->     = movement arrow (heading rightward on evolution axis)
  [Component]....       = stationary at genesis (needs exploration before moving)
  [Component]           = stationary at current stage
```

---

## 4. ASCII Topology Diagram: SA Dashboard Architecture

### 4.1 SA Dashboard System Map

This diagram shows the complete SA dashboard architecture and how it integrates with the existing admin Lambda infrastructure.

```
+===========================================================================+
|                        SA DASHBOARD SYSTEM MAP v0.3.12                      |
+===========================================================================+
|                                                                            |
|  BROWSER (Admin)                                                           |
|  +----------------------------------------------------------------------+ |
|  |                                                                      | |
|  |  Admin Index Page                    SA Dashboard (separate page)    | |
|  |  /admin/                             /admin/dashboard/               | |
|  |  +--------------------+              +-----------------------------+ | |
|  |  | [Tokens]           |              |                             | | |
|  |  | [Analytics Pulse]  |              |  SA Navigation              | | |
|  |  | [System Health]    |              |  +------------------------+ | | |
|  |  | [IFD Version]      |              |  | /cache/    (P1 first)  | | | |
|  |  | [Links: Swagger,   |              |  | /lambda/   (P2)        | | | |
|  |  |  main site, docs]  |              |  | /lambda/{id}           | | | |
|  |  +--------------------+              |  | /cloudfront/ (P2)      | | | |
|  |          |                           |  | /cloudfront/logs/      | | | |
|  |          |                           |  | /s3/         (P3)      | | | |
|  |          |                           |  | /costs/      (P3)      | | | |
|  |          |                           |  +------------------------+ | | |
|  |          |                           |                             | | |
|  |          |                           |  SA View Area               | | |
|  |          |                           |  +------------------------+ | | |
|  |          |                           |  | [Active View Component]| | | |
|  |          |                           |  | (Web Component, IFD)   | | | |
|  |          |                           |  +------------------------+ | | |
|  |          |                           |                             | | |
|  |          |                           |  Dev Tools Bar              | | |
|  |          |                           |  +------------------------+ | | |
|  |          |                           |  | [API Call Log]         | | | |
|  |          |                           |  | [Event Log]            | | | |
|  |          |                           |  | [Message Panel]        | | | |
|  |          |                           |  +------------------------+ | | |
|  |          |                           +-----------------------------+ | |
|  +---------|-------------------------------|----------------------------+ |
|            |                               |                              |
+============|===============================|==============================+
             |                               |
    ADMIN LAMBDA (authenticated, API key)    |
    +--------|-------------------------------|----------------------------+
    |        |                               |                            |
    |  Existing Routes          SA Dashboard Routes                       |
    |  +-----------------+      +-----------------------------------+     |
    |  | /tokens/*       |      | /admin/dashboard/                 |     |
    |  | /health/pulse   |      | /admin/dashboard/cache/*          |     |
    |  | /info           |      | /admin/dashboard/lambda/*         |     |
    |  | /metrics/*      |      | /admin/dashboard/cloudfront/*     |     |
    |  | (from v0.3.6)   |      | /admin/dashboard/s3/*             |     |
    |  +-----------------+      | /admin/dashboard/costs/*          |     |
    |        |                  +-----------------------------------+     |
    |        |                               |                            |
    |  +-----v-----------+      +------------v------------------------+   |
    |  | Service Layer   |      | SA Service Layer                    |   |
    |  | (existing)      |      | (new -- from Architect v0.3.6)     |   |
    |  |                 |      |                                     |   |
    |  | Service__Tokens |      | CloudWatch__Client                  |   |
    |  | Service__Pulse  |      |   +-- Lambda__Metrics__Collector    |   |
    |  | Middleware__     |      |   +-- S3__Metrics__Collector        |   |
    |  |   Analytics     |      |   +-- CloudFront__Metrics__Collector|   |
    |  |                 |      |                                     |   |
    |  |                 |      | SGraph_Send__Metrics__Snapshot      |   |
    |  |                 |      | Service__Analytics__Aggregator      |   |
    |  |                 |      | Dashboard__Generator                |   |
    |  +-----------------+      +-------------------------------------+   |
    |        |                               |                            |
    |        +---------------+---------------+                            |
    |                        |                                            |
    |                        v                                            |
    |              +---------+----------+                                 |
    |              | Send__Cache__Client|                                 |
    |              +--------------------+                                 |
    |              | Namespaces:        |                                 |
    |              |  analytics/        | <-- Middleware__Analytics writes |
    |              |  tokens/           | <-- Service__Tokens writes      |
    |              |  metrics/          | <-- Collectors write (NEW)      |
    |              |  aggregation/      | <-- Aggregator writes (NEW)     |
    |              |  costs/            | <-- Cost collector writes (NEW) |
    |              |  transfers/        | <-- (future)                    |
    |              +--------------------+                                 |
    |                        |                                            |
    +------------------------|--------------------------------------------+
                             |
                             v
                   +---------+----------+
                   | Cache__Service__   |
                   |  Client (MGraph-AI)|
                   +--------------------+
                             |
                             v
                   +---------+----------+
                   | Memory-FS          |
                   | (S3 backend)       |
                   +--------------------+
```

### 4.2 LETS Pipeline Data Flow Map

```
+===========================================================================+
|                   LETS PIPELINE DATA FLOWS v0.3.12                          |
+===========================================================================+
|                                                                            |
|  DATA SOURCES (AWS Infrastructure)                                         |
|  +-----------------------------------------------------------------+      |
|  |                                                                 |      |
|  |  EVENT-DRIVEN (automatic)          COLLECTED (on-demand/sched)  |      |
|  |  +--------------------------+      +--------------------------+ |      |
|  |  | CloudFront access logs   |      | Lambda configurations    | |      |
|  |  | (Kinesis->Firehose->S3)  |      | Lambda metrics           | |      |
|  |  |                          |      | CloudFront settings      | |      |
|  |  | CloudWatch logs          |      | CloudFront metrics       | |      |
|  |  | (Lambda execution logs)  |      | S3 bucket configs        | |      |
|  |  |                          |      | S3 request metrics       | |      |
|  |  | CloudTrail audit logs    |      | Route 53 settings        | |      |
|  |  |                          |      | IAM settings             | |      |
|  |  | S3 access logs           |      | Cost/billing data        | |      |
|  |  +-----------+--------------+      +------------+-------------+ |      |
|  |              |                                  |               |      |
|  +-----------+--|----------------------------------|-+---+----------+      |
|              |  |                                  |    |                  |
|              v  v                                  v    |                  |
|                                                         |                  |
|  PROCESSING LAYER                                       |                  |
|  +----------------------------+  +---------------------+|--+              |
|  | S3-Triggered Lambda (NEW)  |  | CloudWatch__Client       |              |
|  | (data processing Lambda)   |  | (within admin Lambda)    |              |
|  |                            |  |                          |              |
|  | L: Read raw log from S3    |  | L: Call AWS API          |              |
|  | E: Parse relevant fields   |  | E: Select ~20 fields     |              |
|  | T: Normalise, compress     |  | T: Schema-ify (Type_Safe)|              |
|  |    (~90% reduction)        |  |    Compare with previous  |              |
|  | S: Write to cache service  |  |    (delta tracking)       |              |
|  |    (temporal + latest)     |  | S: Write to cache service |              |
|  +-------------+--------------+  |    (latest + temporal)    |              |
|                |                 |    (only if changed)      |              |
|                |                 +-------------+-------------+              |
|                |                               |                           |
|                +---------------+---------------+                           |
|                                |                                           |
|  STORAGE LAYER                 v                                           |
|  +-----------------------------+-------------------------------------+     |
|  | Cache Service                                                     |     |
|  |                                                                   |     |
|  |  +-- latest/              (current state -- single version)       |     |
|  |  |   +-- lambda/          Lambda configs + latest metrics         |     |
|  |  |   +-- cloudfront/      CloudFront configs + latest metrics     |     |
|  |  |   +-- s3/              S3 configs + latest metrics             |     |
|  |  |   +-- logs/            Latest processed log batch              |     |
|  |  |                                                                |     |
|  |  +-- temporal/            (historical snapshots -- date-indexed)  |     |
|  |  |   +-- {YYYY}/{MM}/{DD}/{HH}/                                  |     |
|  |  |       +-- lambda/      Point-in-time Lambda snapshot           |     |
|  |  |       +-- cloudfront/  Point-in-time CloudFront snapshot       |     |
|  |  |       +-- s3/          Point-in-time S3 snapshot               |     |
|  |  |       +-- logs/        Processed log batches                   |     |
|  |  |                                                                |     |
|  |  +-- aggregation/         (computed summaries)                    |     |
|  |      +-- 30min/           30-minute aggregation windows           |     |
|  |      +-- hourly/          Hourly roll-ups                         |     |
|  |      +-- daily/           Daily roll-ups                          |     |
|  +-------------------------------------------------------------------+     |
|                                |                                           |
|  PRESENTATION LAYER            v                                           |
|  +-----------------------------+-------------------------------------+     |
|  | SA Dashboard                                                      |     |
|  |                                                                   |     |
|  |  Cache Browser     Lambda View     CloudFront View     Costs View |     |
|  |  (reads all)       (reads lambda)  (reads CF + logs)   (reads $)  |     |
|  +-------------------------------------------------------------------+     |
|                                                                            |
+============================================================================+

HIGH-WATER MARK PRINCIPLE:
  - Track last-fetched timestamp for every data source
  - On each collection: only fetch delta since last run
  - Use checksums to detect actual changes vs timestamp-only changes
  - Never fetch the same data twice
```

### 4.3 Updated Full System Topology (v0.3.12)

This extends the v0.3.0 system landscape map with all new components.

```
                                    INTERNET
                                       |
                            +----------+-----------+
                            |                      |
                     [User Lambda URL]       [Admin Lambda URL]
                     (public, no auth)       (API key auth)
                            |                      |
                +-----------+----------+   +-------+------------------+
                |                      |   |                          |
         [Static UI]           [FastAPI]   [FastAPI]            [Static UI]
         User v0.1.4           User App   Admin App           Admin v0.1.x
                                  |            |              +-- Index Page
                                  |            |              +-- SA Dashboard
                                  |            |                  (path-based)
                    +-------------+    +-------+-------+------+
                    |                  |       |       |      |
            [Transfer__Service]   [Svc    [Svc    [Mid-  [SA Routes]
                    |              Tkns]   Pulse]  ware   /dashboard/*
            [Storage_FS]              |    |      Anly]      |
            (Memory/S3)               |    |      |    +-----+------+
                                      +----+------+    |     |      |
                                           |           |     |      |
                                  [Send__Cache__Client]|     |      |
                                           |           |     |      |
                                           |    [CW    |[Aggr-|[Dash-
                                           |    Client]|gator]|board
                                           |       |   |  |   | Gen]
                                           |    +--+---+--+---+--+
                                           |    |  3 Collectors  |
                                           |    |  Lambda/S3/CF  |
                                           |    +-------+--------+
                                           |            |
                                  [Cache__Service__Client]
                                       (MGraph-AI)
                                           |
                                  [Memory-FS Backend]
                                  (IN_MEMORY / S3)
                                           |
                  +------------------------+------------------------+
                  |                        |                        |
          [S3: Transfers]          [S3: Cache]              [S3: Logs]
          (encrypted files)        (tokens, metrics,        (raw CloudFront,
                                    analytics, agg)          CloudWatch, S3
                                                             access logs)
                                                                  |
                                                          [S3 Event Trigger]
                                                                  |
                                                     [Data Processing Lambda]
                                                     (S3-triggered, no HTTP)
                                                                  |
                                                          [Cache Service]
                                                          (writes curated
                                                           logs to cache)
```

### 4.4 Component Interaction Summary

```
COMPONENT COUNT (v0.3.12):

  Application Lambdas:        2 (User + Admin)
  Data Processing Lambdas:    1 (S3-triggered, planned)
  S3 Buckets:                 3 (Transfers + Cache + Logs)
  Cache Namespaces:           6 (analytics, tokens, metrics, aggregation, costs, transfers)
  Admin Routes (existing):    ~8 (/tokens/*, /health/pulse, /info, /metrics/*)
  Admin Routes (SA new):      ~8 (/admin/dashboard/*, /admin/dashboard/cache/*, etc.)
  Service Classes (existing): 5 (Tokens, Pulse, Cache Client, Middleware, Transfer)
  Service Classes (SA new):   6 (CW Client, 3 Collectors, Snapshot, Aggregator)
  Schemas (existing):         6 (Token + Analytics)
  Schemas (SA new):           9 (Metric schemas from Architect v0.3.6)
  UI Pages:                   3 (User upload/download, Admin index, SA dashboard)
```

---

## 5. Key Observations for the Conductor

1. **The SA dashboard is a sub-application, not a feature.** It has its own routing tree, service layer, schema set, and UI page. The admin Lambda is evolving from "token management API" to "operational console platform." The system map must reflect this growth in scope.

2. **The S3-triggered Lambda is a new category.** We now have three types of Lambda: application (User, Admin) and data processing (S3-triggered). The data processing Lambdas have no HTTP interface, no authentication layer, and no UI. They are infrastructure components. DevOps needs to map their deployment lifecycle separately.

3. **The cache service is becoming central infrastructure.** It is now the read/write layer for tokens, analytics events, CloudWatch metrics, aggregated summaries, and (eventually) costs and log data. The digital twin pattern further elevates it. If the cache service has performance issues (see task #9 in the brief -- token fetch performance), the impact radius is growing.

4. **Path-based routing (D038) has architectural implications.** Moving from hash-fragment to path-based URLs means the admin Lambda's FastAPI router must handle the SA routes. This is a different pattern from the existing admin UI (which serves a static HTML page that uses client-side hash routing). The Architect needs to decide: does the Lambda serve different HTML pages per path (server-side routing), or does it serve one HTML page that reads `window.location.pathname` (client-side routing with path URLs)? Both work with IFD but have different deployment characteristics.

5. **The LETS pipeline introduces asynchronous data flow.** For the first time, the system has components that operate on different timescales: real-time (user Lambda serving requests), near-real-time (S3-triggered Lambda processing logs within minutes), and on-demand (CloudWatch collectors running when the SA dashboard is viewed). The topology maps need to show these temporal characteristics.

6. **Handover Package #1 remains pending.** The v0.3.10 brief does not mention the handover to Villager. The five ready components (encryption, upload/download, S3 storage, tokens, link sharing) are still ready, but the Explorer's focus has shifted to SA dashboard and UX fixes. The Cartographer should flag this to the Conductor -- the Villager team is waiting.

---

## 6. Cartographer Action Items (Updated)

### 6.1 Immediate (This Session / Next Session)

| # | Action | Priority | Status |
|---|--------|----------|--------|
| A1 | Publish updated SA dashboard topology (this document) | P1 | **DONE** |
| A2 | Map LETS pipeline data flows (this document, Section 4.2) | P1 | **DONE** |
| A3 | Draft digital twin storage layout (this document, Section 1.3) | P2 | **DONE** |
| A4 | Update evolution map with v0.3.12 component movements (this document, Section 3.3) | P1 | **DONE** |

### 6.2 Ongoing

| # | Action | Trigger |
|---|--------|---------|
| A5 | Track SA sub-component evolution (cache browser, Lambda view, etc.) | As each is built |
| A6 | Update LETS pipeline flow as S3-triggered Lambda is implemented | DevOps task #15 completes |
| A7 | Map CloudWatch__Client integration when collectors are built | Dev implements Step 2-3 of Architect plan |
| A8 | Re-assess cache service evolution stage | After digital twin pattern is operational |

### 6.3 Carryover (from v0.3.2, still pending)

| # | Action | Priority | Notes |
|---|--------|----------|-------|
| A2-carry | Support Explorer in Handover Package #1 brief | P1 | Blocked on Explorer starting handover process |
| A3-carry | Create `.issues` file for Cartographer | P2 | Issues FS adoption |
| A9-carry | Create living Wardley Map document | P2 | Would benefit from SA components being mapped |
| A10-carry | Map design agency external dependency | P2 | Designer brief published, engagement pending |
| A11-carry | Research Town Planners trigger criteria | P3 | Still too early |

---

*This action plan reflects the system state as of v0.3.12. The SA dashboard, LETS pipeline, and digital twin represent the largest architectural expansion since the two-Lambda model was established. The topology diagrams in Section 4 should be considered the current canonical system maps for the Explorer team. They will be updated as the Architect's routing design and the DevOps S3 event configuration are completed.*
