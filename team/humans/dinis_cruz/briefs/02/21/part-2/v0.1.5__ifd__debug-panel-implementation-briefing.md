# IFD Debug Panel -- Implementation Briefing for External Projects

| Field       | Value |
|-------------|-------|
| Identifier  | `v0.1.5__ifd__debug-panel-implementation-briefing` |
| Version     | v0.1.5 |
| Date        | 2026-02-21 |
| Status      | Active |
| Authors     | Dev Role, Architect Role |
| Audience    | LLM sessions implementing the IFD debug panel in other projects |

---

## Purpose

This document is a **reference briefing** for LLM sessions that have used the IFD (Issues-FS Design) guidance to implement a debug panel in their own projects. It provides:

1. The **complete reference implementation** from Issues-FS (what the "gold standard" looks like)
2. A **feature checklist** covering every capability the reference ships
3. A **gap analysis template** listing the most commonly missed features
4. **Specific improvement guidance** for each gap, with code patterns

Use this document to compare your current implementation against the reference and identify areas for improvement.

---

## Part 1: Reference Architecture Overview

### Shell Layout

The Issues-FS shell uses a three-column layout:

```
┌──────────────────────────────────────────────────────────────────┐
│  Header (48px) -- logo, version, root selector                   │
├────────┬─────────────────────────────┬───┬───────────────────────┤
│        │                             │ R │                       │
│  Left  │        Main Content         │ e │   Right Sidebar       │
│  Nav   │                             │ s │   (Debug Panel)       │
│ 240px  │        flex: 1              │ i │   280-800px           │
│        │                             │ z │   default: 400px      │
│        │                             │ e │                       │
├────────┴─────────────────────────────┴───┴───────────────────────┤
│  Footer (32px) -- status, "Debug Panel" toggle, message badge    │
└──────────────────────────────────────────────────────────────────┘
```

**Key dimensions:**
- Header: 48px fixed height
- Left Nav: 240px default, resizable
- Main Content: flexible, fills remaining space
- **Right Sidebar (Debug Panel): 0px when closed, 400px when open, resizable 280-800px**
- Footer: 32px fixed height
- Resize handles: 4px wide, transparent until hover/drag (accent colour on interaction)

### Four-Tab System

The debug panel provides four tabs in its header:

| Tab | Component | Purpose |
|-----|-----------|---------|
| **Messages** | `messages-panel` | User-facing notifications (error/warning/success/info) |
| **Events** | `events-viewer` | Real-time EventBus event stream |
| **API** | `api-logger` | HTTP request/response capture via fetch interceptor |
| **Automation** | `automation-runner` | Predefined test scenarios and smoke tests |

Tabs are rendered as buttons in the sidebar header with a close (×) button on the right:

```
┌─────────────────────────────────────────────┐
│ [Messages] [Events] [API] [Automation]  [×] │
├─────────────────────────────────────────────┤
│                                             │
│             Tab Content Area                │
│                                             │
└─────────────────────────────────────────────┘
```

### Colour Palette

The reference implementation uses a consistent dark theme:

| Element | Colour | Hex |
|---------|--------|-----|
| Darkest background | Navy black | `#1a1a2e` |
| Panel background | Dark navy | `#1e2746` |
| Item/card background | Charcoal | `#252836` |
| Input borders | Slate | `#3a4f6f` |
| Divider lines | Dark slate | `#2a3f5f` |
| Primary text | Light grey | `#e0e0e0` |
| Secondary text | Blue-grey | `#8a9cc4` |
| Tertiary text | Grey | `#6a7a8a` |
| **Primary accent** | **Red-pink** | **`#e94560`** |
| Secondary accent | Purple | `#667eea` |
| Success | Green | `#22c55e` |
| Error | Red | `#ef4444` |
| Warning | Amber | `#f59e0b` |
| Info | Blue | `#3b82f6` |

**Active tab styling:** Background `#e94560` with white text. Inactive tabs: transparent background with `#8a9cc4` text.

---

## Part 2: Feature-by-Feature Reference

### 2.1 Sidebar Resize (CRITICAL -- Often Missing)

The sidebar **must** be resizable by the user via a drag handle. This is one of the most important UX features and the most commonly omitted.

**Implementation pattern:**

```javascript
initSidebarResize() {
    let isResizing = false;
    let startX, startWidth;

    const startResize = (e) => {
        if (!this._sidebarOpen) return;          // Only resize when open
        isResizing = true;
        startX = e.clientX;
        startWidth = this.$sidebar.offsetWidth;
        this.$sidebarResize.classList.add('dragging');
        document.body.style.cursor = 'col-resize';
        document.body.style.userSelect = 'none';   // Prevent text selection
        e.preventDefault();
    };

    const doResize = (e) => {
        if (!isResizing) return;
        const diff = startX - e.clientX;           // Inverted: left drag = wider
        const newWidth = Math.min(Math.max(startWidth + diff, 280), 800);
        this.$sidebar.style.width = newWidth + 'px';
    };

    const stopResize = () => {
        if (!isResizing) return;
        isResizing = false;
        this.$sidebarResize.classList.remove('dragging');
        document.body.style.cursor = '';
        document.body.style.userSelect = '';
        this._savePreferences();                   // Persist to localStorage
    };

    this.$sidebarResize?.addEventListener('mousedown', startResize);
    document.addEventListener('mousemove', doResize);
    document.addEventListener('mouseup', stopResize);
}
```

**CSS for the resize handle:**

```css
.sidebar-resize-handle {
    width: 4px;
    cursor: col-resize;
    background: transparent;
    transition: background 0.15s;
}
.sidebar-resize-handle:hover,
.sidebar-resize-handle.dragging {
    background: #e94560;          /* Accent colour on interaction */
}
```

**Key requirements:**
- Width range: 280px minimum, 800px maximum
- Drag direction is inverted (dragging left increases width, since panel is on the right)
- Disable text selection during drag (`userSelect: 'none'`)
- Visual feedback: handle highlights on hover and during drag
- Persist width to `localStorage` on drag end
- Only allow resize when sidebar is open

### 2.2 Sidebar Open/Close Animation

```css
#shell-sidebar {
    width: 0;
    transition: width 0.2s;
    overflow: hidden;
}
#shell-sidebar.open {
    width: 400px;          /* Default open width */
}
```

**Toggle from footer:**

```javascript
toggleSidebar() {
    if (this._sidebarOpen) {
        this.closeSidebar();
    } else {
        this.openSidebarTab(this._activeSidebarTab || 'events-viewer');
    }
}
```

**Requirements:**
- Smooth CSS transition on width change (0.2s)
- Remember last active tab when re-opening
- Footer toggle button shows active state when panel is open

### 2.3 Messages Panel

**Message type configuration:**

| Type | Colour | Auto-Open | Auto-Dismiss | Dismiss Delay |
|------|--------|-----------|--------------|---------------|
| Error | `#ef4444` (red) | Yes | No | -- |
| Warning | `#f59e0b` (amber) | Yes | Yes | 10 seconds |
| Success | `#22c55e` (green) | No | Yes | 5 seconds |
| Info | `#3b82f6` (blue) | No | Yes | 5 seconds |

**Key features:**
- Colour-coded left border (3px) on each message card
- **Auto-open sidebar** on error/warning messages (opens to Messages tab automatically)
- Auto-dismiss with configurable delays per type
- Manual dismiss button (×) on each message
- "Clear All" button in header
- **Message badge in footer** showing active count, red background when errors exist
- Confirmation dialogs with Confirm/Cancel buttons (distinct styling: thicker 4px border, higher-contrast `#1e2746` background)
- Messages capped at 100 maximum
- Opacity fade animation on dismiss (0.3s transition)
- Timestamp display on each message (11px grey text)

**Confirmation button styling:**
- Cancel: `#3a4f6f` background
- Confirm: `#238636` background (green)
- Danger confirm: `#da3633` background (red)

### 2.4 Events Viewer

**Key features:**
- **EventBus interceptor pattern** -- wraps `EventBus.emit()` non-invasively
- Live stream of all events with monotonic numbering (#1, #2, #3...)
- Expandable event items showing full JSON payload
- Text filter (searches across event names and payloads, case-insensitive)
- Type filter dropdown (auto-populated from observed event types)
- **Pause/Resume toggle** -- freezes capture while maintaining data flow
- Status bar showing "Live" (green `#22c55e`) or "Paused" (amber `#f59e0b`)
- Maximum 500 events in history
- Clear button to reset
- Event name displayed in accent colour (`#e94560`)
- Event ID in grey (`#6a7a8a`) with font-weight 600

**Interceptor pattern (critical):**

```javascript
// Save original
this._originalEmit = this.events.emit.bind(this.events);

// Wrap
this.events.emit = function(name, detail) {
    self.onEventEmitted(name, detail);           // Record event
    return self._originalEmit(name, detail);     // Dispatch normally
};

// Cleanup in disconnectedCallback()
this.events.emit = this._originalEmit;
```

**Rules:** Always save original with `.bind()`. Always restore on cleanup. Always return original result. Clone data -- don't hold mutable references.

### 2.5 API Logger

**Key features:**
- **Fetch interceptor pattern** -- wraps `window.fetch()` non-invasively
- Call lifecycle: pending → success/error with status code and duration
- **Method badges** with colour coding:
  - GET: green (`#22c55e`)
  - POST: blue (`#3b82f6`)
  - PUT: orange (amber)
  - PATCH: purple
  - DELETE: red (`#ef4444`)
- **Status border**: 3px left border -- green (success), red (error), amber (pending)
- Expandable call items showing request/response bodies
- Response body cloned for display (original returned untouched)
- URL filter, method filter dropdown, status filter (success/error/pending)
- Maximum 200 calls in history
- Duration displayed in monospace font (11px, grey)
- Status code badge with background `#3a4f6f`
- URL truncated with ellipsis for long paths

**Fetch interceptor pattern:**

```javascript
this._originalFetch = window.fetch.bind(window);

window.fetch = async function(url, options = {}) {
    const callRecord = { status: 'pending', startTime: Date.now(), ... };
    try {
        const response = await self._originalFetch(url, options);
        callRecord.status = response.ok ? 'success' : 'error';
        callRecord.statusCode = response.status;
        callRecord.duration = Date.now() - callRecord.startTime;
        // Clone response body for display
        callRecord.responseBody = await response.clone().json().catch(() => null);
        return response;  // Return original, unmodified
    } catch (error) {
        callRecord.status = 'error';
        throw error;       // Re-throw to preserve error handling
    }
};
```

### 2.6 Automation Runner

**Key features:**
- Scenario categories: browse, create, api, debug, demo, custom
- Built-in scenarios: Browse All Issues, Open Kanban Board, Create Bug/Feature, Test APIs, Open Debug Panels, Full Workflow Demo
- **Step types:** navigate, delay, event, api, sidebar, set-value, click
- Live progress bar during execution (4px height, accent `#667eea` fill)
- Spinning icon during execution
- Results history (last 5) with success (green) / fail (red) indicators
- Stop/abort button during execution
- Custom scenario creation with localStorage persistence
- Category headers: uppercase, 11px, grey `#8a8a9a`
- Scenario cards: `#252836` background with hover `#2f3344`
- Toast notification on completion (fixed bottom-right)

### 2.7 Messages Service (Global)

**Key features:**
- Central service at `window.issuesApp.messages`
- API: `add(type, text, options)`, `dismiss(id)`, `clear()`, `getMessages(filter)`, `getActiveMessages()`, `getActiveCount()`, `subscribe(callback)`
- Emits EventBus events: `message-added`, `message-dismissed`, `messages-cleared`
- **Auto-captures `api-error` events** and converts to error messages
- Console logging of all messages
- Subscriber pattern: `subscribe(callback)` returns `unsubscribe` function
- Max 100 messages

### 2.8 Footer Integration

The footer bar (32px) is the primary entry point to the debug panel:

```
┌──────────────────────────────────────────────────────────────┐
│  Status info          [Debug Panel]          [Message Badge] │
└──────────────────────────────────────────────────────────────┘
```

**Requirements:**
- "Debug Panel" toggle button changes visual state when sidebar is open
- Message badge shows count of active messages
- Badge background: red (`#ef4444`) when errors exist, dim (`#3a4f6f`) when no errors
- Badge updates in real-time as messages arrive/dismiss
- Click on badge opens Messages tab specifically

### 2.9 localStorage Preferences

The shell persists user preferences:

```javascript
const prefs = {
    leftNavWidth:      this.$leftNav?.offsetWidth,
    sidebarWidth:      this.$sidebar?.offsetWidth,
    collapsedSections: Array.from(this._collapsedSections)
};
localStorage.setItem('issues-app-prefs', JSON.stringify(prefs));
```

**Key:** `issues-app-prefs`

---

## Part 3: Common Implementation Gaps

When implementing the IFD debug panel from the guidance document alone, the following features are most frequently missed or incomplete. Check your implementation against each item.

### Gap 1: Missing Sidebar Resize Handle (CRITICAL)

**Symptom:** The debug panel opens at a fixed width and cannot be resized by the user.

**Impact:** High. Users cannot adjust the panel to fit their screen or preference. On smaller screens the panel may dominate the viewport. On larger screens it may be too narrow to read JSON payloads.

**Fix:** Add a 4px-wide resize handle element between the main content area and the sidebar. Implement mouse event handling as shown in Section 2.1. Constrain to 280-800px range. Persist width to localStorage.

**HTML structure:**

```html
<div id="shell-main">...</div>
<div id="sidebar-resize" class="sidebar-resize-handle"></div>
<div id="shell-sidebar">...</div>
```

### Gap 2: Missing Auto-Open on Error

**Symptom:** Error messages are added to the Messages panel but the panel doesn't automatically open to show them.

**Impact:** Medium-high. Users miss critical errors because the panel is closed.

**Fix:** When a message with `autoOpen: true` is added (error and warning types), call `router.openSidebar('messages-panel')` to expand the sidebar and switch to the Messages tab.

### Gap 3: Missing Footer Message Badge

**Symptom:** No visual indicator in the footer showing that messages are waiting.

**Impact:** Medium. Users have no ambient awareness of message state without opening the panel.

**Fix:** Add a badge element next to the "Debug Panel" toggle that shows the count from `messagesService.getActiveCount()`. Subscribe to message events to update in real-time. Use red background for errors, dim for no-errors.

### Gap 4: Missing Pause/Resume on Events Viewer

**Symptom:** Events stream cannot be frozen for inspection.

**Impact:** Medium. In high-frequency event environments, users cannot inspect specific events before they scroll away.

**Fix:** Add a pause/resume toggle button. When paused, `onEventEmitted()` returns early without adding to the displayed list. Show status indicator ("Live" green / "Paused" amber) in the status bar.

### Gap 5: Missing Interceptor Cleanup

**Symptom:** Navigation away from the debug panel or component disconnection leaves wrapped versions of `fetch` or `EventBus.emit` in place.

**Impact:** High (subtle). Can cause memory leaks, duplicate event recording, or stale references.

**Fix:** Always restore originals in `disconnectedCallback()`:

```javascript
disconnectedCallback() {
    if (this._originalEmit) {
        this.events.emit = this._originalEmit;
    }
    if (this._originalFetch) {
        window.fetch = this._originalFetch;
    }
}
```

### Gap 6: Missing Method/Status Colour Coding in API Logger

**Symptom:** All API calls look the same visually regardless of method or status.

**Impact:** Low-medium. Harder to scan for specific request types or failures.

**Fix:** Apply method-specific badge colours (GET green, POST blue, DELETE red) and status-specific left borders (success green, error red, pending amber).

### Gap 7: Missing Expandable Detail Views

**Symptom:** Events and API calls show summary only, with no way to inspect full payloads.

**Impact:** Medium. Reduces the panel's usefulness for debugging -- users still need DevTools.

**Fix:** Make each event/call item clickable to expand an inline detail section showing:
- Events: Full JSON payload in `<pre>` with monospace font
- API calls: Request body, response body, headers, status code, duration

### Gap 8: Missing Filter Controls

**Symptom:** No way to search/filter the events or API call streams.

**Impact:** Medium. As events accumulate, finding specific items becomes impossible.

**Fix:** Add text search input (filters across name/URL and payload content), type/method dropdown filter, and status filter for API calls.

### Gap 9: Missing Confirmation Dialog Support in Messages

**Symptom:** Messages panel only shows informational messages, no interactive confirmations.

**Impact:** Low-medium. Limits the panel to passive observation.

**Fix:** Support message objects with `onConfirm` and `onCancel` callbacks. Render Confirm/Cancel buttons with distinct styling. Use higher-contrast background and thicker border for confirmation messages.

### Gap 10: Missing Left Nav Resize

**Symptom:** Left navigation panel has fixed width.

**Impact:** Low. Secondary to sidebar resize but follows the same pattern.

**Fix:** Add a resize handle between left nav and main content. Same mouse event pattern as sidebar resize, with appropriate width constraints.

---

## Part 4: CSS Quality Checklist

Compare your styling against these reference specifications:

### Typography
- [ ] Primary text: `#e0e0e0`
- [ ] Secondary text: `#8a9cc4`
- [ ] Monospace font for code/JSON/durations
- [ ] Font sizes: 16px headers, 13px body, 12px tabs, 11px metadata/badges
- [ ] Font weight 600 for emphasis (event IDs, method badges, labels)

### Spacing and Borders
- [ ] Consistent border colour: `#2a3f5f` for dividers
- [ ] Input border: `#3a4f6f` default, accent colour on focus
- [ ] Border radius: 4px for buttons/inputs, 6px for cards/items
- [ ] Padding: 12px-16px for toolbars, 8px-12px for items, 2px-6px for badges

### Interactive States
- [ ] Hover state on all clickable elements
- [ ] Focus state with accent border on inputs
- [ ] Active tab has accent background with white text
- [ ] Inactive tabs: transparent background, secondary text colour
- [ ] Cursor: `pointer` for clickable, `col-resize` for resize handles

### Custom Scrollbars
- [ ] Track: `#1a1a2e`
- [ ] Thumb: `#3a4f6f` with `#4a5f7f` on hover
- [ ] Width/height: 8px
- [ ] Border radius: 4px on thumb

### Transitions
- [ ] Sidebar open/close: `width 0.2s`
- [ ] Message dismiss: `opacity 0.3s`
- [ ] Resize handle highlight: `background 0.15s`
- [ ] Hover effects: smooth, not instant

---

## Part 5: Integration Patterns

### EventBus Contract

The debug panel depends on a global EventBus instance. Your project must provide:

```javascript
window.yourApp.events = {
    emit(name, detail) { ... },    // Dispatch event
    on(name, callback) { ... },    // Subscribe
    off(name, callback) { ... },   // Unsubscribe
    history: []                     // Optional: pre-existing events
};
```

The Events Viewer intercepts `emit()` to record events. The `history` array is optional but enables viewing events that occurred before the panel was opened.

### Messages Service Contract

```javascript
window.yourApp.messages = {
    add(type, text, options) { ... },    // Create message
    dismiss(id) { ... },                  // Dismiss
    clear() { ... },                      // Clear all
    getActiveMessages() { ... },          // Active messages
    getActiveCount() { ... },             // Count by type
    subscribe(callback) { ... }           // Returns unsubscribe fn
};
```

### Router/Sidebar Contract

```javascript
window.yourApp.router = {
    openSidebar(tabId) { ... },     // Open sidebar to specific tab
    closeSidebar() { ... },          // Close sidebar
    navigate(appId) { ... }          // Navigate main content
};
```

The Messages panel calls `router.openSidebar('messages-panel')` on auto-open. The Automation runner calls `router.navigate()` and `router.openSidebar()` during scenarios.

### Component Lifecycle

Each sidebar tab component should implement:

```javascript
class MyDebugTab extends HTMLElement {
    connectedCallback()    { /* Initial setup, start interceptors */ }
    disconnectedCallback() { /* Cleanup, restore interceptors */     }
    onActivate()           { /* Tab becomes visible */                }
    onDeactivate()         { /* Tab becomes hidden */                 }
    render()               { /* Re-render from current state */       }
}
```

---

## Part 6: Improvement Priority Matrix

When upgrading an initial implementation, address gaps in this order:

| Priority | Gap | Reason |
|----------|-----|--------|
| **P0** | Sidebar resize handle | Core UX -- without this, the panel is unusable on many screen sizes |
| **P0** | Interceptor cleanup | Technical correctness -- memory leaks and stale references |
| **P1** | Auto-open on errors | Usability -- errors must be visible without manual panel open |
| **P1** | Footer message badge | Ambient awareness -- users need to know messages are waiting |
| **P1** | Expandable detail views | Debugging value -- without payloads, users still need DevTools |
| **P2** | Pause/resume on Events | Usability in high-frequency environments |
| **P2** | Filter controls | Usability at scale |
| **P2** | Method/status colour coding | Visual scanning speed |
| **P3** | Confirmation dialogs | Interactive capability |
| **P3** | Left nav resize | Consistency |
| **P3** | Custom scrollbar styling | Polish |

---

## Part 7: Quick-Reference Code Snippets

### Resize Handle HTML

```html
<div id="sidebar-resize" class="sidebar-resize-handle"></div>
```

Place this element **between** the main content area and the sidebar in the DOM.

### Message Badge Update

```javascript
updateBadge() {
    const counts = this.messagesService.getActiveCount();
    const total  = Object.values(counts).reduce((a, b) => a + b, 0);
    this.$badge.textContent = total || '';
    this.$badge.style.background = counts.error > 0 ? '#ef4444' : '#3a4f6f';
    this.$badge.style.display = total > 0 ? 'inline-flex' : 'none';
}
```

### Auto-Open Pattern

```javascript
// In MessagesService.add():
if (typeConfig.autoOpen && this.router) {
    this.router.openSidebar('messages-panel');
}
```

### Filter Input Pattern

```javascript
// Reusable filter for any list
filterItems(items, filterText) {
    if (!filterText) return items;
    const lower = filterText.toLowerCase();
    return items.filter(item =>
        JSON.stringify(item).toLowerCase().includes(lower)
    );
}
```

---

## Appendix A: File Map (Issues-FS Reference)

| Component | Path | Version |
|-----------|------|---------|
| Shell (base) | `v0.1.0/components/shell/issues-shell.js` | 0.1.0 |
| Shell (root selector override) | `v0.1.6/components/shell/issues-shell.js` | 0.1.6 |
| Messages Panel | `v0.1.5/components/messages-panel/messages-panel.js` | 0.1.5 |
| Events Viewer | `v0.1.0/components/events-viewer/events-viewer.js` | 0.1.0 |
| API Logger | `v0.1.2/components/api-logger/api-logger.js` | 0.1.2 |
| Automation Runner | `v0.1.2/components/automation-runner/automation-runner.js` | 0.1.2 |
| Messages Service | `v0.1.4/js/messages-service.js` | 0.1.4 |
| Global CSS | `v0.1.0/css/app.css` | 0.1.0 |
| IFD Guidance | `v0.1.8__ifd__debug-panel-and-observability.md` | 0.1.8 |

All paths relative to `issues_fs_service_ui__console/v0/v0.1/`.

---

## Appendix B: Design Principles

From the IFD guidance document:

> "The debug panel is the developer's X-ray vision. Build it early, use it always."

Key principles:
1. **Non-invasive observation** -- interceptors must not change behaviour
2. **Production-safe** -- panel can ship to production with negligible overhead
3. **Self-contained** -- each tab is an independent Web Component
4. **Persistent preferences** -- width, collapsed sections, last-active tab survive reload
5. **Ambient awareness** -- footer badge provides always-visible message state
6. **Progressive detail** -- summary → expand → full payload, on demand

---

*Prepared by Dev and Architect Roles, Issues-FS ecosystem. 21 February 2026.*
*Reference: IFD Debug Panel and Observability Guidance v0.1.8, Issues-FS Service UI v0.1.0-v0.1.6.*
