# INCIDENT BRIEF: Access Token Exposed in Shareable Links

**version** v0.4.12  
**date** 19 Feb 2026  
**classification** P3 (treated as P1 — practice run)  
**from** Human (project lead)  
**to** Developer (lead), AppSec, DevOps, GRC  
**type** Security incident — active token leakage  
**status** OPEN  

---

## What Happened

The human discovered that **access tokens are being included in shareable links**. When a user encrypts content and copies the share link, the authentication token used to access the platform is embedded in the URL.

This means: every time a user shares a link with a recipient, they are also sharing their access token. The recipient — and anyone who intercepts or sees that link — gains the sender's authentication credentials.

---

## Severity: P3 as P1

The technical classification is **P3** — must fix, but the blast radius is limited to beta users with access tokens, there is no confirmed exploitation, and the tokens grant platform access (not access to other users' encrypted content, which remains zero-knowledge protected).

We are **treating this as a P1 practice run.** This follows the same pattern as our first security incident (the external security review, v0.4.7): no individual finding was P1, but we ran the full P1 response process to set the standard and build the muscle.

**Why practice this as P1:**

1. **It's actively happening** — every link shared since this bug was introduced leaks a token. Real impact, even if limited.
2. **It's a security regression** — the access token system was designed to gate access, not to be distributed
3. **It's a credibility issue** — we're a security product. Leaking auth credentials in URLs is the kind of mistake we need to catch fast and fix faster.
4. **It exercises our incident response** — the P0–P10 framework, the runbooks (being created in v0.4.11), the communication templates — this is a safe incident to test them all against.

---

## Immediate Actions Required

### 1. Hotfix: Remove Token from Shareable Links (Developer — NOW)

The link generation code must be fixed immediately to exclude the access token from the URL that gets copied to the clipboard or shared with the recipient.

**What to check**:
- Where is the shareable URL constructed? (likely in the post-encryption JavaScript)
- Is the access token in the URL path, a query parameter, or the hash fragment?
- Is it being appended by the application code or by a redirect/routing mechanism?
- Are there other places where the token might leak? (e.g., Referer headers, server logs, analytics)

**The fix**: strip the access token from the shareable URL. The token is for the sender's session — it has no business being in a link sent to a third party.

**Deploy**: hotfix to production as soon as the fix is verified. We're treating this as P1 — don't wait for a full release cycle.

### 2. Assess the Blast Radius (AppSec)

- How many links have been shared with embedded tokens?
- Which tokens have been exposed?
- Can exposed tokens be used to access other users' content? Or only to access the platform generally?
- Do we need to rotate/revoke the exposed tokens?
- Are the exposed tokens visible in server logs (CloudFront, API Gateway, Lambda)?

### 3. Token Revocation (Developer + DevOps)

If tokens have been exposed and they grant meaningful access:
- Generate new tokens for affected users
- Invalidate the old tokens
- Notify affected users (via the Sherpa's communication channel)

### 4. Pipeline Investigation (DevOps + AppSec)

**Root cause**: how did this get through?

Questions to answer:
- When was this bug introduced? Which commit/deployment?
- Why wasn't it caught in testing?
- Do we have any tests that verify the shareable URL format?
- Does our CI/CD pipeline include checks for sensitive data in URLs?

**Produce a root-cause report** documenting:
- The exact code path that introduced the leak
- Why existing review processes didn't catch it
- What checks need to be added to prevent recurrence

### 5. Preventive Measures (AppSec + Developer)

After the hotfix, implement:

| Measure | Description | Priority |
|---|---|---|
| **URL sanitisation test** | Automated test that verifies shareable URLs do not contain tokens, keys, or other sensitive data | P1 |
| **Sensitive data in URL scanner** | CI/CD check that scans generated URLs for patterns matching tokens, API keys, secrets | P2 |
| **Shareable URL contract test** | Define the exact format of a shareable URL (what's allowed, what's not) and test against it | P2 |
| **Referer header check** | Verify that sensitive URL parameters aren't leaked via HTTP Referer headers | P2 |
| **Server log audit** | Check if exposed tokens appear in CloudFront/API Gateway/Lambda logs | P1 |

---

## Incident Timeline

| Time | Event |
|---|---|
| 19 Feb 2026, ~13:50 | Human discovers token in shareable link during routine use |
| 19 Feb 2026, ~14:00 | Incident classified as P3-as-P1, brief created |
| 19 Feb 2026, TBD | Hotfix developed and tested |
| 19 Feb 2026, TBD | Hotfix deployed to production |
| 19 Feb 2026, TBD | Blast radius assessment complete |
| TBD | Root-cause report produced |
| TBD | Preventive measures implemented |

---

## Connection to Previous Incidents

This is our **second security incident**, and our second P3-as-P1 practice run. The first (v0.4.7) was the external security review with 29 findings — none of which were P1, but we ran the full P1 response process. This time we have an actively leaking bug — a better test of the response process because it requires a real hotfix under time pressure.

The GRC team defined P0–P10 severity levels and runbooks were requested in today's earlier brief (v0.4.11). This incident is the immediate justification: we need those runbooks NOW, and this is the first real test of our incident response process.

**GRC**: use this incident as the template for the P1 runbook. Document what we did, in what order, and what we'd do differently.

---

## For the Sherpa

If tokens need to be revoked and reissued:
- Prepare a brief, honest message to affected users
- Explain what happened (a bug caused auth tokens to be included in share links)
- Explain what we did (fixed the bug, rotated the tokens)
- Explain what we're doing to prevent recurrence (automated checks, URL sanitisation)
- Don't minimise. We're a security product. Own the mistake. Fix it. Show the fix.

---

## Status

**OPEN — Awaiting hotfix deployment.**

This brief will be updated as the incident progresses. Updates should be committed to the incident folder: `library/sgraph-send/incidents/2026-02-19-token-leak/`

---

*This document is an internal incident brief. Distribute only to involved parties until the incident is resolved and a public disclosure decision is made.*
