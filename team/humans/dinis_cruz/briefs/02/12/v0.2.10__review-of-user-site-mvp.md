---
author : Dinis Cruz
date   : 12/02/2026
version: v0.2.10 
---

# Review of user site MVP

## General nodes and observations

- we can't add __init__.py files to any of the test/* folders because a) it break PyCharm test resolution (when clicking on the test execution treeview) , and b) they are not needed
- review all issues in this repo and update the status of work that has been done 'issues-fs list', since it looks like quite a good number has been done

## Work I have done 
 - I have added the support for CI integration of automatic deployment to AWS Lambda (as of v0.2.10 all pushes to dev that pass all tests, will trigger the deployment of the current code base to AWS)

## Tasks for agents

### DevOps
- document in detail how the AWS Deployment is working and link it with the review of the work defined in team/humans/dinis_cruz/briefs/02/11/v0.2.4__briefs__sgraph-send-devops-deployment-productization.md

### AppSec
- do a security review on the code base
- create issues for all vulnerabilities discovered (for example the injection vulnerability in the info__transfer_id method of the Routes__Transfersc class)
- map/link all vulns to the respective issue-type that represents the class and parent module where it was discovered
- map/link all vulns to the respective risks and exploit vectors
- create the relevant threat models for this project
- put all issues created in your (AppSec) issues db (here team/roles/appsec/.issues)

### Journalist
- capture the work done here and write some good articles about this major milestone

### Historian
- capture this major milestone (we have our first MVP of a client site)

### Dev

Please read in detail all the guidance in library/dependencies/osbot-utils/type_safe , since there are multiple examples (see my 'todos' notes) where the Type_Safe capabilities are note being used and leveraged

Also we need to leverage the power of the memory-fs abstraction layer (see library/dependencies/memory-fs )

A key principle here is that we should be avoiding raw primities and raw strings as much as we can in the code

Please address all the todos added to the source code in this sequence of events:
- review all todos
- understand the patterns that I'm looking for and issues I'm raising
- review the code for other similar situations and add equivalent # todos
- once you have mapped/created all other similar issues, commit all of them
- now group all of them in logical bugs or tasks issues (in a way that you don't need to create one issue per 'todo' but we don't want to lose any of them)
- all these new issues should be created in yours (Dev) .issue database (i.e. team/roles/dev/.issues).
- create a logic grouping of issues so that you can link them effectively (and we don't have one large number of issues linked to one parent), all these should be linked to parent 'review' issue should should be used to track all issues I'm raising in this review
- once you create the issue for a todo, add the issue id to the impacted line, replacing the # todo, with "# BUG-12 | {status} | {title}" or "# TASK-42 | {status} | {title} ""  (here is when you can reuse the issues ids in multiple todos, so that we don't have a ton of repeated issues)
- then commit all those issues and code changes
- then create a plan for how you would fix address all of them, including indication of effort, complexity and risk
- then create a priority mapping for tackling these in phases/groups (these should also be mapped in an issue-fs issue, note that you can create any issue-type and issue-link that you need in the issues-fs db)
- then commit this plan
- at this stage if you have questions for me (that are blocking) please ask them and pause here
- if you don't have any questions, then start applying those fixes (one phase/group at the time)
- if all went ok, and tests are passing, then go into the next phase/group
- if not, document issue and stop (so that I can take a look)

in all scenarios, once you finish this bit of work, write a detailed debrief of what happened, what was fixed and what are the next steps (including any questions or clarifications you need from me)

**Transfer__Service.py**

- note the use of raw primitives (that are banned from the project), in this case the dict on class attributes and return value
- all methods need to be protected by @type_safe and all method params need to be protected
- see 'todos' and comments I added to this file

**sgraph_ai_app_send/lambda__user/schemas/Schema__Transfer**

- all these schemas classes should be one per file
- refactor to use type safe primitives and classes

**tests/unit/lambda__user/lambda_function/test_lambda_handler__user.py**
- see statusCode comment

**tests/unit/lambda__user/fast_api/routes/test_Routes__Transfers.py**

- so this type of test is what I call a 'client' test and name this file (and class) as test_Routes__Transfers__client
- because we should have the test_Routes__Transfers test which tests the routes by creating an instance of Routes__Transfers and testing all those methods directly, this allows for testing without the Fast_API workflow/invocations (both are important since they are testing different execution paths, and sometime catch interesting edge cases)
- in cases like the one we have here, it is good to have a 'helper' class that we can call once and create all sorts of test objects (which since we are running in Memory-FS and FastAPI client, it should all run under 150ms, which is acceptable in tests), this will help to test methods that need some files from being there already (and keep the test code focused on the method we are testing)

**sgraph_ai_app_send/lambda__user/fast_api/routes/Routes__Transfers.py**
- all method here should return a Type_Safe class
- note that is known bug between Type_Safe and Pydantic where some Type_Safe class will raise a Pydantic error. If you hit that scenario, then the data should still be in a Type_Safe return object, but you can do the serialsation into json here on this route, by calling the .json() method and keeping the route return methods as a dict (note that this should be the exception, i.e. only when hitting this bug)
- see note about trying to avoid creating objects in this routes class. the key idea here is to keep these Routes classes as simple as possible (mainly handling the scenarios like you have done of raising 404 exceptions when files are not found)
- great work in writting all those tests :)

## Dev and QA (on UI)
- Great first MVP :)
- for testing can you add some test files so that I can just click on them to replicate the file upload 
- user story: "as QA I should be able to easily replicate the file upload without needing to actually upload or drop a file"
- I think this workflow will work: if we add the link to a couple test files (an image, and text file, and zip), if I as the user browsing the site site click on it, my local browser (chrome) will download it,chrome will show me the download as clickable or dragable item, I should then be able to drag this into the target are to test it.
- BUG: after dropping a file (which works great), when I click on the 'Encrypt & Upload' button, I get the error "Cannot read properties of undefined (reading 'generateKey')" shown in the UI (I get to error in the console). there is also no network traffic that happened after I clicked on that button
- QA: this is a critical error, and we need to look at how can we detect this via testing
- note: I stopped testing at this stage since the UI is stuck 

## for issues-fs

these issues need to be handed over to Issues-FS team

- user story: "As a user I should be able to get a quick overview of all issues using a command like: issues-fs stats" - at the moment we can get a full list of issues using 'issues-fs stats' but that starts to be easy to consume once we have a bigger number of issues
- user story: "As a user it should be easy to get a list of all my issues" - look at introducing an area of 'user' or 'current-user' (we need to think where we store this config information, maybe an env var?)
- user story: "As a user I should be able to see what are the work being done in the current workstream and iteration"
- user story: "As a user I should be able to see the priority of the issues"