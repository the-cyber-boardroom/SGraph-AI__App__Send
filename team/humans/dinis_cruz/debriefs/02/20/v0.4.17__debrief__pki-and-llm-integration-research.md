# Debrief: PKI & LLM Integration Research

**Version:** v0.4.17
**Date:** 2026-02-20
**Session:** Explorer

---

## Executive Summary

Completed comprehensive research into adding public-key infrastructure (PKI) and LLM integration to SG/Send. Six research streams were executed in parallel, producing four implementation plan documents. The core finding: **SG/Send can support both recipient-addressed encryption and LLM-driven file sharing while preserving zero-knowledge encryption.**

---

## Deliverables

Read in this order:

### 1. Research Summary (Start Here)
[v0.4.17__research-summary__pki-and-llm-integration.md](../../../../../roles/architect/reviews/26-02-20/v0.4.17__research-summary__pki-and-llm-integration.md)
High-level findings, architecture decisions, and recommended implementation order.

### 2. LLM Integration Plan (CLI + MCP)
[v0.4.17__implementation-plan__llm-integration-cli-mcp.md](../../../../../roles/architect/reviews/26-02-20/v0.4.17__implementation-plan__llm-integration-cli-mcp.md)
Build a `sg_send` CLI tool and MCP server so any LLM can encrypt and upload files. Includes trust model analysis, package structure, and code sketches.

### 3. Browser PKI & Key Management Plan
[v0.4.17__implementation-plan__browser-pki-key-management.md](../../../../../roles/architect/reviews/26-02-20/v0.4.17__implementation-plan__browser-pki-key-management.md)
Add ECDH-based hybrid encryption to the browser UI, enabling "send to Alice" without manual key sharing. Covers Web Crypto API, IndexedDB key storage, and key registration API.

### 4. Admin PKI & mTLS Plan
[v0.4.17__implementation-plan__admin-pki-mtls.md](../../../../../roles/architect/reviews/26-02-20/v0.4.17__implementation-plan__admin-pki-mtls.md)
Replace token-based admin auth with cryptographic signed requests. Covers why mTLS doesn't work on Lambda and the migration path to true mTLS on containers.

---

## Key Decisions

| Decision | Rationale |
|----------|-----------|
| **CLI tool first, MCP second** | CLI works with all LLMs immediately (Claude Code, Cursor, Copilot, etc.); MCP wraps the same code |
| **Reject GPT Actions** | Cannot perform client-side encryption — would break zero-knowledge |
| **ECDH P-256 for browser PKI** | Smaller keys, faster, universal browser support, modern standard |
| **Signed requests for admin auth** | Lambda doesn't support mTLS; signed requests provide crypto proof without infrastructure changes |
| **IndexedDB with extractable:false** | Browser-enforced private key protection — even XSS can't export keys |

---

## Questions for You

1. **Priority:** CLI/MCP integration or browser PKI first?
2. ~~**Package name:**~~ Decided: `sg_send`
3. **Short codes for keys:** `abc123` or `blue-tiger-7`?
4. **Admin PKI:** Needed now or after the other two tracks?
5. **Key expiry:** 90 days, 1 year, or configurable?
6. **Single-step upload API:** New path `/api/upload` or extend existing endpoint?

---

## What's Next

Pending your priority decision, the Explorer team can start building:

- **If CLI/MCP first:** Build `sg_send` crypto module, validate format compatibility with `crypto.js`, implement upload/download commands, package for PyPI, then wrap in MCP server
- **If browser PKI first:** Build key registration API (`/api/keys`), implement ECDH hybrid encryption in browser, modify upload/download UI for recipient-addressed mode
- **If admin PKI first:** Build signed request middleware, key registration for admins, CLI admin commands
