# INC-003: Access Token Leak in Shareable URLs — Incident Pack

**Incident ID:** INC-003  
**Date:** 2026-02-19  
**Severity:** P4-as-P1 (low severity, highest process rigour)  
**Type:** Internal discovery — code defect  
**Status:** RESOLVED  
**Incident lead:** Conductor  
**Technical lead:** Dev  

---

## What Happened

The sender's access token was being embedded in shareable download URLs. Every download link shared with a recipient also shared the sender's authentication credential. The token appeared as a query parameter in the constructed URL, meaning anyone with the link could impersonate the sender (upload files, view transfer list).

Discovered by Dinis Cruz at 13:50. Fixed and deployed to production by 15:30. Total response time: ~100 minutes.

## Key Facts

- **Zero-knowledge model held** — no file content was ever at risk (tokens grant platform access, not data access)
- **8 files changed** across 4 IFD frontend versions (v0.1.0 through v0.1.6)
- **153 tests passing** after fix
- **Root cause:** Token treated as a URL parameter in frontend link construction logic
- **No data compromised** — token grants upload/metadata access, not file decryption

## Immune System Gain

Hotfix branch discipline, negative test patterns ("token must NOT appear in URL"), IFD security override process, simultaneous patching across all IFD versions. 6 new decisions (D068-D073), 3 new patterns (P17-P19).

## Source Documents

| Document | Location |
|----------|----------|
| Historian incident record | `team/roles/historian/reviews/26-02-19/v0.4.12__incident-record__INC-003__access-token-leak-hotfix.md` |
| Librarian master index | `team/roles/librarian/reviews/26-02-19/v0.4.12__master-index__INC-003-hotfix-deployed.md` |
| AppSec incident response | `team/roles/appsec/reviews/26-02-19/v0.4.12__incident-response__access-token-leak.md` |
| Journalist article | `team/roles/journalist/reviews/26-02-19/v0.4.12__article__100-minute-security-hotfix.md` |
| Human brief (original article) | `team/humans/dinis_cruz/briefs/02/19/incident/v0.4.12__incident__access-token-leak-in-shareable-links.md` |
